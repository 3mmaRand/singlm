<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Poisson GLM overview | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</title>
  <meta name="description" content="The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Poisson GLM overview | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://3mmarand.github.io/singlm/" />
  <meta property="og:image" content="https://3mmarand.github.io/singlm/images/hex-s.png" />
  <meta property="og:description" content="The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="3mmaRand/singlm" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Poisson GLM overview | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R" />
  
  <meta name="twitter:description" content="The output format for this example is bookdown::gitbook." />
  <meta name="twitter:image" content="https://3mmarand.github.io/singlm/images/hex-s.png" />

<meta name="author" content="Emma Rand" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="what-are-glms.html"/>
<link rel="next" href="pois-glm-single-cont.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="assets/book.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/hex-s.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>0.1</b> Who is this book for?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#approach-of-this-book"><i class="fa fa-check"></i><b>0.2</b> Approach of this book</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#options-on-the-toolbar"><i class="fa fa-check"></i><b>0.3</b> Options on the toolbar</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#conventions-used-in-the-book"><i class="fa fa-check"></i><b>0.4</b> Conventions used in the book</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#following-along-with-the-examples"><i class="fa fa-check"></i><b>0.5</b> Following along with the examples</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#overview-of-the-chapter-contents"><i class="fa fa-check"></i><b>0.6</b> Overview of the chapter contents</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#overview-of-the-chapter-contents-1"><i class="fa fa-check"></i><b>0.7</b> Overview of the chapter contents</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#software-information"><i class="fa fa-check"></i><b>0.8</b> Software information</a></li>
</ul></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="what-are-glms.html"><a href="what-are-glms.html"><i class="fa fa-check"></i><b>1</b> What are GLMs?</a><ul>
<li class="chapter" data-level="1.1" data-path="what-are-glms.html"><a href="what-are-glms.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="what-are-glms.html"><a href="what-are-glms.html#model-fitting"><i class="fa fa-check"></i><b>1.2</b> Model fitting</a></li>
<li class="chapter" data-level="1.3" data-path="what-are-glms.html"><a href="what-are-glms.html#types-of-glm"><i class="fa fa-check"></i><b>1.3</b> Types of GLM</a></li>
<li class="chapter" data-level="1.4" data-path="what-are-glms.html"><a href="what-are-glms.html#more-than-one-explanatory-variable"><i class="fa fa-check"></i><b>1.4</b> More than one explanatory variable</a></li>
<li class="chapter" data-level="1.5" data-path="what-are-glms.html"><a href="what-are-glms.html#generalised-linear-models-in-r"><i class="fa fa-check"></i><b>1.5</b> Generalised linear models in R</a><ul>
<li class="chapter" data-level="1.5.1" data-path="what-are-glms.html"><a href="what-are-glms.html#building-and-viewing"><i class="fa fa-check"></i><b>1.5.1</b> Building and viewing</a></li>
<li class="chapter" data-level="1.5.2" data-path="what-are-glms.html"><a href="what-are-glms.html#getting-predictions"><i class="fa fa-check"></i><b>1.5.2</b> Getting predictions</a></li>
<li class="chapter" data-level="1.5.3" data-path="what-are-glms.html"><a href="what-are-glms.html#tests-of-the-model"><i class="fa fa-check"></i><b>1.5.3</b> Tests of the model</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II POISSON GLMs</b></span></li>
<li class="chapter" data-level="2" data-path="pois-glm-overview.html"><a href="pois-glm-overview.html"><i class="fa fa-check"></i><b>2</b> Poisson GLM overview</a><ul>
<li class="chapter" data-level="2.1" data-path="pois-glm-overview.html"><a href="pois-glm-overview.html#when-explanatory-is-categorical"><i class="fa fa-check"></i><b>2.1</b> When explanatory is categorical</a></li>
<li class="chapter" data-level="2.2" data-path="pois-glm-overview.html"><a href="pois-glm-overview.html#more-than-one-explanatory"><i class="fa fa-check"></i><b>2.2</b> More than one explanatory</a></li>
<li class="chapter" data-level="2.3" data-path="pois-glm-overview.html"><a href="pois-glm-overview.html#reporting"><i class="fa fa-check"></i><b>2.3</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html"><i class="fa fa-check"></i><b>3</b> Single continuous explanatory</a><ul>
<li class="chapter" data-level="3.1" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#introduction-to-the-example"><i class="fa fa-check"></i><b>3.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="3.2" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#applying-and-interpreting-glm"><i class="fa fa-check"></i><b>3.2</b> Applying and interpreting <code>glm()</code></a></li>
<li class="chapter" data-level="3.3" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#getting-predictions-from-the-model"><i class="fa fa-check"></i><b>3.3</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="3.4" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#checking-assumptions"><i class="fa fa-check"></i><b>3.4</b> Checking assumptions</a></li>
<li class="chapter" data-level="3.5" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#creating-a-figure"><i class="fa fa-check"></i><b>3.5</b> Creating a figure</a></li>
<li class="chapter" data-level="3.6" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#reporting-the-results."><i class="fa fa-check"></i><b>3.6</b> Reporting the results.</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pois-glm-two-cont.html"><a href="pois-glm-two-cont.html"><i class="fa fa-check"></i><b>4</b> Two explanatory variables</a><ul>
<li class="chapter" data-level="4.1" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#introduction-to-the-example"><i class="fa fa-check"></i><b>4.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="4.2" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#applying-and-interpreting-glm"><i class="fa fa-check"></i><b>4.2</b> Applying and interpreting <code>glm()</code></a></li>
<li class="chapter" data-level="4.3" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#getting-predictions-from-the-model"><i class="fa fa-check"></i><b>4.3</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="4.4" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#creating-a-figure"><i class="fa fa-check"></i><b>4.4</b> Creating a figure</a></li>
<li class="chapter" data-level="4.5" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#reporting-the-results."><i class="fa fa-check"></i><b>4.5</b> Reporting the results.</a></li>
</ul></li>
<li class="part"><span><b>III BINOMIAL GLMs</b></span></li>
<li class="chapter" data-level="5" data-path="bino-glm-overview.html"><a href="bino-glm-overview.html"><i class="fa fa-check"></i><b>5</b> Binomial GLM overview</a></li>
<li class="chapter" data-level="6" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>6</b> Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pois-glm-overview" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Poisson GLM overview</h1>
<p>When a response variable is the count of things it can often not be approximated by a normal distribution. Instead it follows a Poisson distribution. Such variables are always positive - they range from 0 to <span class="math inline">\(\infty\)</span>. A Poisson GLM is also known as Poisson regression. The link function used in a Poisson GLM is the natural logarithm, <span class="math inline">\(ln\)</span>.</p>
<p>When you have a single explanatory variable, that model is:</p>
<p><span class="math display" id="eq:glmpois">\[\begin{equation}
ln(E(y_{i}))=\beta_{0}+\beta_{1}X1_{i}
\tag{2.1}
\end{equation}\]</span></p>
<p>This means that the model estimates are logged to the base <span class="math inline">\(e\)</span> and and the inverse function, <code>exp()</code> must be applied to them to interpret them in terms of the response. In other words, to make predictions about the expected value of the response we need to exponentiate the coefficients.</p>
<p><span class="math display" id="eq:glmpois2">\[\begin{equation}
E(y_{i})=exp(\beta_{0}+\beta_{1}X1_{i})
\tag{2.2}
\end{equation}\]</span></p>
<p>or</p>
<p><span class="math display" id="eq:glmpois3">\[\begin{equation}
E(y_{i})=exp(\beta_{0}) \times exp(\beta_{1})^{X1_{i}}
\tag{2.3}
\end{equation}\]</span></p>
<p>Just like examples of general linear models with a single explanatory variable, there are two parameters in this model, <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{0}\)</span> and their meaning is similar. <span class="math inline">\(\beta_{0}\)</span> is the log of the expected <span class="math inline">\(y\)</span> when <span class="math inline">\(x\)</span> is zero - the intercept. The log of <span class="math inline">\(\beta_{1}\)</span> is not the amount you <em>add</em> to <span class="math inline">\(y\)</span> for each unit change in <span class="math inline">\(x\)</span> but the amount by which multiply. This means the model is a curve. If <span class="math inline">\(\beta_{1}\)</span> is positive, <span class="math inline">\(exp(\beta_{1})\)</span> is greater than one and <span class="math inline">\(y\)</span> increases as <span class="math inline">\(x\)</span> increases; If <span class="math inline">\(\beta_{1}\)</span> is negative, <span class="math inline">\(exp(\beta_{1})\)</span> is less than one and <span class="math inline">\(y\)</span> decreases as <span class="math inline">\(x\)</span> increases. See Figure <a href="pois-glm-overview.html#fig:glm-pois-poss">2.1</a> for an illustration of the curve for positive and negative <span class="math inline">\(\beta_{1}\)</span>.</p>

<div class="figure" style="text-align: left"><span id="fig:glm-pois-poss"></span>
<img src="glm-poisson_files/figure-html/glm-pois-poss-1.png" alt="Data fitted with a Poisson GLM." width="80%" />
<p class="caption">
Figure 2.1: Data fitted with a Poisson GLM.
</p>
</div>
<p>See Figure <a href="pois-glm-overview.html#fig:glm-pois-annotated">2.2</a> for a graphical representation of generalised linear model terms.</p>

<div class="figure" style="text-align: left"><span id="fig:glm-pois-annotated"></span>
<img src="images/generic_pois.svg" alt="A Generalised linear model with Poisson distributed errors. The measured response values are in pink, the predictions are in green, and the differences between these, known as the residuals, are in blue. The estimated model parameters, \(\beta_{0}\) and \(\beta_{1}\) must be exponentiated to be interpreted on the scale of the response. When \(x=0\) we predict the number of \(y\) to be \(exp(\beta_{0})\). For each unit of \(x\), the number of y changes by a factor of \(exp(\beta_{1})\)" width="80%" />
<p class="caption">
Figure 2.2: A Generalised linear model with Poisson distributed errors. The measured <span style=" font-weight: bold;    color: #d264c0 !important;">response values are in pink</span>, the <span style=" font-weight: bold;    color: #c0d264 !important;">predictions are in green</span>, and the differences between these, known as the <span style=" font-weight: bold;    color: #64c0d2 !important;">residuals, are in blue</span>. The estimated model parameters, <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> must be exponentiated to be interpreted on the scale of the response. When <span class="math inline">\(x=0\)</span> we predict the number of <span class="math inline">\(y\)</span> to be <span class="math inline">\(exp(\beta_{0})\)</span>. For each unit of <span class="math inline">\(x\)</span>, the number of y changes by a factor of <span class="math inline">\(exp(\beta_{1})\)</span>
</p>
</div>
<div id="when-explanatory-is-categorical" class="section level2">
<h2><span class="header-section-number">2.1</span> When explanatory is categorical</h2>
<p>one explanatory <em>use chi-squared</em></p>
</div>
<div id="more-than-one-explanatory" class="section level2">
<h2><span class="header-section-number">2.2</span> More than one explanatory</h2>
<p><span class="math display" id="eq:glmpois4">\[\begin{equation}
ln(E(y_{i}))=\beta_{0}+\beta_{1}X1_{i}+\beta_{2}X2_{i}+...+\beta_{p}Xp_{i}
\tag{2.4}
\end{equation}\]</span></p>
<p>To make predictions about the expected value of the response we need to exponentiate the coefficients.</p>
<p><span class="math display" id="eq:glmpois5">\[\begin{equation}
E(y_{i})=exp(\beta_{0}+\beta_{1}X1_{i}+\beta_{2}X2_{i}+...+\beta_{p}Xp_{i})
\tag{2.5}
\end{equation}\]</span></p>
<!-- ### Checking assumptions -->
<!-- The assumptions of the model are checked using the `plot()` function which produces diagnostic plots to explore the distribution of the residuals. They are not proof of the assumptions being met but allow us to quickly determine if the assumptions are plausible, and if not, how the assumptions are violated and what data points contribute to the violation. -->
<!-- The two plots which are most useful are  the "Residuals vs Fitted" plot (plot 1) and the "Q-Q" plot (plot 2). These are given as values to the `which` argument of `plot()`. -->
<!-- The Residuals vs Fitted plot shows if residuals have homogeneous variance or have non-linear patterns. Non-linear relationship between explanatory variables and the response will usually show in this plot if the model does not capture the non-linear relationship. For the assumptions to be met, the residuals should be equally spread around a horizontal line: -->
<!-- The following are two examples in which the residuals do not have homogeneous variance and display non-linear patterns. -->
<!-- The Q-Q plot is a scatterplot of the residuals (standardised to a mean of zero and a standard deviation of 1) against what is expected if the residuals are normally distributed.  -->
<!-- The following are two examples in which the residuals are not normally distributed. -->
</div>
<div id="reporting" class="section level2">
<h2><span class="header-section-number">2.3</span> Reporting</h2>
<p><em>to add, same principles apply</em></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="what-are-glms.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pois-glm-single-cont.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/3mmaRand/singlm/edit/master/glm-poisson.Rmd",
"text": "Make an edit suggestion"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["singlm.pdf", "singlm.epub", "https://github.com/3mmaRand/singlm/raw/master/glm-poisson.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
