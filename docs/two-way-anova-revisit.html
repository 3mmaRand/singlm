<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Two-way ANOVA revisited | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</title>
  <meta name="description" content="The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Two-way ANOVA revisited | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://3mmarand.github.io/singlm/" />
  <meta property="og:image" content="https://3mmarand.github.io/singlm/images/android-chrome-512x512.png" />
  <meta property="og:description" content="The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="3mmaRand/singlm" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Two-way ANOVA revisited | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R" />
  
  <meta name="twitter:description" content="The output format for this example is bookdown::gitbook." />
  <meta name="twitter:image" content="https://3mmarand.github.io/singlm/images/android-chrome-512x512.png" />

<meta name="author" content="Emma Rand" />


<meta name="date" content="2020-07-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="one-way-anova-revisit.html"/>
<link rel="next" href="pois.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="assets/book.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/hex-s.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>0.1</b> Who is this book for?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#approach-of-this-book"><i class="fa fa-check"></i><b>0.2</b> Approach of this book</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#formatting-options-on-the-menu"><i class="fa fa-check"></i><b>0.3</b> formatting options on the menu</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#conventions-used-in-the-book"><i class="fa fa-check"></i><b>0.4</b> Conventions used in the book</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#overview-of-the-chapter-contents"><i class="fa fa-check"></i><b>0.5</b> Overview of the chapter contents</a></li>
</ul></li>
<li class="part"><span><b>I INTRODUCTION</b></span></li>
<li class="chapter" data-level="1" data-path="revision-of-your-introductory-class.html"><a href="revision-of-your-introductory-class.html"><i class="fa fa-check"></i><b>1</b> Revision of your Introductory class</a></li>
<li class="chapter" data-level="2" data-path="what-are-linear-models.html"><a href="what-are-linear-models.html"><i class="fa fa-check"></i><b>2</b> What are linear models</a><ul>
<li class="chapter" data-level="2.1" data-path="what-are-linear-models.html"><a href="what-are-linear-models.html#what-is-a-linear-model"><i class="fa fa-check"></i><b>2.1</b> What is a linear model?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="single-linear-regression.html"><a href="single-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Single linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="single-linear-regression.html"><a href="single-linear-regression.html#introduction-to-the-example"><i class="fa fa-check"></i><b>3.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="3.2" data-path="single-linear-regression.html"><a href="single-linear-regression.html#applying-and-interpreting-lm"><i class="fa fa-check"></i><b>3.2</b> Applying and interpreting <code>lm()</code></a></li>
<li class="chapter" data-level="3.3" data-path="single-linear-regression.html"><a href="single-linear-regression.html#getting-predictions-from-the-model"><i class="fa fa-check"></i><b>3.3</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="3.4" data-path="single-linear-regression.html"><a href="single-linear-regression.html#link-to-chapter-2.1"><i class="fa fa-check"></i><b>3.4</b> Link to Chapter 2.1</a></li>
<li class="chapter" data-level="3.5" data-path="single-linear-regression.html"><a href="single-linear-regression.html#checking-assumptions"><i class="fa fa-check"></i><b>3.5</b> Checking assumptions</a></li>
<li class="chapter" data-level="3.6" data-path="single-linear-regression.html"><a href="single-linear-regression.html#creating-a-figure"><i class="fa fa-check"></i><b>3.6</b> Creating a figure</a></li>
<li class="chapter" data-level="3.7" data-path="single-linear-regression.html"><a href="single-linear-regression.html#reporting-the-results"><i class="fa fa-check"></i><b>3.7</b> Reporting the results</a></li>
</ul></li>
<li class="part"><span><b>II USING <code>lm()</code> FOR FAMILIAR TESTS</b></span></li>
<li class="chapter" data-level="4" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html"><i class="fa fa-check"></i><b>4</b> <em>t</em>-tests revisited</a><ul>
<li class="chapter" data-level="4.1" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#introduction-to-the-example-1"><i class="fa fa-check"></i><b>4.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="4.2" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#t.test-output-reminder"><i class="fa fa-check"></i><b>4.2</b> <code>t.test()</code> output reminder</a></li>
<li class="chapter" data-level="4.3" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#applying-and-interpreting-lm-1"><i class="fa fa-check"></i><b>4.3</b> Applying and interpreting <code>lm()</code></a></li>
<li class="chapter" data-level="4.4" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#getting-predictions-from-the-model-1"><i class="fa fa-check"></i><b>4.4</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="4.5" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#link-to-chapter-2.1-1"><i class="fa fa-check"></i><b>4.5</b> Link to Chapter 2.1</a></li>
<li class="chapter" data-level="4.6" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#checking-assumptions-1"><i class="fa fa-check"></i><b>4.6</b> Checking assumptions</a></li>
<li class="chapter" data-level="4.7" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#creating-a-figure-1"><i class="fa fa-check"></i><b>4.7</b> Creating a figure</a></li>
<li class="chapter" data-level="4.8" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#reporting-the-results-1"><i class="fa fa-check"></i><b>4.8</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html"><i class="fa fa-check"></i><b>5</b> One-way ANOVA revisited</a><ul>
<li class="chapter" data-level="5.1" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#introduction-to-the-example-2"><i class="fa fa-check"></i><b>5.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="5.2" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#aov-output-reminder"><i class="fa fa-check"></i><b>5.2</b> <code>aov()</code> output reminder</a></li>
<li class="chapter" data-level="5.3" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#post-hoc-testing-for-aov"><i class="fa fa-check"></i><b>5.3</b> Post-hoc testing for <code>aov()</code></a></li>
<li class="chapter" data-level="5.4" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#applying-and-interpreting-lm-2"><i class="fa fa-check"></i><b>5.4</b> Applying and interpreting <code>lm()</code></a></li>
<li class="chapter" data-level="5.5" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#getting-predictions-from-the-model-2"><i class="fa fa-check"></i><b>5.5</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="5.6" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#link-to-chapter-2.1-2"><i class="fa fa-check"></i><b>5.6</b> Link to Chapter 2.1</a></li>
<li class="chapter" data-level="5.7" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#checking-assumptions-2"><i class="fa fa-check"></i><b>5.7</b> Checking assumptions</a></li>
<li class="chapter" data-level="5.8" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#post-hoc-testing-for-lm"><i class="fa fa-check"></i><b>5.8</b> Post-hoc testing for <code>lm()</code></a></li>
<li class="chapter" data-level="5.9" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#creating-a-figure-2"><i class="fa fa-check"></i><b>5.9</b> Creating a figure</a></li>
<li class="chapter" data-level="5.10" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#reporting-the-results-2"><i class="fa fa-check"></i><b>5.10</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html"><i class="fa fa-check"></i><b>6</b> Two-way ANOVA revisited</a><ul>
<li class="chapter" data-level="6.1" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#introduction-to-the-example-3"><i class="fa fa-check"></i><b>6.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="6.2" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#aov-output-reminder-1"><i class="fa fa-check"></i><b>6.2</b> <code>aov()</code> output reminder</a></li>
<li class="chapter" data-level="6.3" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#post-hoc-testing-for-aov-1"><i class="fa fa-check"></i><b>6.3</b> Post-hoc testing for <code>aov</code></a></li>
<li class="chapter" data-level="6.4" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#applying-and-interpreting-lm-3"><i class="fa fa-check"></i><b>6.4</b> Applying and interpreting <code>lm()</code></a></li>
<li class="chapter" data-level="6.5" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#getting-predictions-from-the-model-3"><i class="fa fa-check"></i><b>6.5</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="6.6" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#link-to-chapter-2.1-3"><i class="fa fa-check"></i><b>6.6</b> Link to Chapter 2.1</a></li>
<li class="chapter" data-level="6.7" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#checking-assumptions-3"><i class="fa fa-check"></i><b>6.7</b> Checking assumptions</a></li>
<li class="chapter" data-level="6.8" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#post-hoc-testing-for-lm-1"><i class="fa fa-check"></i><b>6.8</b> Post-hoc testing for <code>lm()</code></a></li>
<li class="chapter" data-level="6.9" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#creating-a-figure-3"><i class="fa fa-check"></i><b>6.9</b> Creating a figure</a></li>
<li class="chapter" data-level="6.10" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#reporting-the-results-3"><i class="fa fa-check"></i><b>6.10</b> Reporting the results</a></li>
</ul></li>
<li class="part"><span><b>III USING <code>glm()</code> FOR POISSON RESPONSES</b></span></li>
<li class="chapter" data-level="7" data-path="pois.html"><a href="pois.html"><i class="fa fa-check"></i><b>7</b> GLM for poisson responses</a><ul>
<li class="chapter" data-level="7.1" data-path="pois.html"><a href="pois.html#pois-intro"><i class="fa fa-check"></i><b>7.1</b> intro</a></li>
<li class="chapter" data-level="7.2" data-path="pois.html"><a href="pois.html#pois-build"><i class="fa fa-check"></i><b>7.2</b> build</a></li>
<li class="chapter" data-level="7.3" data-path="pois.html"><a href="pois.html#pois-output"><i class="fa fa-check"></i><b>7.3</b> output</a></li>
</ul></li>
<li class="part"><span><b>IV USING <code>glm()</code> FOR BINOMIAL RESPONSES</b></span></li>
<li class="chapter" data-level="8" data-path="bino.html"><a href="bino.html"><i class="fa fa-check"></i><b>8</b> GLM for binomial responses</a><ul>
<li class="chapter" data-level="8.1" data-path="bino.html"><a href="bino.html#bino-intro"><i class="fa fa-check"></i><b>8.1</b> intro</a></li>
<li class="chapter" data-level="8.2" data-path="bino.html"><a href="bino.html#bino-build"><i class="fa fa-check"></i><b>8.2</b> build</a></li>
<li class="chapter" data-level="8.3" data-path="bino.html"><a href="bino.html#bino-output"><i class="fa fa-check"></i><b>8.3</b> output</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>9</b> Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two-way-anova-revisit" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Two-way ANOVA revisited</h1>
<div id="introduction-to-the-example-3" class="section level2">
<h2><span class="header-section-number">6.1</span> Introduction to the example</h2>
<p>A group of amateur conchologists have collected live specimens of two species of rough periwinkle (intertidal, gastropod molluscs) from sites in northern England in the Spring (1) and Summer (2). Among other variables, they take a measure of the gut parasite load. Number of parasites is related to the number of parasites seen on a slide of gut contents and larger numbers indicate a higher parasite load. The data are in S <a href="data-raw/periwinkle.txt">periwinkle.txt</a>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="two-way-anova-revisit.html#cb40-1"></a>periwinkle &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;data-raw/periwinkle.txt&quot;</span>, <span class="dt">delim =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st"> &quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="two-way-anova-revisit.html#cb41-1"></a>periwinkle<span class="op">$</span>species &lt;-<span class="st"> </span><span class="kw">factor</span>(periwinkle<span class="op">$</span>species)</span>
<span id="cb41-2"><a href="two-way-anova-revisit.html#cb41-2"></a>periwinkle<span class="op">$</span>season &lt;-<span class="st"> </span><span class="kw">factor</span>(periwinkle<span class="op">$</span>season)</span></code></pre></div>
<p>Do a quick plot of the data. We have two explanatory variables: one can be mapped to the <em>x</em>-axis and the is mapped to a different aesthetic. We have used <code>fill</code>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="two-way-anova-revisit.html#cb42-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> periwinkle, <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> para, <span class="dt">fill =</span> species)) <span class="op">+</span></span>
<span id="cb42-2"><a href="two-way-anova-revisit.html#cb42-2"></a><span class="st">  </span><span class="kw">geom_violin</span>()</span></code></pre></div>
<p><img src="two_way_anova_revisit_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="two-way-anova-revisit.html#cb43-1"></a>peri_summary &lt;-<span class="st"> </span>periwinkle <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-2"><a href="two-way-anova-revisit.html#cb43-2"></a><span class="st">  </span><span class="kw">group_by</span>(season, species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-3"><a href="two-way-anova-revisit.html#cb43-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(para),</span>
<span id="cb43-4"><a href="two-way-anova-revisit.html#cb43-4"></a>            <span class="dt">sd =</span> <span class="kw">sd</span>(para),</span>
<span id="cb43-5"><a href="two-way-anova-revisit.html#cb43-5"></a>            <span class="dt">n =</span> <span class="kw">length</span>(para),</span>
<span id="cb43-6"><a href="two-way-anova-revisit.html#cb43-6"></a>            <span class="dt">se =</span> sd <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">season</th>
<th align="left">species</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">n</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Spring</td>
<td align="left">Littorina nigrolineata</td>
<td align="right">63.8</td>
<td align="right">11.92</td>
<td align="right">25</td>
<td align="right">2.38</td>
</tr>
<tr class="even">
<td align="left">Spring</td>
<td align="left">Littorina saxatilis</td>
<td align="right">56.5</td>
<td align="right">8.88</td>
<td align="right">25</td>
<td align="right">1.78</td>
</tr>
<tr class="odd">
<td align="left">Summer</td>
<td align="left">Littorina nigrolineata</td>
<td align="right">69.4</td>
<td align="right">11.44</td>
<td align="right">25</td>
<td align="right">2.29</td>
</tr>
<tr class="even">
<td align="left">Summer</td>
<td align="left">Littorina saxatilis</td>
<td align="right">72.9</td>
<td align="right">11.24</td>
<td align="right">25</td>
<td align="right">2.25</td>
</tr>
</tbody>
</table>
</div>
<div id="aov-output-reminder-1" class="section level2">
<h2><span class="header-section-number">6.2</span> <code>aov()</code> output reminder</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="two-way-anova-revisit.html#cb44-1"></a>mod &lt;-<span class="st"> </span><span class="kw">aov</span>(<span class="dt">data =</span> periwinkle, para <span class="op">~</span><span class="st"> </span>season <span class="op">*</span><span class="st"> </span>species)</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="two-way-anova-revisit.html#cb45-1"></a><span class="kw">summary</span>(mod)</span>
<span id="cb45-2"><a href="two-way-anova-revisit.html#cb45-2"></a><span class="co">#                Df Sum Sq Mean Sq F value Pr(&gt;F)    </span></span>
<span id="cb45-3"><a href="two-way-anova-revisit.html#cb45-3"></a><span class="co"># season          1   3058    3058   25.58  2e-06 ***</span></span>
<span id="cb45-4"><a href="two-way-anova-revisit.html#cb45-4"></a><span class="co"># species         1     90      90    0.75  0.387    </span></span>
<span id="cb45-5"><a href="two-way-anova-revisit.html#cb45-5"></a><span class="co"># season:species  1    724     724    6.05  0.016 *  </span></span>
<span id="cb45-6"><a href="two-way-anova-revisit.html#cb45-6"></a><span class="co"># Residuals      96  11477     120                   </span></span>
<span id="cb45-7"><a href="two-way-anova-revisit.html#cb45-7"></a><span class="co"># ---</span></span>
<span id="cb45-8"><a href="two-way-anova-revisit.html#cb45-8"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="two-way-anova-revisit.html#cb46-1"></a>res &lt;-<span class="st"> </span><span class="kw">summary</span>(mod)[[<span class="dv">1</span>]]</span>
<span id="cb46-2"><a href="two-way-anova-revisit.html#cb46-2"></a>df_seas &lt;-<span class="st"> </span>res<span class="op">$</span>Df[<span class="dv">1</span>]</span>
<span id="cb46-3"><a href="two-way-anova-revisit.html#cb46-3"></a>df_sp &lt;-<span class="st"> </span>res<span class="op">$</span>Df[<span class="dv">2</span>]</span>
<span id="cb46-4"><a href="two-way-anova-revisit.html#cb46-4"></a>df_seasxsp &lt;-<span class="st"> </span>res<span class="op">$</span>Df[<span class="dv">3</span>]</span>
<span id="cb46-5"><a href="two-way-anova-revisit.html#cb46-5"></a>df_err &lt;-<span class="st"> </span>res<span class="op">$</span>Df[<span class="dv">4</span>]</span>
<span id="cb46-6"><a href="two-way-anova-revisit.html#cb46-6"></a>fval_seas &lt;-<span class="st"> </span>res<span class="op">$</span><span class="st">`</span><span class="dt">F value</span><span class="st">`</span>[<span class="dv">1</span>]</span>
<span id="cb46-7"><a href="two-way-anova-revisit.html#cb46-7"></a>fval_sp &lt;-<span class="st"> </span>res<span class="op">$</span><span class="st">`</span><span class="dt">F value</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb46-8"><a href="two-way-anova-revisit.html#cb46-8"></a>fval_seasxsp &lt;-<span class="st"> </span>res<span class="op">$</span><span class="st">`</span><span class="dt">F value</span><span class="st">`</span>[<span class="dv">3</span>]</span>
<span id="cb46-9"><a href="two-way-anova-revisit.html#cb46-9"></a><span class="cf">if</span> (res<span class="op">$</span><span class="st">`</span><span class="dt">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>] <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.001</span>) {</span>
<span id="cb46-10"><a href="two-way-anova-revisit.html#cb46-10"></a>        pval_seas =<span class="st"> &quot;&lt; 0.001&quot;</span></span>
<span id="cb46-11"><a href="two-way-anova-revisit.html#cb46-11"></a>        }</span>
<span id="cb46-12"><a href="two-way-anova-revisit.html#cb46-12"></a><span class="cf">if</span> (res<span class="op">$</span><span class="st">`</span><span class="dt">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.001</span>) {</span>
<span id="cb46-13"><a href="two-way-anova-revisit.html#cb46-13"></a>        pval_seas =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;=&quot;</span>, <span class="kw">round</span>(res<span class="op">$</span><span class="st">`</span><span class="dt">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>], <span class="dv">3</span>))</span>
<span id="cb46-14"><a href="two-way-anova-revisit.html#cb46-14"></a>        }</span>
<span id="cb46-15"><a href="two-way-anova-revisit.html#cb46-15"></a><span class="cf">if</span> (res<span class="op">$</span><span class="st">`</span><span class="dt">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.001</span>) {</span>
<span id="cb46-16"><a href="two-way-anova-revisit.html#cb46-16"></a>        pval_sp =<span class="st"> &quot;&lt; 0.001&quot;</span></span>
<span id="cb46-17"><a href="two-way-anova-revisit.html#cb46-17"></a>        }</span>
<span id="cb46-18"><a href="two-way-anova-revisit.html#cb46-18"></a><span class="cf">if</span> (res<span class="op">$</span><span class="st">`</span><span class="dt">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.001</span>) {</span>
<span id="cb46-19"><a href="two-way-anova-revisit.html#cb46-19"></a>        pval_sp =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;=&quot;</span>, <span class="kw">round</span>(res<span class="op">$</span><span class="st">`</span><span class="dt">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">2</span>], <span class="dv">3</span>))</span>
<span id="cb46-20"><a href="two-way-anova-revisit.html#cb46-20"></a>        }</span>
<span id="cb46-21"><a href="two-way-anova-revisit.html#cb46-21"></a><span class="cf">if</span> (res<span class="op">$</span><span class="st">`</span><span class="dt">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">3</span>] <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.001</span>) {</span>
<span id="cb46-22"><a href="two-way-anova-revisit.html#cb46-22"></a>        pval_seasxsp =<span class="st"> &quot;&lt; 0.001&quot;</span></span>
<span id="cb46-23"><a href="two-way-anova-revisit.html#cb46-23"></a>        }</span>
<span id="cb46-24"><a href="two-way-anova-revisit.html#cb46-24"></a><span class="cf">if</span> (res<span class="op">$</span><span class="st">`</span><span class="dt">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">3</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.001</span>) {</span>
<span id="cb46-25"><a href="two-way-anova-revisit.html#cb46-25"></a>        pval_seasxsp =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;=&quot;</span>, <span class="kw">round</span>(res<span class="op">$</span><span class="st">`</span><span class="dt">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">3</span>], <span class="dv">3</span>))</span>
<span id="cb46-26"><a href="two-way-anova-revisit.html#cb46-26"></a>        }</span></code></pre></div>
<p>There was a significantly greater number of parasites in the Summer than the Spring (ANOVA: <span class="math inline">\(F\)</span> = 25.58; <span class="math inline">\(d.f.\)</span> = 1, 96; <span class="math inline">\(p\)</span> &lt; 0.001). There was no difference between the species when averaged across the season but there was significant interaction (ANOVA: <span class="math inline">\(F\)</span> = 6.053; <span class="math inline">\(d.f.\)</span> = 1, 96; <span class="math inline">\(p\)</span> = 0.016) between season and species with higher numbers infecting <em>L.nigrolineata</em> in the Spring whilst <em>L.saxatilis</em> was more heavily parasitized in the Summer.</p>
<p>We need a post-hoc test to discover which comparisons are significant.</p>
</div>
<div id="post-hoc-testing-for-aov-1" class="section level2">
<h2><span class="header-section-number">6.3</span> Post-hoc testing for <code>aov</code></h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="two-way-anova-revisit.html#cb47-1"></a><span class="kw">TukeyHSD</span>(mod)</span>
<span id="cb47-2"><a href="two-way-anova-revisit.html#cb47-2"></a><span class="co">#   Tukey multiple comparisons of means</span></span>
<span id="cb47-3"><a href="two-way-anova-revisit.html#cb47-3"></a><span class="co">#     95% family-wise confidence level</span></span>
<span id="cb47-4"><a href="two-way-anova-revisit.html#cb47-4"></a><span class="co"># </span></span>
<span id="cb47-5"><a href="two-way-anova-revisit.html#cb47-5"></a><span class="co"># Fit: aov(formula = para ~ season * species, data = periwinkle)</span></span>
<span id="cb47-6"><a href="two-way-anova-revisit.html#cb47-6"></a><span class="co"># </span></span>
<span id="cb47-7"><a href="two-way-anova-revisit.html#cb47-7"></a><span class="co"># $season</span></span>
<span id="cb47-8"><a href="two-way-anova-revisit.html#cb47-8"></a><span class="co">#               diff  lwr  upr p adj</span></span>
<span id="cb47-9"><a href="two-way-anova-revisit.html#cb47-9"></a><span class="co"># Summer-Spring 11.1 6.72 15.4     0</span></span>
<span id="cb47-10"><a href="two-way-anova-revisit.html#cb47-10"></a><span class="co"># </span></span>
<span id="cb47-11"><a href="two-way-anova-revisit.html#cb47-11"></a><span class="co"># $species</span></span>
<span id="cb47-12"><a href="two-way-anova-revisit.html#cb47-12"></a><span class="co">#                                            diff   lwr  upr p adj</span></span>
<span id="cb47-13"><a href="two-way-anova-revisit.html#cb47-13"></a><span class="co"># Littorina saxatilis-Littorina nigrolineata -1.9 -6.24 2.44 0.387</span></span>
<span id="cb47-14"><a href="two-way-anova-revisit.html#cb47-14"></a><span class="co"># </span></span>
<span id="cb47-15"><a href="two-way-anova-revisit.html#cb47-15"></a><span class="co"># $`season:species`</span></span>
<span id="cb47-16"><a href="two-way-anova-revisit.html#cb47-16"></a><span class="co">#                                                               diff    lwr</span></span>
<span id="cb47-17"><a href="two-way-anova-revisit.html#cb47-17"></a><span class="co"># Summer:Littorina nigrolineata-Spring:Littorina nigrolineata   5.68  -2.41</span></span>
<span id="cb47-18"><a href="two-way-anova-revisit.html#cb47-18"></a><span class="co"># Spring:Littorina saxatilis-Spring:Littorina nigrolineata     -7.28 -15.37</span></span>
<span id="cb47-19"><a href="two-way-anova-revisit.html#cb47-19"></a><span class="co"># Summer:Littorina saxatilis-Spring:Littorina nigrolineata      9.16   1.07</span></span>
<span id="cb47-20"><a href="two-way-anova-revisit.html#cb47-20"></a><span class="co"># Spring:Littorina saxatilis-Summer:Littorina nigrolineata    -12.96 -21.05</span></span>
<span id="cb47-21"><a href="two-way-anova-revisit.html#cb47-21"></a><span class="co"># Summer:Littorina saxatilis-Summer:Littorina nigrolineata      3.48  -4.61</span></span>
<span id="cb47-22"><a href="two-way-anova-revisit.html#cb47-22"></a><span class="co"># Summer:Littorina saxatilis-Spring:Littorina saxatilis        16.44   8.35</span></span>
<span id="cb47-23"><a href="two-way-anova-revisit.html#cb47-23"></a><span class="co">#                                                                upr p adj</span></span>
<span id="cb47-24"><a href="two-way-anova-revisit.html#cb47-24"></a><span class="co"># Summer:Littorina nigrolineata-Spring:Littorina nigrolineata 13.766 0.263</span></span>
<span id="cb47-25"><a href="two-way-anova-revisit.html#cb47-25"></a><span class="co"># Spring:Littorina saxatilis-Spring:Littorina nigrolineata     0.806 0.093</span></span>
<span id="cb47-26"><a href="two-way-anova-revisit.html#cb47-26"></a><span class="co"># Summer:Littorina saxatilis-Spring:Littorina nigrolineata    17.246 0.020</span></span>
<span id="cb47-27"><a href="two-way-anova-revisit.html#cb47-27"></a><span class="co"># Spring:Littorina saxatilis-Summer:Littorina nigrolineata    -4.874 0.000</span></span>
<span id="cb47-28"><a href="two-way-anova-revisit.html#cb47-28"></a><span class="co"># Summer:Littorina saxatilis-Summer:Littorina nigrolineata    11.566 0.675</span></span>
<span id="cb47-29"><a href="two-way-anova-revisit.html#cb47-29"></a><span class="co"># Summer:Littorina saxatilis-Spring:Littorina saxatilis       24.526 0.000</span></span></code></pre></div>
<p>Note that the output is wrapped because the names associated with each comparison, for example “Summer:Littorina nigrolineata-Spring:Littorina nigrolineata”, are quite long.</p>
<p><em>L.saxatilis</em> has fewer parasites in the spring than <em>L.nigrolineata</em> (<span class="math inline">\(p\)</span> = 0.02) but this rises significantly in Summer (<span class="math inline">\(p\)</span> &lt; 0.001) while that of <em>L.nigrolineata</em> does not.</p>
</div>
<div id="applying-and-interpreting-lm-3" class="section level2">
<h2><span class="header-section-number">6.4</span> Applying and interpreting <code>lm()</code></h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="two-way-anova-revisit.html#cb48-1"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data =</span> periwinkle, para <span class="op">~</span><span class="st"> </span>season <span class="op">*</span><span class="st"> </span>species)</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="two-way-anova-revisit.html#cb49-1"></a>mod</span>
<span id="cb49-2"><a href="two-way-anova-revisit.html#cb49-2"></a><span class="co"># </span></span>
<span id="cb49-3"><a href="two-way-anova-revisit.html#cb49-3"></a><span class="co"># Call:</span></span>
<span id="cb49-4"><a href="two-way-anova-revisit.html#cb49-4"></a><span class="co"># lm(formula = para ~ season * species, data = periwinkle)</span></span>
<span id="cb49-5"><a href="two-way-anova-revisit.html#cb49-5"></a><span class="co"># </span></span>
<span id="cb49-6"><a href="two-way-anova-revisit.html#cb49-6"></a><span class="co"># Coefficients:</span></span>
<span id="cb49-7"><a href="two-way-anova-revisit.html#cb49-7"></a><span class="co">#                             (Intercept)  </span></span>
<span id="cb49-8"><a href="two-way-anova-revisit.html#cb49-8"></a><span class="co">#                                   63.76  </span></span>
<span id="cb49-9"><a href="two-way-anova-revisit.html#cb49-9"></a><span class="co">#                            seasonSummer  </span></span>
<span id="cb49-10"><a href="two-way-anova-revisit.html#cb49-10"></a><span class="co">#                                    5.68  </span></span>
<span id="cb49-11"><a href="two-way-anova-revisit.html#cb49-11"></a><span class="co">#              speciesLittorina saxatilis  </span></span>
<span id="cb49-12"><a href="two-way-anova-revisit.html#cb49-12"></a><span class="co">#                                   -7.28  </span></span>
<span id="cb49-13"><a href="two-way-anova-revisit.html#cb49-13"></a><span class="co"># seasonSummer:speciesLittorina saxatilis  </span></span>
<span id="cb49-14"><a href="two-way-anova-revisit.html#cb49-14"></a><span class="co">#                                   10.76</span></span></code></pre></div>
<p>The mean of L.nigrolineata in the Spring is (63.76). It is the intercept (<span class="math inline">\(\beta_{0}\)</span>) because “Littorina nigrolineata” comes before “Littorina saxatilis” and “Spring” comes before “Summer” in the alphabet.</p>
<p>The value labelled “seasonSummer” is the difference between the intercept and the <em>L.nigrolineata</em> in the Summer. It indicates that, holding all other variables constant (in this case, species), if you change the season variable to Summer you have to add 5.68 to 63.76 to get the mean of <em>L.nigrolineata</em> in the Summer.</p>
<p>The value labelled “speciesLittorina saxatilis” is also relative to the intercept. Holding all other variables constant (in this case, season), if you change the species variable to <em>Littorina saxatilis</em> you have to add -7.28 to 63.76 to get the mean of <em>L.saxatilis</em> in the Spring.</p>
<p>Similarly, the value labelled “seasonSummer:speciesLittorina saxatilis” is relative to the intercept but the estimate, 10.76 is what you must add <strong>additionally</strong>. If you change the season variable to Summer and the species variable to <em>Littorina saxatilis</em> you have to add 5.68 (the effect of season), -7.28 (the effect of species) and 10.76 (the additional effect) to to 63.76 to get the mean of <em>L.saxatilis</em> in the Summer.</p>
</div>
<div id="getting-predictions-from-the-model-3" class="section level2">
<h2><span class="header-section-number">6.5</span> Getting predictions from the model</h2>
<p>You must have all the combination. these are the means for two categorical variables</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="two-way-anova-revisit.html#cb50-1"></a>predictions &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">species =</span> peri_summary<span class="op">$</span>species, <span class="dt">season =</span> peri_summary<span class="op">$</span>season)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="two-way-anova-revisit.html#cb51-1"></a>predictions<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, <span class="dt">newdata =</span> predictions)</span></code></pre></div>
</div>
<div id="link-to-chapter-2.1-3" class="section level2">
<h2><span class="header-section-number">6.6</span> Link to Chapter 2.1</h2>
<p>Replacing the terms shown in Figure <a href="what-are-linear-models.html#fig:lm-annotated">2.1</a> with the values in this example gives us <a href="#fig:two-way-annotated"><strong>??</strong></a>.</p>

</div>
<div id="checking-assumptions-3" class="section level2">
<h2><span class="header-section-number">6.7</span> Checking assumptions</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="two-way-anova-revisit.html#cb52-1"></a><span class="kw">plot</span>(mod, <span class="dt">which =</span> <span class="dv">2</span>)</span>
<span id="cb52-2"><a href="two-way-anova-revisit.html#cb52-2"></a><span class="kw">plot</span>(mod, <span class="dt">which =</span> <span class="dv">1</span>)</span>
<span id="cb52-3"><a href="two-way-anova-revisit.html#cb52-3"></a><span class="kw">shapiro.test</span>(mod<span class="op">$</span>res)</span>
<span id="cb52-4"><a href="two-way-anova-revisit.html#cb52-4"></a><span class="co"># </span></span>
<span id="cb52-5"><a href="two-way-anova-revisit.html#cb52-5"></a><span class="co">#   Shapiro-Wilk normality test</span></span>
<span id="cb52-6"><a href="two-way-anova-revisit.html#cb52-6"></a><span class="co"># </span></span>
<span id="cb52-7"><a href="two-way-anova-revisit.html#cb52-7"></a><span class="co"># data:  mod$res</span></span>
<span id="cb52-8"><a href="two-way-anova-revisit.html#cb52-8"></a><span class="co"># W = 1, p-value = 0.3</span></span></code></pre></div>
<p><img src="two_way_anova_revisit_files/figure-html/unnamed-chunk-16-1.png" width="80%" style="display: block; margin: auto auto auto 0;" /><img src="two_way_anova_revisit_files/figure-html/unnamed-chunk-16-2.png" width="80%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="post-hoc-testing-for-lm-1" class="section level2">
<h2><span class="header-section-number">6.8</span> Post-hoc testing for <code>lm()</code></h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="two-way-anova-revisit.html#cb53-1"></a><span class="kw">library</span>(multcomp)</span></code></pre></div>
<p>generic example. define linfct, mcp
multiple comparison procedures</p>
<pre><code>
</code></pre>
<p>can be obtained by fitting the so-called cell-means model based on a new factor derived as the interaction of species and season:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="two-way-anova-revisit.html#cb55-1"></a>periwinkle<span class="op">$</span>seasxspp &lt;-<span class="st"> </span><span class="kw">interaction</span>(periwinkle<span class="op">$</span>season, periwinkle<span class="op">$</span>species)</span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="two-way-anova-revisit.html#cb56-1"></a>mod2 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data =</span> periwinkle, para <span class="op">~</span><span class="st"> </span>seasxspp)</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="two-way-anova-revisit.html#cb57-1"></a></span>
<span id="cb57-2"><a href="two-way-anova-revisit.html#cb57-2"></a></span>
<span id="cb57-3"><a href="two-way-anova-revisit.html#cb57-3"></a>mod2_mc &lt;-<span class="st"> </span><span class="kw">glht</span>(mod2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">seasxspp =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb57-4"><a href="two-way-anova-revisit.html#cb57-4"></a><span class="kw">summary</span>(mod2_mc)</span>
<span id="cb57-5"><a href="two-way-anova-revisit.html#cb57-5"></a><span class="co"># </span></span>
<span id="cb57-6"><a href="two-way-anova-revisit.html#cb57-6"></a><span class="co">#    Simultaneous Tests for General Linear Hypotheses</span></span>
<span id="cb57-7"><a href="two-way-anova-revisit.html#cb57-7"></a><span class="co"># </span></span>
<span id="cb57-8"><a href="two-way-anova-revisit.html#cb57-8"></a><span class="co"># Multiple Comparisons of Means: Tukey Contrasts</span></span>
<span id="cb57-9"><a href="two-way-anova-revisit.html#cb57-9"></a><span class="co"># </span></span>
<span id="cb57-10"><a href="two-way-anova-revisit.html#cb57-10"></a><span class="co"># </span></span>
<span id="cb57-11"><a href="two-way-anova-revisit.html#cb57-11"></a><span class="co"># Fit: lm(formula = para ~ seasxspp, data = periwinkle)</span></span>
<span id="cb57-12"><a href="two-way-anova-revisit.html#cb57-12"></a><span class="co"># </span></span>
<span id="cb57-13"><a href="two-way-anova-revisit.html#cb57-13"></a><span class="co"># Linear Hypotheses:</span></span>
<span id="cb57-14"><a href="two-way-anova-revisit.html#cb57-14"></a><span class="co">#                                                                    Estimate</span></span>
<span id="cb57-15"><a href="two-way-anova-revisit.html#cb57-15"></a><span class="co"># Summer.Littorina nigrolineata - Spring.Littorina nigrolineata == 0     5.68</span></span>
<span id="cb57-16"><a href="two-way-anova-revisit.html#cb57-16"></a><span class="co"># Spring.Littorina saxatilis - Spring.Littorina nigrolineata == 0       -7.28</span></span>
<span id="cb57-17"><a href="two-way-anova-revisit.html#cb57-17"></a><span class="co"># Summer.Littorina saxatilis - Spring.Littorina nigrolineata == 0        9.16</span></span>
<span id="cb57-18"><a href="two-way-anova-revisit.html#cb57-18"></a><span class="co"># Spring.Littorina saxatilis - Summer.Littorina nigrolineata == 0      -12.96</span></span>
<span id="cb57-19"><a href="two-way-anova-revisit.html#cb57-19"></a><span class="co"># Summer.Littorina saxatilis - Summer.Littorina nigrolineata == 0        3.48</span></span>
<span id="cb57-20"><a href="two-way-anova-revisit.html#cb57-20"></a><span class="co"># Summer.Littorina saxatilis - Spring.Littorina saxatilis == 0          16.44</span></span>
<span id="cb57-21"><a href="two-way-anova-revisit.html#cb57-21"></a><span class="co">#                                                                    Std. Error</span></span>
<span id="cb57-22"><a href="two-way-anova-revisit.html#cb57-22"></a><span class="co"># Summer.Littorina nigrolineata - Spring.Littorina nigrolineata == 0       3.09</span></span>
<span id="cb57-23"><a href="two-way-anova-revisit.html#cb57-23"></a><span class="co"># Spring.Littorina saxatilis - Spring.Littorina nigrolineata == 0          3.09</span></span>
<span id="cb57-24"><a href="two-way-anova-revisit.html#cb57-24"></a><span class="co"># Summer.Littorina saxatilis - Spring.Littorina nigrolineata == 0          3.09</span></span>
<span id="cb57-25"><a href="two-way-anova-revisit.html#cb57-25"></a><span class="co"># Spring.Littorina saxatilis - Summer.Littorina nigrolineata == 0          3.09</span></span>
<span id="cb57-26"><a href="two-way-anova-revisit.html#cb57-26"></a><span class="co"># Summer.Littorina saxatilis - Summer.Littorina nigrolineata == 0          3.09</span></span>
<span id="cb57-27"><a href="two-way-anova-revisit.html#cb57-27"></a><span class="co"># Summer.Littorina saxatilis - Spring.Littorina saxatilis == 0             3.09</span></span>
<span id="cb57-28"><a href="two-way-anova-revisit.html#cb57-28"></a><span class="co">#                                                                    t value</span></span>
<span id="cb57-29"><a href="two-way-anova-revisit.html#cb57-29"></a><span class="co"># Summer.Littorina nigrolineata - Spring.Littorina nigrolineata == 0    1.84</span></span>
<span id="cb57-30"><a href="two-way-anova-revisit.html#cb57-30"></a><span class="co"># Spring.Littorina saxatilis - Spring.Littorina nigrolineata == 0      -2.35</span></span>
<span id="cb57-31"><a href="two-way-anova-revisit.html#cb57-31"></a><span class="co"># Summer.Littorina saxatilis - Spring.Littorina nigrolineata == 0       2.96</span></span>
<span id="cb57-32"><a href="two-way-anova-revisit.html#cb57-32"></a><span class="co"># Spring.Littorina saxatilis - Summer.Littorina nigrolineata == 0      -4.19</span></span>
<span id="cb57-33"><a href="two-way-anova-revisit.html#cb57-33"></a><span class="co"># Summer.Littorina saxatilis - Summer.Littorina nigrolineata == 0       1.13</span></span>
<span id="cb57-34"><a href="two-way-anova-revisit.html#cb57-34"></a><span class="co"># Summer.Littorina saxatilis - Spring.Littorina saxatilis == 0          5.32</span></span>
<span id="cb57-35"><a href="two-way-anova-revisit.html#cb57-35"></a><span class="co">#                                                                    Pr(&gt;|t|)    </span></span>
<span id="cb57-36"><a href="two-way-anova-revisit.html#cb57-36"></a><span class="co"># Summer.Littorina nigrolineata - Spring.Littorina nigrolineata == 0    0.263    </span></span>
<span id="cb57-37"><a href="two-way-anova-revisit.html#cb57-37"></a><span class="co"># Spring.Littorina saxatilis - Spring.Littorina nigrolineata == 0       0.093 .  </span></span>
<span id="cb57-38"><a href="two-way-anova-revisit.html#cb57-38"></a><span class="co"># Summer.Littorina saxatilis - Spring.Littorina nigrolineata == 0       0.020 *  </span></span>
<span id="cb57-39"><a href="two-way-anova-revisit.html#cb57-39"></a><span class="co"># Spring.Littorina saxatilis - Summer.Littorina nigrolineata == 0      &lt;0.001 ***</span></span>
<span id="cb57-40"><a href="two-way-anova-revisit.html#cb57-40"></a><span class="co"># Summer.Littorina saxatilis - Summer.Littorina nigrolineata == 0       0.675    </span></span>
<span id="cb57-41"><a href="two-way-anova-revisit.html#cb57-41"></a><span class="co"># Summer.Littorina saxatilis - Spring.Littorina saxatilis == 0         &lt;0.001 ***</span></span>
<span id="cb57-42"><a href="two-way-anova-revisit.html#cb57-42"></a><span class="co"># ---</span></span>
<span id="cb57-43"><a href="two-way-anova-revisit.html#cb57-43"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb57-44"><a href="two-way-anova-revisit.html#cb57-44"></a><span class="co"># (Adjusted p values reported -- single-step method)</span></span></code></pre></div>
</div>
<div id="creating-a-figure-3" class="section level2">
<h2><span class="header-section-number">6.9</span> Creating a figure</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="two-way-anova-revisit.html#cb58-1"></a><span class="co">#summarise the data </span></span>
<span id="cb58-2"><a href="two-way-anova-revisit.html#cb58-2"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb58-3"><a href="two-way-anova-revisit.html#cb58-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> periwinkle, <span class="kw">aes</span>(<span class="dt">x =</span> season,</span>
<span id="cb58-4"><a href="two-way-anova-revisit.html#cb58-4"></a>                                    <span class="dt">y =</span> para,</span>
<span id="cb58-5"><a href="two-way-anova-revisit.html#cb58-5"></a>                                    <span class="dt">colour =</span> species),</span>
<span id="cb58-6"><a href="two-way-anova-revisit.html#cb58-6"></a>             <span class="dt">position =</span> <span class="kw">position_jitterdodge</span>(<span class="dt">dodge.width =</span> <span class="dv">1</span>,</span>
<span id="cb58-7"><a href="two-way-anova-revisit.html#cb58-7"></a>                                             <span class="dt">jitter.width =</span> <span class="fl">0.4</span>,</span>
<span id="cb58-8"><a href="two-way-anova-revisit.html#cb58-8"></a>                                             <span class="dt">jitter.height =</span> <span class="dv">0</span>),</span>
<span id="cb58-9"><a href="two-way-anova-revisit.html#cb58-9"></a>             <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb58-10"><a href="two-way-anova-revisit.html#cb58-10"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> peri_summary, </span>
<span id="cb58-11"><a href="two-way-anova-revisit.html#cb58-11"></a>                <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">ymin =</span> mean <span class="op">-</span><span class="st"> </span>se, <span class="dt">ymax =</span> mean <span class="op">+</span><span class="st"> </span>se, <span class="dt">group =</span> species),</span>
<span id="cb58-12"><a href="two-way-anova-revisit.html#cb58-12"></a>                <span class="dt">width =</span> <span class="fl">0.4</span>, <span class="dt">size =</span> <span class="dv">1</span>,</span>
<span id="cb58-13"><a href="two-way-anova-revisit.html#cb58-13"></a>                <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb58-14"><a href="two-way-anova-revisit.html#cb58-14"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> peri_summary, </span>
<span id="cb58-15"><a href="two-way-anova-revisit.html#cb58-15"></a>                <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">ymin =</span> mean, <span class="dt">ymax =</span> mean, <span class="dt">group =</span> species),</span>
<span id="cb58-16"><a href="two-way-anova-revisit.html#cb58-16"></a>                <span class="dt">width =</span> <span class="fl">0.3</span>, <span class="dt">size =</span> <span class="dv">1</span>,</span>
<span id="cb58-17"><a href="two-way-anova-revisit.html#cb58-17"></a>                <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="dv">1</span>) ) <span class="op">+</span></span>
<span id="cb58-18"><a href="two-way-anova-revisit.html#cb58-18"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Season&quot;</span>) <span class="op">+</span></span>
<span id="cb58-19"><a href="two-way-anova-revisit.html#cb58-19"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Number of parasites&quot;</span>,</span>
<span id="cb58-20"><a href="two-way-anova-revisit.html#cb58-20"></a>                     <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb58-21"><a href="two-way-anova-revisit.html#cb58-21"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">128</span>)) <span class="op">+</span></span>
<span id="cb58-22"><a href="two-way-anova-revisit.html#cb58-22"></a><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> pal4[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="op">+</span></span>
<span id="cb58-23"><a href="two-way-anova-revisit.html#cb58-23"></a><span class="st">  </span><span class="co"># Spring:Littorina nigrolineata-Summer:Littorina saxatilis *</span></span>
<span id="cb58-24"><a href="two-way-anova-revisit.html#cb58-24"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;segment&quot;</span>, </span>
<span id="cb58-25"><a href="two-way-anova-revisit.html#cb58-25"></a>           <span class="dt">x =</span> <span class="fl">1.25</span>, <span class="dt">xend =</span> <span class="fl">1.75</span>, </span>
<span id="cb58-26"><a href="two-way-anova-revisit.html#cb58-26"></a>           <span class="dt">y =</span> <span class="dv">110</span>, <span class="dt">yend =</span> <span class="dv">110</span>,</span>
<span id="cb58-27"><a href="two-way-anova-revisit.html#cb58-27"></a>           <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb58-28"><a href="two-way-anova-revisit.html#cb58-28"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;segment&quot;</span>, </span>
<span id="cb58-29"><a href="two-way-anova-revisit.html#cb58-29"></a>           <span class="dt">x =</span> <span class="fl">1.25</span>, <span class="dt">xend =</span> <span class="fl">1.25</span>,</span>
<span id="cb58-30"><a href="two-way-anova-revisit.html#cb58-30"></a>           <span class="dt">y =</span> <span class="dv">110</span>, <span class="dt">yend =</span> <span class="dv">105</span>,</span>
<span id="cb58-31"><a href="two-way-anova-revisit.html#cb58-31"></a>           <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb58-32"><a href="two-way-anova-revisit.html#cb58-32"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;segment&quot;</span>, </span>
<span id="cb58-33"><a href="two-way-anova-revisit.html#cb58-33"></a>           <span class="dt">x =</span> <span class="fl">1.75</span>, <span class="dt">xend =</span> <span class="fl">1.75</span>,</span>
<span id="cb58-34"><a href="two-way-anova-revisit.html#cb58-34"></a>           <span class="dt">y =</span> <span class="dv">110</span>, <span class="dt">yend =</span> <span class="dv">105</span>,</span>
<span id="cb58-35"><a href="two-way-anova-revisit.html#cb58-35"></a>           <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb58-36"><a href="two-way-anova-revisit.html#cb58-36"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, </span>
<span id="cb58-37"><a href="two-way-anova-revisit.html#cb58-37"></a>           <span class="dt">x =</span> <span class="fl">1.5</span>,  <span class="dt">y =</span> <span class="dv">112</span>,</span>
<span id="cb58-38"><a href="two-way-anova-revisit.html#cb58-38"></a>           <span class="dt">label =</span> <span class="st">&quot;***&quot;</span>, <span class="dt">size =</span> <span class="dv">6</span>) <span class="op">+</span></span>
<span id="cb58-39"><a href="two-way-anova-revisit.html#cb58-39"></a><span class="st">  </span><span class="co"># Summer:Littorina nigrolineata-Spring:Littorina saxatilis: ***</span></span>
<span id="cb58-40"><a href="two-way-anova-revisit.html#cb58-40"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;segment&quot;</span>, </span>
<span id="cb58-41"><a href="two-way-anova-revisit.html#cb58-41"></a>           <span class="dt">x =</span> <span class="fl">1.25</span>, <span class="dt">xend =</span> <span class="fl">0.75</span>,</span>
<span id="cb58-42"><a href="two-way-anova-revisit.html#cb58-42"></a>           <span class="dt">y =</span> <span class="dv">90</span>, <span class="dt">yend =</span> <span class="dv">90</span>,</span>
<span id="cb58-43"><a href="two-way-anova-revisit.html#cb58-43"></a>           <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb58-44"><a href="two-way-anova-revisit.html#cb58-44"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;segment&quot;</span>, </span>
<span id="cb58-45"><a href="two-way-anova-revisit.html#cb58-45"></a>           <span class="dt">x =</span> <span class="fl">1.25</span>, <span class="dt">xend =</span> <span class="fl">1.25</span>,</span>
<span id="cb58-46"><a href="two-way-anova-revisit.html#cb58-46"></a>           <span class="dt">y =</span> <span class="dv">90</span>, <span class="dt">yend =</span> <span class="dv">85</span>,</span>
<span id="cb58-47"><a href="two-way-anova-revisit.html#cb58-47"></a>           <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb58-48"><a href="two-way-anova-revisit.html#cb58-48"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;segment&quot;</span>, </span>
<span id="cb58-49"><a href="two-way-anova-revisit.html#cb58-49"></a>           <span class="dt">x =</span> <span class="fl">0.75</span>, <span class="dt">xend =</span> <span class="fl">0.75</span>,</span>
<span id="cb58-50"><a href="two-way-anova-revisit.html#cb58-50"></a>           <span class="dt">y =</span> <span class="dv">90</span>, <span class="dt">yend =</span> <span class="dv">85</span>,</span>
<span id="cb58-51"><a href="two-way-anova-revisit.html#cb58-51"></a>           <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb58-52"><a href="two-way-anova-revisit.html#cb58-52"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">1</span>,  <span class="dt">y =</span> <span class="dv">92</span>,</span>
<span id="cb58-53"><a href="two-way-anova-revisit.html#cb58-53"></a>           <span class="dt">label =</span> <span class="st">&quot;**&quot;</span>, <span class="dt">size =</span> <span class="dv">6</span>) <span class="op">+</span></span>
<span id="cb58-54"><a href="two-way-anova-revisit.html#cb58-54"></a><span class="co"># Summer:Littorina saxatilis-Spring:Littorina saxatilis: ***</span></span>
<span id="cb58-55"><a href="two-way-anova-revisit.html#cb58-55"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;segment&quot;</span>,</span>
<span id="cb58-56"><a href="two-way-anova-revisit.html#cb58-56"></a>           <span class="dt">x =</span> <span class="fl">0.75</span>, <span class="dt">xend =</span> <span class="fl">1.75</span>,</span>
<span id="cb58-57"><a href="two-way-anova-revisit.html#cb58-57"></a>           <span class="dt">y =</span> <span class="dv">120</span>, <span class="dt">yend =</span> <span class="dv">120</span>,</span>
<span id="cb58-58"><a href="two-way-anova-revisit.html#cb58-58"></a>           <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb58-59"><a href="two-way-anova-revisit.html#cb58-59"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;segment&quot;</span>,</span>
<span id="cb58-60"><a href="two-way-anova-revisit.html#cb58-60"></a>           <span class="dt">x =</span> <span class="fl">0.75</span>, <span class="dt">xend =</span> <span class="fl">0.75</span>,</span>
<span id="cb58-61"><a href="two-way-anova-revisit.html#cb58-61"></a>           <span class="dt">y =</span> <span class="dv">120</span>, <span class="dt">yend =</span> <span class="dv">115</span>,</span>
<span id="cb58-62"><a href="two-way-anova-revisit.html#cb58-62"></a>           <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb58-63"><a href="two-way-anova-revisit.html#cb58-63"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;segment&quot;</span>,</span>
<span id="cb58-64"><a href="two-way-anova-revisit.html#cb58-64"></a>           <span class="dt">x =</span> <span class="fl">1.75</span>, <span class="dt">xend =</span> <span class="fl">1.75</span>,</span>
<span id="cb58-65"><a href="two-way-anova-revisit.html#cb58-65"></a>           <span class="dt">y =</span> <span class="dv">120</span>, <span class="dt">yend =</span> <span class="dv">115</span>,</span>
<span id="cb58-66"><a href="two-way-anova-revisit.html#cb58-66"></a>           <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb58-67"><a href="two-way-anova-revisit.html#cb58-67"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">1.25</span>,  <span class="dt">y =</span> <span class="dv">123</span>,</span>
<span id="cb58-68"><a href="two-way-anova-revisit.html#cb58-68"></a>           <span class="dt">label =</span> <span class="st">&quot;***&quot;</span>, <span class="dt">size =</span> <span class="dv">6</span>) <span class="op">+</span></span>
<span id="cb58-69"><a href="two-way-anova-revisit.html#cb58-69"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb58-70"><a href="two-way-anova-revisit.html#cb58-70"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb58-71"><a href="two-way-anova-revisit.html#cb58-71"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.85</span>, <span class="fl">0.98</span>)) </span></code></pre></div>
<p><img src="two_way_anova_revisit_files/figure-html/two-one-anova-1.png" width="80%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="reporting-the-results-3" class="section level2">
<h2><span class="header-section-number">6.10</span> Reporting the results</h2>
<p>See figure <a href="#fig:fig-two-anova-report"><strong>??</strong></a>.</p>


</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="one-way-anova-revisit.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pois.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/3mmaRand/singlm/edit/master/two_way_anova_revisit.Rmd",
"text": "Make an edit suggestion"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["singlm.pdf", "singlm.epub", "https://github.com/3mmaRand/singlm/raw/master/two_way_anova_revisit.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
