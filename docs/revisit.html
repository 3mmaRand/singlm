<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 What are linear models | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</title>
  <meta name="description" content="The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 What are linear models | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 What are linear models | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R" />
  
  <meta name="twitter:description" content="The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Emma Rand" />


<meta name="date" content="2020-07-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="pois.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">singlm</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>0.1</b> Who is this book for?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#formatting-options-on-the-menu"><i class="fa fa-check"></i><b>0.2</b> formatting options on the menu</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#conventions-used-in-the-book"><i class="fa fa-check"></i><b>0.3</b> Conventions used in the book</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#overview-of-the-chapter-contents"><i class="fa fa-check"></i><b>0.4</b> Overview of the chapter contents</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#introductory-class-revision"><i class="fa fa-check"></i><b>0.5</b> Introductory class revision</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#approach-of-this-book"><i class="fa fa-check"></i><b>0.6</b> Approach of this book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="revisit.html"><a href="revisit.html"><i class="fa fa-check"></i><b>1</b> What are linear models</a><ul>
<li class="chapter" data-level="1.1" data-path="revisit.html"><a href="revisit.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="revisit.html"><a href="revisit.html#what-is-a-linear-model"><i class="fa fa-check"></i><b>1.2</b> What is a linear model?</a></li>
<li class="chapter" data-level="1.3" data-path="revisit.html"><a href="revisit.html#single-linear-regression"><i class="fa fa-check"></i><b>1.3</b> Single linear regression</a><ul>
<li class="chapter" data-level="1.3.1" data-path="revisit.html"><a href="revisit.html#introduction-to-the-example"><i class="fa fa-check"></i><b>1.3.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="1.3.2" data-path="revisit.html"><a href="revisit.html#applying-and-interpreting-lm"><i class="fa fa-check"></i><b>1.3.2</b> Applying and interpreting <code>lm()</code></a></li>
<li class="chapter" data-level="1.3.3" data-path="revisit.html"><a href="revisit.html#getting-predictions-from-the-model"><i class="fa fa-check"></i><b>1.3.3</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="1.3.4" data-path="revisit.html"><a href="revisit.html#checking-assumptions"><i class="fa fa-check"></i><b>1.3.4</b> Checking assumptions</a></li>
<li class="chapter" data-level="1.3.5" data-path="revisit.html"><a href="revisit.html#creating-a-figure"><i class="fa fa-check"></i><b>1.3.5</b> Creating a figure</a></li>
<li class="chapter" data-level="1.3.6" data-path="revisit.html"><a href="revisit.html#reporting-the-results"><i class="fa fa-check"></i><b>1.3.6</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="revisit.html"><a href="revisit.html#t-tests"><i class="fa fa-check"></i><b>1.4</b> t-tests</a><ul>
<li class="chapter" data-level="1.4.1" data-path="revisit.html"><a href="revisit.html#introduction-to-the-example-1"><i class="fa fa-check"></i><b>1.4.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="1.4.2" data-path="revisit.html"><a href="revisit.html#t.test-output-reminder"><i class="fa fa-check"></i><b>1.4.2</b> <code>t.test()</code> output reminder</a></li>
<li class="chapter" data-level="1.4.3" data-path="revisit.html"><a href="revisit.html#applying-and-interpreting-lm-1"><i class="fa fa-check"></i><b>1.4.3</b> Applying and interpreting <code>lm()</code></a></li>
<li class="chapter" data-level="1.4.4" data-path="revisit.html"><a href="revisit.html#getting-predictions-from-the-model-1"><i class="fa fa-check"></i><b>1.4.4</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="1.4.5" data-path="revisit.html"><a href="revisit.html#checking-assumptions-1"><i class="fa fa-check"></i><b>1.4.5</b> Checking assumptions</a></li>
<li class="chapter" data-level="1.4.6" data-path="revisit.html"><a href="revisit.html#creating-a-figure-1"><i class="fa fa-check"></i><b>1.4.6</b> Creating a figure</a></li>
<li class="chapter" data-level="1.4.7" data-path="revisit.html"><a href="revisit.html#reporting-the-results-1"><i class="fa fa-check"></i><b>1.4.7</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="revisit.html"><a href="revisit.html#one-way-anova"><i class="fa fa-check"></i><b>1.5</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="1.5.1" data-path="revisit.html"><a href="revisit.html#aov"><i class="fa fa-check"></i><b>1.5.1</b> aov()</a></li>
<li class="chapter" data-level="1.5.2" data-path="revisit.html"><a href="revisit.html#lm"><i class="fa fa-check"></i><b>1.5.2</b> lm()</a></li>
<li class="chapter" data-level="1.5.3" data-path="revisit.html"><a href="revisit.html#link-between-the-outputs"><i class="fa fa-check"></i><b>1.5.3</b> link between the outputs</a></li>
<li class="chapter" data-level="1.5.4" data-path="revisit.html"><a href="revisit.html#post-hoc-for-lm"><i class="fa fa-check"></i><b>1.5.4</b> post-hoc for lm()</a></li>
<li class="chapter" data-level="1.5.5" data-path="revisit.html"><a href="revisit.html#reporting-from-lm"><i class="fa fa-check"></i><b>1.5.5</b> reporting from lm()</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="revisit.html"><a href="revisit.html#two-way-anova"><i class="fa fa-check"></i><b>1.6</b> Two-way ANOVA</a><ul>
<li class="chapter" data-level="1.6.1" data-path="revisit.html"><a href="revisit.html#aov-1"><i class="fa fa-check"></i><b>1.6.1</b> aov()</a></li>
<li class="chapter" data-level="1.6.2" data-path="revisit.html"><a href="revisit.html#lm-1"><i class="fa fa-check"></i><b>1.6.2</b> lm()</a></li>
<li class="chapter" data-level="1.6.3" data-path="revisit.html"><a href="revisit.html#link-between-the-outputs-1"><i class="fa fa-check"></i><b>1.6.3</b> link between the outputs</a></li>
<li class="chapter" data-level="1.6.4" data-path="revisit.html"><a href="revisit.html#post-hoc-for-lm-1"><i class="fa fa-check"></i><b>1.6.4</b> post-hoc for lm()</a></li>
<li class="chapter" data-level="1.6.5" data-path="revisit.html"><a href="revisit.html#reporting-from-lm-1"><i class="fa fa-check"></i><b>1.6.5</b> reporting from lm()</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="revisit.html"><a href="revisit.html#section"><i class="fa fa-check"></i><b>1.7</b> </a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pois.html"><a href="pois.html"><i class="fa fa-check"></i><b>2</b> GLM for poisson responses</a><ul>
<li class="chapter" data-level="2.1" data-path="pois.html"><a href="pois.html#pois-intro"><i class="fa fa-check"></i><b>2.1</b> intro</a></li>
<li class="chapter" data-level="2.2" data-path="pois.html"><a href="pois.html#pois-build"><i class="fa fa-check"></i><b>2.2</b> build</a></li>
<li class="chapter" data-level="2.3" data-path="pois.html"><a href="pois.html#pois-output"><i class="fa fa-check"></i><b>2.3</b> output</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bino.html"><a href="bino.html"><i class="fa fa-check"></i><b>3</b> GLM for binomial responses</a><ul>
<li class="chapter" data-level="3.1" data-path="bino.html"><a href="bino.html#bino-intro"><i class="fa fa-check"></i><b>3.1</b> intro</a></li>
<li class="chapter" data-level="3.2" data-path="bino.html"><a href="bino.html#bino-build"><i class="fa fa-check"></i><b>3.2</b> build</a></li>
<li class="chapter" data-level="3.3" data-path="bino.html"><a href="bino.html#bino-output"><i class="fa fa-check"></i><b>3.3</b> output</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>4</b> Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="revisit" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> What are linear models</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">1.1</span> Introduction</h2>
<ul>
<li>what is meant by a linear model</li>
<li>revise regression</li>
<li>revise t.tests</li>
<li>doing t.tests as linear models</li>
<li>linking output of t.test to lm</li>
<li>revise one way ANOVA</li>
<li>linking output of aov to lm</li>
<li>revise two way ANOVA</li>
<li>doing two way ANOVA as linear models</li>
<li>linking output of aov to lm</li>
<li>extensible - ancova design</li>
</ul>
</div>
<div id="what-is-a-linear-model" class="section level2">
<h2><span class="header-section-number">1.2</span> What is a linear model?</h2>
<p>A linear model describes a continuous response variable as a function of one or more explanatory variables. When you have a single explanatory variable, that model is:</p>
<p><span class="math display" id="eq:lm1">\[\begin{equation}
y_{i}=\beta_{0}+\beta_{1}X1_{i}+e_{i}
\tag{1.1}
\end{equation}\]</span></p>
<p>Where:</p>
<ul>
<li>The response variable is <span class="math inline">\(y\)</span> and <span class="math inline">\(X1\)</span> is the explanatory variable.<br />
</li>
<li><span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> are the coefficients in the model. In a single linear regression, <span class="math inline">\(\beta_{0}\)</span> is often called the intercept and <span class="math inline">\(\beta_{1}\)</span> the slope.<br />
</li>
<li><span class="math inline">\(i\)</span> is the index of the response so <span class="math inline">\(y_{i}\)</span> is the <span class="math inline">\(i\)</span>th response; if you had 20 pairs of <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> values, <span class="math inline">\(i\)</span> would go from 1 to 20.<br />
</li>
<li><span class="math inline">\(e_{i}\)</span> is the “error” also known as the residual.</li>
</ul>
<p>The equation means the response can be predicted from a given value of the explanatory variable, <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> and will take that value plus some random noise. When you build a linear model from your data the procedure estimates the model coefficients.</p>
<p>See figure <a href="revisit.html#fig:lm-annotated">1.1</a>.</p>

<div class="figure" style="text-align: center"><span id="fig:lm-annotated"></span>
<img src="images/fig_4.svg" alt="Terms used in linear models." width="80%" />
<p class="caption">
Figure 1.1: Terms used in linear models.
</p>
</div>
<p><strong>keypoint</strong>
terminology build fit
parameter, coefficient
estimates</p>
<p>If you have more than one explanatory variable this these are given as <span class="math inline">\(X2\)</span>, <span class="math inline">\(X3\)</span> and so on up to the <span class="math inline">\(p\)</span>th explanatory variable each with its own <span class="math inline">\(\beta\)</span> coefficient. The general form of the model is:
<span class="math display" id="eq:regression">\[\begin{equation}
y_{i}=\beta_{0}+\beta_{1}X1_{i}+\beta_{2}X2_{i}+...+\beta_{p}XP_{i}+e_{i}
\tag{1.2}
\end{equation}\]</span></p>
</div>
<div id="single-linear-regression" class="section level2">
<h2><span class="header-section-number">1.3</span> Single linear regression</h2>
<div id="introduction-to-the-example" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Introduction to the example</h3>
<p>This is a test you have probably carried out before.</p>
<p>The concentration of juvenile hormone in stag beetles (<em>Lucanus cervus</em>) is known to influence mandible growth. Groups of stag beetles were injected with different concentrations of juvenile hormone (pg<span class="math inline">\(\mu\)</span>l<sup>-1</sup>) and their average mandible size (mm) determined. The data are in <a href="data-raw/stag.txt">stag.txt</a>.</p>
<p>We will import the data with the <code>read_table2()</code> function from the <code>readr</code> package and plot it with <code>ggplot()</code> from the <code>ggplot2</code> package. Both packages are part of the tidyverse and we load this first:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="revisit.html#cb1-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="revisit.html#cb2-1"></a>stag &lt;-<span class="st"> </span><span class="kw">read_table2</span>(<span class="st">&quot;data-raw/stag.txt&quot;</span>)</span></code></pre></div>
<p>Juvenile hormone is has been set by the experimenter and mandible size has decimal places and is something we would expect to be normally distributed. Visualising our data before any further analysis is usually sensible. In this case, it will help us determine if any relationship between the two variables is linear.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="revisit.html#cb3-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stag, <span class="kw">aes</span>(<span class="dt">x =</span> jh, <span class="dt">y =</span> mand)) <span class="op">+</span></span>
<span id="cb3-2"><a href="revisit.html#cb3-2"></a><span class="st">        </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="revisit-linear-models_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto;" />
The relationship between them looks roughly linear. So far, common sense suggests the assumptions of regression are met.</p>
</div>
<div id="applying-and-interpreting-lm" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Applying and interpreting <code>lm()</code></h3>
<p>The <code>lm()</code> function is used to build the regression model</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="revisit.html#cb4-1"></a><span class="co"># build the statistical model</span></span>
<span id="cb4-2"><a href="revisit.html#cb4-2"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data =</span> stag, mand <span class="op">~</span><span class="st"> </span>jh)</span></code></pre></div>
<p>This can be read as: fit a linear of model of mandible size explained by juvenile growth hormone concentration.</p>
<p>Printing <code>mod</code> to the console will reveal the estimated model parameters (coefficients) but little else:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="revisit.html#cb5-1"></a>mod</span>
<span id="cb5-2"><a href="revisit.html#cb5-2"></a><span class="co"># </span></span>
<span id="cb5-3"><a href="revisit.html#cb5-3"></a><span class="co"># Call:</span></span>
<span id="cb5-4"><a href="revisit.html#cb5-4"></a><span class="co"># lm(formula = mand ~ jh, data = stag)</span></span>
<span id="cb5-5"><a href="revisit.html#cb5-5"></a><span class="co"># </span></span>
<span id="cb5-6"><a href="revisit.html#cb5-6"></a><span class="co"># Coefficients:</span></span>
<span id="cb5-7"><a href="revisit.html#cb5-7"></a><span class="co"># (Intercept)           jh  </span></span>
<span id="cb5-8"><a href="revisit.html#cb5-8"></a><span class="co">#    0.419338     0.006459</span></span></code></pre></div>
<p><span class="math inline">\(\beta_{0}\)</span> is labelled “(Intercept)” and <span class="math inline">\(\beta_{1}\)</span> is labelled “jh”. Thus the equation of the line is:</p>
<p><span class="math inline">\(mand\)</span> = 0.4193382 + 0.0064588<span class="math inline">\(jh\)</span></p>
<p>More information including statistical tests of the model and its parameters is obtained by using <code>summary()</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="revisit.html#cb6-1"></a><span class="co"># examine it</span></span>
<span id="cb6-2"><a href="revisit.html#cb6-2"></a><span class="kw">summary</span>(mod)</span>
<span id="cb6-3"><a href="revisit.html#cb6-3"></a><span class="co"># </span></span>
<span id="cb6-4"><a href="revisit.html#cb6-4"></a><span class="co"># Call:</span></span>
<span id="cb6-5"><a href="revisit.html#cb6-5"></a><span class="co"># lm(formula = mand ~ jh, data = stag)</span></span>
<span id="cb6-6"><a href="revisit.html#cb6-6"></a><span class="co"># </span></span>
<span id="cb6-7"><a href="revisit.html#cb6-7"></a><span class="co"># Residuals:</span></span>
<span id="cb6-8"><a href="revisit.html#cb6-8"></a><span class="co">#      Min       1Q   Median       3Q      Max </span></span>
<span id="cb6-9"><a href="revisit.html#cb6-9"></a><span class="co"># -0.38604 -0.20281 -0.09751  0.15034  0.60690 </span></span>
<span id="cb6-10"><a href="revisit.html#cb6-10"></a><span class="co"># </span></span>
<span id="cb6-11"><a href="revisit.html#cb6-11"></a><span class="co"># Coefficients:</span></span>
<span id="cb6-12"><a href="revisit.html#cb6-12"></a><span class="co">#             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb6-13"><a href="revisit.html#cb6-13"></a><span class="co"># (Intercept) 0.419338   0.139429   3.008  0.00941 **</span></span>
<span id="cb6-14"><a href="revisit.html#cb6-14"></a><span class="co"># jh          0.006459   0.001584   4.078  0.00113 **</span></span>
<span id="cb6-15"><a href="revisit.html#cb6-15"></a><span class="co"># ---</span></span>
<span id="cb6-16"><a href="revisit.html#cb6-16"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-17"><a href="revisit.html#cb6-17"></a><span class="co"># </span></span>
<span id="cb6-18"><a href="revisit.html#cb6-18"></a><span class="co"># Residual standard error: 0.292 on 14 degrees of freedom</span></span>
<span id="cb6-19"><a href="revisit.html#cb6-19"></a><span class="co"># Multiple R-squared:  0.5429,  Adjusted R-squared:  0.5103 </span></span>
<span id="cb6-20"><a href="revisit.html#cb6-20"></a><span class="co"># F-statistic: 16.63 on 1 and 14 DF,  p-value: 0.00113</span></span></code></pre></div>
<p>The “Coefficients:” table gives the estimated <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> again, this time with their standard errors and tests of whether the estimates differ from zero. The estimated value for the intercept is 0.4193382 <span class="math inline">\(\pm\)</span> 0.1394289 and this differs significantly from zero (<span class="math inline">\(p\)</span> = 0.0094098). The estimated value for the slope, 0.0064588 <span class="math inline">\(\pm\)</span> 0.0015838, also differs significantly from zero (<span class="math inline">\(p\)</span> = 0.0011296).</p>
<p>The three lines at the bottom of the output gives information about the fit of the model to the data. The “Multiple R-squared” gives the proportion of the variance in the response which is explained by the model. In our case, 0.542938 of the variance in mandible length is explained by the model and this is a significant proportion of that variance (<span class="math inline">\(p\)</span> = 0.0011296).</p>
<p>For a single linear regression, the <em>p</em>-value for the model and the <em>p</em>-value for the slope are the same. This is also true for linear models in the form of a two-sample <em>t</em>-test but <strong>not</strong> the case for other linear models.</p>
</div>
<div id="getting-predictions-from-the-model" class="section level3">
<h3><span class="header-section-number">1.3.3</span> Getting predictions from the model</h3>
<p>The <code>predict()</code> returns the predicted values of the response. To add a column of predicted values to the dataframe:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="revisit.html#cb7-1"></a>stag<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod)</span></code></pre></div>
<p>This requires creating a data frame of the x values from which you want to predict</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="revisit.html#cb8-1"></a>predictions &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">jh =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="dv">5</span>))</span></code></pre></div>
<p>Note that the name and type of value of explanatory variable must be the same as it is in the model</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="revisit.html#cb9-1"></a>predictions<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, <span class="dt">newdata =</span> predictions)</span></code></pre></div>
<p>Replacing the terms shown in Figure <a href="revisit.html#fig:lm-annotated">1.1</a> with the values in this example gives us <a href="revisit.html#fig:stag-annotated">1.2</a>.</p>

<div class="figure" style="text-align: center"><span id="fig:stag-annotated"></span>
<img src="images/fig_5.svg" alt="these model estimates." width="80%" />
<p class="caption">
Figure 1.2: these model estimates.
</p>
</div>
</div>
<div id="checking-assumptions" class="section level3">
<h3><span class="header-section-number">1.3.4</span> Checking assumptions</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="revisit.html#cb10-1"></a><span class="kw">plot</span>(mod, <span class="dt">which =</span> <span class="dv">2</span>)</span>
<span id="cb10-2"><a href="revisit.html#cb10-2"></a><span class="kw">plot</span>(mod, <span class="dt">which =</span> <span class="dv">1</span>)</span>
<span id="cb10-3"><a href="revisit.html#cb10-3"></a><span class="kw">shapiro.test</span>(mod<span class="op">$</span>res)</span>
<span id="cb10-4"><a href="revisit.html#cb10-4"></a><span class="co"># </span></span>
<span id="cb10-5"><a href="revisit.html#cb10-5"></a><span class="co">#   Shapiro-Wilk normality test</span></span>
<span id="cb10-6"><a href="revisit.html#cb10-6"></a><span class="co"># </span></span>
<span id="cb10-7"><a href="revisit.html#cb10-7"></a><span class="co"># data:  mod$res</span></span>
<span id="cb10-8"><a href="revisit.html#cb10-8"></a><span class="co"># W = 0.94737, p-value = 0.4493</span></span></code></pre></div>
<p><img src="revisit-linear-models_files/figure-html/unnamed-chunk-11-1.png" width="80%" style="display: block; margin: auto;" /><img src="revisit-linear-models_files/figure-html/unnamed-chunk-11-2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="creating-a-figure" class="section level3">
<h3><span class="header-section-number">1.3.5</span> Creating a figure</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="revisit.html#cb11-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stag, <span class="kw">aes</span>(<span class="dt">x =</span> jh, <span class="dt">y =</span> mand)) <span class="op">+</span></span>
<span id="cb11-2"><a href="revisit.html#cb11-2"></a><span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb11-3"><a href="revisit.html#cb11-3"></a><span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>),</span>
<span id="cb11-4"><a href="revisit.html#cb11-4"></a>                           <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">160</span>),</span>
<span id="cb11-5"><a href="revisit.html#cb11-5"></a>                           <span class="dt">name =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Juvenile hormone (pg&quot;</span>,</span>
<span id="cb11-6"><a href="revisit.html#cb11-6"></a>                                                   mu,</span>
<span id="cb11-7"><a href="revisit.html#cb11-7"></a>                                                   l<span class="op">^-</span><span class="dv">1</span>,</span>
<span id="cb11-8"><a href="revisit.html#cb11-8"></a>                                                   <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></span>
<span id="cb11-9"><a href="revisit.html#cb11-9"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb11-10"><a href="revisit.html#cb11-10"></a>                           <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb11-11"><a href="revisit.html#cb11-11"></a>                           <span class="dt">name =</span> <span class="st">&quot;Mandible length (mm)&quot;</span>) <span class="op">+</span></span>
<span id="cb11-12"><a href="revisit.html#cb11-12"></a><span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb11-13"><a href="revisit.html#cb11-13"></a><span class="st">        </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="revisit-linear-models_files/figure-html/ch1-reg-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="reporting-the-results" class="section level3">
<h3><span class="header-section-number">1.3.6</span> Reporting the results</h3>
<p>There was a significant positive relationship between the concentration of Juvenile hormone and mandible length (<span class="math inline">\(\beta_{1}\pm s.e.\)</span>: 0.0064588 <span class="math inline">\(\pm\)</span> 0.0015838; <span class="math inline">\(p\)</span> = 0.0011296). See figure <a href="revisit.html#fig:ch1-reg-report">1.3</a>.</p>

<div class="figure" style="text-align: left"><span id="fig:ch1-reg-report"></span>
<img src="revisit-linear-models_files/figure-html/ch1-reg-report-1.png" alt="Relationship between the concentration of Juvenile hormone and mandible length." width="80%" />
<p class="caption">
Figure 1.3: Relationship between the concentration of Juvenile hormone and mandible length.
</p>
</div>
</div>
</div>
<div id="t-tests" class="section level2">
<h2><span class="header-section-number">1.4</span> t-tests</h2>
<div id="introduction-to-the-example-1" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Introduction to the example</h3>
<p>Some plant biotechnologists developed a genetically modified line of <em>Cannabis sativa</em> to increase its omega 3 fatty acids content. They grew 50 wild type and fifty modified plants to maturity, collect the seeds and measure the amount of omega 3 fatty acids. The data are in <a href="data-raw/csativa.txt">csativa.txt</a>. They used a two-sample <em>t</em>-test to compare the mean omega 3 content in the two plant types.</p>
<p>We again use the <code>read_table2()</code> function to import the data and visualise it with <code>ggplot()</code></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="revisit.html#cb12-1"></a>csativa  &lt;-<span class="st">  </span><span class="kw">read_table2</span>(<span class="st">&quot;data-raw/csativa.txt&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="revisit.html#cb13-1"></a><span class="co"># create a rough plot of the data  </span></span>
<span id="cb13-2"><a href="revisit.html#cb13-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> csativa, <span class="kw">aes</span>(<span class="dt">x =</span> plant, <span class="dt">y =</span> omega)) <span class="op">+</span></span>
<span id="cb13-3"><a href="revisit.html#cb13-3"></a><span class="st">  </span><span class="kw">geom_violin</span>()</span></code></pre></div>
<p><img src="revisit-linear-models_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;" />
The modified plant have a lower mean omega 3 content than the wildtype plants. The modification appears not to be successful.</p>
<p>Statistical comparison of the two means can be done with either the <code>t.test()</code> or <code>lm()</code> functions; these are exactly equivalent but present the results differently. We will use our understanding of applying and interpreting <code>t.test()</code> to develop our understanding of <code>lm()</code> output</p>
</div>
<div id="t.test-output-reminder" class="section level3">
<h3><span class="header-section-number">1.4.2</span> <code>t.test()</code> output reminder</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="revisit.html#cb14-1"></a><span class="kw">t.test</span>(<span class="dt">data =</span> csativa, omega <span class="op">~</span><span class="st"> </span>plant, <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</span>
<span id="cb14-2"><a href="revisit.html#cb14-2"></a><span class="co"># </span></span>
<span id="cb14-3"><a href="revisit.html#cb14-3"></a><span class="co">#   Two Sample t-test</span></span>
<span id="cb14-4"><a href="revisit.html#cb14-4"></a><span class="co"># </span></span>
<span id="cb14-5"><a href="revisit.html#cb14-5"></a><span class="co"># data:  omega by plant</span></span>
<span id="cb14-6"><a href="revisit.html#cb14-6"></a><span class="co"># t = -5.0289, df = 98, p-value = 2.231e-06</span></span>
<span id="cb14-7"><a href="revisit.html#cb14-7"></a><span class="co"># alternative hypothesis: true difference in means is not equal to 0</span></span>
<span id="cb14-8"><a href="revisit.html#cb14-8"></a><span class="co"># 95 percent confidence interval:</span></span>
<span id="cb14-9"><a href="revisit.html#cb14-9"></a><span class="co">#  -9.687828 -4.205372</span></span>
<span id="cb14-10"><a href="revisit.html#cb14-10"></a><span class="co"># sample estimates:</span></span>
<span id="cb14-11"><a href="revisit.html#cb14-11"></a><span class="co"># mean in group modif  mean in group wild </span></span>
<span id="cb14-12"><a href="revisit.html#cb14-12"></a><span class="co">#             49.4652             56.4118</span></span></code></pre></div>
<p>The two groups means are give in the section labelled “sample estimates” and the test of whether they differ significantly is given in the forth line (beginning “t = …”). We conclude the mean omega 3 content of the modified plants (49.4652) is significantly lower than that of the wildtype plants (<span class="math inline">\(t\)</span> = 5.0288776, <span class="math inline">\(d.f.\)</span> = 98, <span class="math inline">\(p\)</span> = 2.230593910^{-6}).</p>
<p>The confidence interval is on the difference between the two means.</p>
<p>The sign on the <span class="math inline">\(t\)</span> value and the order in which the sample estimates are given is determined by R’s alphabetical ordering of the groups. As “modif” comes before “wildtype” in the alphabet, “modif” is the first group and the test is the modified plant mean minus the wildtype mean. This has no impact on our conclusions and had the wildtype plants been labelled “control” the output would be:</p>
<pre><code>    Two Sample t-test

data:  omega by plant
t = 5.0289, df = 98, p-value = 2.231e-06
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 4.205372 9.687828
sample estimates:
mean in group control  mean in group modif
            56.4118             49.4652
</code></pre>
</div>
<div id="applying-and-interpreting-lm-1" class="section level3">
<h3><span class="header-section-number">1.4.3</span> Applying and interpreting <code>lm()</code></h3>
<p>The <code>lm()</code> function is used as follows:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="revisit.html#cb16-1"></a><span class="co"># build a model with `lm()`</span></span>
<span id="cb16-2"><a href="revisit.html#cb16-2"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(omega <span class="op">~</span><span class="st"> </span>plant, <span class="dt">data =</span> csativa)</span></code></pre></div>
<p>This can be read as: fit a linear of model of omega content explained by plant type. Printing <code>mod</code> to the console gives us these estimated model parameters (coefficients):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="revisit.html#cb17-1"></a>mod</span>
<span id="cb17-2"><a href="revisit.html#cb17-2"></a><span class="co"># </span></span>
<span id="cb17-3"><a href="revisit.html#cb17-3"></a><span class="co"># Call:</span></span>
<span id="cb17-4"><a href="revisit.html#cb17-4"></a><span class="co"># lm(formula = omega ~ plant, data = csativa)</span></span>
<span id="cb17-5"><a href="revisit.html#cb17-5"></a><span class="co"># </span></span>
<span id="cb17-6"><a href="revisit.html#cb17-6"></a><span class="co"># Coefficients:</span></span>
<span id="cb17-7"><a href="revisit.html#cb17-7"></a><span class="co"># (Intercept)    plantwild  </span></span>
<span id="cb17-8"><a href="revisit.html#cb17-8"></a><span class="co">#      49.465        6.947</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="revisit.html#cb18-1"></a><span class="kw">summary</span>(mod)</span>
<span id="cb18-2"><a href="revisit.html#cb18-2"></a><span class="co"># </span></span>
<span id="cb18-3"><a href="revisit.html#cb18-3"></a><span class="co"># Call:</span></span>
<span id="cb18-4"><a href="revisit.html#cb18-4"></a><span class="co"># lm(formula = omega ~ plant, data = csativa)</span></span>
<span id="cb18-5"><a href="revisit.html#cb18-5"></a><span class="co"># </span></span>
<span id="cb18-6"><a href="revisit.html#cb18-6"></a><span class="co"># Residuals:</span></span>
<span id="cb18-7"><a href="revisit.html#cb18-7"></a><span class="co">#      Min       1Q   Median       3Q      Max </span></span>
<span id="cb18-8"><a href="revisit.html#cb18-8"></a><span class="co"># -15.8718  -3.7026  -0.9635   4.4598  16.9182 </span></span>
<span id="cb18-9"><a href="revisit.html#cb18-9"></a><span class="co"># </span></span>
<span id="cb18-10"><a href="revisit.html#cb18-10"></a><span class="co"># Coefficients:</span></span>
<span id="cb18-11"><a href="revisit.html#cb18-11"></a><span class="co">#             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb18-12"><a href="revisit.html#cb18-12"></a><span class="co"># (Intercept)  49.4652     0.9768  50.642  &lt; 2e-16 ***</span></span>
<span id="cb18-13"><a href="revisit.html#cb18-13"></a><span class="co"># plantwild     6.9466     1.3813   5.029 2.23e-06 ***</span></span>
<span id="cb18-14"><a href="revisit.html#cb18-14"></a><span class="co"># ---</span></span>
<span id="cb18-15"><a href="revisit.html#cb18-15"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb18-16"><a href="revisit.html#cb18-16"></a><span class="co"># </span></span>
<span id="cb18-17"><a href="revisit.html#cb18-17"></a><span class="co"># Residual standard error: 6.907 on 98 degrees of freedom</span></span>
<span id="cb18-18"><a href="revisit.html#cb18-18"></a><span class="co"># Multiple R-squared:  0.2051,  Adjusted R-squared:  0.197 </span></span>
<span id="cb18-19"><a href="revisit.html#cb18-19"></a><span class="co"># F-statistic: 25.29 on 1 and 98 DF,  p-value: 2.231e-06</span></span>
<span id="cb18-20"><a href="revisit.html#cb18-20"></a><span class="kw">anova</span>(mod)</span>
<span id="cb18-21"><a href="revisit.html#cb18-21"></a><span class="co"># Analysis of Variance Table</span></span>
<span id="cb18-22"><a href="revisit.html#cb18-22"></a><span class="co"># </span></span>
<span id="cb18-23"><a href="revisit.html#cb18-23"></a><span class="co"># Response: omega</span></span>
<span id="cb18-24"><a href="revisit.html#cb18-24"></a><span class="co">#           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb18-25"><a href="revisit.html#cb18-25"></a><span class="co"># plant      1 1206.4  1206.4   25.29 2.231e-06 ***</span></span>
<span id="cb18-26"><a href="revisit.html#cb18-26"></a><span class="co"># Residuals 98 4674.9    47.7                      </span></span>
<span id="cb18-27"><a href="revisit.html#cb18-27"></a><span class="co"># ---</span></span>
<span id="cb18-28"><a href="revisit.html#cb18-28"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="getting-predictions-from-the-model-1" class="section level3">
<h3><span class="header-section-number">1.4.4</span> Getting predictions from the model</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="revisit.html#cb19-1"></a><span class="kw">predict</span>(mod)</span>
<span id="cb19-2"><a href="revisit.html#cb19-2"></a><span class="co">#       1       2       3       4       5       6       7       8       9      10 </span></span>
<span id="cb19-3"><a href="revisit.html#cb19-3"></a><span class="co"># 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 </span></span>
<span id="cb19-4"><a href="revisit.html#cb19-4"></a><span class="co">#      11      12      13      14      15      16      17      18      19      20 </span></span>
<span id="cb19-5"><a href="revisit.html#cb19-5"></a><span class="co"># 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 </span></span>
<span id="cb19-6"><a href="revisit.html#cb19-6"></a><span class="co">#      21      22      23      24      25      26      27      28      29      30 </span></span>
<span id="cb19-7"><a href="revisit.html#cb19-7"></a><span class="co"># 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 </span></span>
<span id="cb19-8"><a href="revisit.html#cb19-8"></a><span class="co">#      31      32      33      34      35      36      37      38      39      40 </span></span>
<span id="cb19-9"><a href="revisit.html#cb19-9"></a><span class="co"># 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 </span></span>
<span id="cb19-10"><a href="revisit.html#cb19-10"></a><span class="co">#      41      42      43      44      45      46      47      48      49      50 </span></span>
<span id="cb19-11"><a href="revisit.html#cb19-11"></a><span class="co"># 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 49.4652 </span></span>
<span id="cb19-12"><a href="revisit.html#cb19-12"></a><span class="co">#      51      52      53      54      55      56      57      58      59      60 </span></span>
<span id="cb19-13"><a href="revisit.html#cb19-13"></a><span class="co"># 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 </span></span>
<span id="cb19-14"><a href="revisit.html#cb19-14"></a><span class="co">#      61      62      63      64      65      66      67      68      69      70 </span></span>
<span id="cb19-15"><a href="revisit.html#cb19-15"></a><span class="co"># 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 </span></span>
<span id="cb19-16"><a href="revisit.html#cb19-16"></a><span class="co">#      71      72      73      74      75      76      77      78      79      80 </span></span>
<span id="cb19-17"><a href="revisit.html#cb19-17"></a><span class="co"># 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 </span></span>
<span id="cb19-18"><a href="revisit.html#cb19-18"></a><span class="co">#      81      82      83      84      85      86      87      88      89      90 </span></span>
<span id="cb19-19"><a href="revisit.html#cb19-19"></a><span class="co"># 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 </span></span>
<span id="cb19-20"><a href="revisit.html#cb19-20"></a><span class="co">#      91      92      93      94      95      96      97      98      99     100 </span></span>
<span id="cb19-21"><a href="revisit.html#cb19-21"></a><span class="co"># 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118 56.4118</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="revisit.html#cb20-1"></a>predictions &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">plant =</span> <span class="kw">c</span>(<span class="st">&quot;modif&quot;</span>, <span class="st">&quot;wild&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="revisit.html#cb21-1"></a>predictions<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, <span class="dt">newdata =</span> predictions, <span class="dt">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="revisit.html#cb22-1"></a>predictions<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, <span class="dt">newdata =</span> predictions)</span></code></pre></div>
<p>Replacing the terms shown in Figure <a href="revisit.html#fig:lm-annotated">1.1</a> with the values in this example gives us <a href="revisit.html#fig:csat-annotated">1.4</a>.</p>

<div class="figure" style="text-align: center"><span id="fig:csat-annotated"></span>
<img src="images/fig_6.svg" alt="these model estimates." width="80%" />
<p class="caption">
Figure 1.4: these model estimates.
</p>
</div>
</div>
<div id="checking-assumptions-1" class="section level3">
<h3><span class="header-section-number">1.4.5</span> Checking assumptions</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="revisit.html#cb23-1"></a><span class="kw">plot</span>(mod, <span class="dt">which =</span> <span class="dv">2</span>)</span>
<span id="cb23-2"><a href="revisit.html#cb23-2"></a><span class="kw">plot</span>(mod, <span class="dt">which =</span> <span class="dv">1</span>)</span>
<span id="cb23-3"><a href="revisit.html#cb23-3"></a><span class="kw">shapiro.test</span>(mod<span class="op">$</span>res)</span>
<span id="cb23-4"><a href="revisit.html#cb23-4"></a><span class="co"># </span></span>
<span id="cb23-5"><a href="revisit.html#cb23-5"></a><span class="co">#   Shapiro-Wilk normality test</span></span>
<span id="cb23-6"><a href="revisit.html#cb23-6"></a><span class="co"># </span></span>
<span id="cb23-7"><a href="revisit.html#cb23-7"></a><span class="co"># data:  mod$res</span></span>
<span id="cb23-8"><a href="revisit.html#cb23-8"></a><span class="co"># W = 0.98816, p-value = 0.5204</span></span></code></pre></div>
<p><img src="revisit-linear-models_files/figure-html/unnamed-chunk-23-1.png" width="80%" style="display: block; margin: auto;" /><img src="revisit-linear-models_files/figure-html/unnamed-chunk-23-2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="creating-a-figure-1" class="section level3">
<h3><span class="header-section-number">1.4.6</span> Creating a figure</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="revisit.html#cb24-1"></a>csativa_summary &lt;-<span class="st"> </span>csativa <span class="op">%&gt;%</span></span>
<span id="cb24-2"><a href="revisit.html#cb24-2"></a><span class="st">  </span><span class="kw">group_by</span>(plant) <span class="op">%&gt;%</span></span>
<span id="cb24-3"><a href="revisit.html#cb24-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(omega),</span>
<span id="cb24-4"><a href="revisit.html#cb24-4"></a>            <span class="dt">std =</span> <span class="kw">sd</span>(omega),</span>
<span id="cb24-5"><a href="revisit.html#cb24-5"></a>            <span class="dt">n =</span> <span class="kw">length</span>(omega),</span>
<span id="cb24-6"><a href="revisit.html#cb24-6"></a>            <span class="dt">se =</span> std<span class="op">/</span><span class="kw">sqrt</span>(n))</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="revisit.html#cb25-1"></a><span class="co">#summarise the data </span></span>
<span id="cb25-2"><a href="revisit.html#cb25-2"></a></span>
<span id="cb25-3"><a href="revisit.html#cb25-3"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb25-4"><a href="revisit.html#cb25-4"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data =</span> csativa, </span>
<span id="cb25-5"><a href="revisit.html#cb25-5"></a>              <span class="kw">aes</span>(<span class="dt">x =</span> plant, <span class="dt">y =</span> omega), </span>
<span id="cb25-6"><a href="revisit.html#cb25-6"></a>              <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span></span>
<span id="cb25-7"><a href="revisit.html#cb25-7"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> csativa_summary,</span>
<span id="cb25-8"><a href="revisit.html#cb25-8"></a>                <span class="kw">aes</span>(<span class="dt">x =</span> plant,</span>
<span id="cb25-9"><a href="revisit.html#cb25-9"></a>                    <span class="dt">ymin =</span> mean,</span>
<span id="cb25-10"><a href="revisit.html#cb25-10"></a>                    <span class="dt">ymax =</span> mean),</span>
<span id="cb25-11"><a href="revisit.html#cb25-11"></a>                <span class="dt">width =</span> <span class="fl">.1</span>) <span class="op">+</span></span>
<span id="cb25-12"><a href="revisit.html#cb25-12"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> csativa_summary,</span>
<span id="cb25-13"><a href="revisit.html#cb25-13"></a>                <span class="kw">aes</span>(<span class="dt">x =</span> plant,</span>
<span id="cb25-14"><a href="revisit.html#cb25-14"></a>                    <span class="dt">ymin =</span> mean <span class="op">-</span><span class="st"> </span>se,</span>
<span id="cb25-15"><a href="revisit.html#cb25-15"></a>                    <span class="dt">ymax =</span> mean <span class="op">+</span><span class="st"> </span>se),</span>
<span id="cb25-16"><a href="revisit.html#cb25-16"></a>                <span class="dt">width =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb25-17"><a href="revisit.html#cb25-17"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Plant type&quot;</span>) <span class="op">+</span></span>
<span id="cb25-18"><a href="revisit.html#cb25-18"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Amount of Omega 3 (units)&quot;</span>) <span class="op">+</span></span>
<span id="cb25-19"><a href="revisit.html#cb25-19"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">75</span>) <span class="op">+</span></span>
<span id="cb25-20"><a href="revisit.html#cb25-20"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Modified&quot;</span>, <span class="st">&quot;Wild Type&quot;</span>)) <span class="op">+</span></span>
<span id="cb25-21"><a href="revisit.html#cb25-21"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="revisit-linear-models_files/figure-html/unnamed-chunk-25-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="reporting-the-results-1" class="section level3">
<h3><span class="header-section-number">1.4.7</span> Reporting the results</h3>
</div>
</div>
<div id="one-way-anova" class="section level2">
<h2><span class="header-section-number">1.5</span> One-way ANOVA</h2>
<div id="aov" class="section level3">
<h3><span class="header-section-number">1.5.1</span> aov()</h3>
</div>
<div id="lm" class="section level3">
<h3><span class="header-section-number">1.5.2</span> lm()</h3>
</div>
<div id="link-between-the-outputs" class="section level3">
<h3><span class="header-section-number">1.5.3</span> link between the outputs</h3>
</div>
<div id="post-hoc-for-lm" class="section level3">
<h3><span class="header-section-number">1.5.4</span> post-hoc for lm()</h3>
</div>
<div id="reporting-from-lm" class="section level3">
<h3><span class="header-section-number">1.5.5</span> reporting from lm()</h3>
<p>including a figure</p>
</div>
</div>
<div id="two-way-anova" class="section level2">
<h2><span class="header-section-number">1.6</span> Two-way ANOVA</h2>
<div id="aov-1" class="section level3">
<h3><span class="header-section-number">1.6.1</span> aov()</h3>
</div>
<div id="lm-1" class="section level3">
<h3><span class="header-section-number">1.6.2</span> lm()</h3>
</div>
<div id="link-between-the-outputs-1" class="section level3">
<h3><span class="header-section-number">1.6.3</span> link between the outputs</h3>
</div>
<div id="post-hoc-for-lm-1" class="section level3">
<h3><span class="header-section-number">1.6.4</span> post-hoc for lm()</h3>
</div>
<div id="reporting-from-lm-1" class="section level3">
<h3><span class="header-section-number">1.6.5</span> reporting from lm()</h3>
<p>including a figure</p>
</div>
</div>
<div id="section" class="section level2">
<h2><span class="header-section-number">1.7</span> </h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pois.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/3mmaRand/singlm/edit/master/revisit-linear-models.Rmd",
"text": "Make an edit suggestion"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["singlm.pdf", "singlm.epub", "https://github.com/3mmaRand/singlm/raw/master/revisit-linear-models.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
