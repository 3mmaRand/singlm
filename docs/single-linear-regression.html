<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Single linear regression | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</title>
  <meta name="description" content="The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Single linear regression | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://3mmarand.github.io/singlm/" />
  <meta property="og:image" content="https://3mmarand.github.io/singlm/images/android-chrome-512x512.png" />
  <meta property="og:description" content="The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="3mmaRand/singlm" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Single linear regression | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R" />
  
  <meta name="twitter:description" content="The output format for this example is bookdown::gitbook." />
  <meta name="twitter:image" content="https://3mmarand.github.io/singlm/images/android-chrome-512x512.png" />

<meta name="author" content="Emma Rand" />


<meta name="date" content="2020-07-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="what-are-linear-models.html"/>
<link rel="next" href="t-tests-revisit.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="assets/book.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/hex-s.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>0.1</b> Who is this book for?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#approach-of-this-book"><i class="fa fa-check"></i><b>0.2</b> Approach of this book</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#formatting-options-on-the-menu"><i class="fa fa-check"></i><b>0.3</b> formatting options on the menu</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#conventions-used-in-the-book"><i class="fa fa-check"></i><b>0.4</b> Conventions used in the book</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#overview-of-the-chapter-contents"><i class="fa fa-check"></i><b>0.5</b> Overview of the chapter contents</a></li>
</ul></li>
<li class="part"><span><b>I INTRODUCTION</b></span></li>
<li class="chapter" data-level="1" data-path="revision-of-your-introductory-class.html"><a href="revision-of-your-introductory-class.html"><i class="fa fa-check"></i><b>1</b> Revision of your Introductory class</a></li>
<li class="chapter" data-level="2" data-path="what-are-linear-models.html"><a href="what-are-linear-models.html"><i class="fa fa-check"></i><b>2</b> What are linear models</a><ul>
<li class="chapter" data-level="2.1" data-path="what-are-linear-models.html"><a href="what-are-linear-models.html#what-is-a-linear-model"><i class="fa fa-check"></i><b>2.1</b> What is a linear model?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="single-linear-regression.html"><a href="single-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Single linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="single-linear-regression.html"><a href="single-linear-regression.html#introduction-to-the-example"><i class="fa fa-check"></i><b>3.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="3.2" data-path="single-linear-regression.html"><a href="single-linear-regression.html#applying-and-interpreting-lm"><i class="fa fa-check"></i><b>3.2</b> Applying and interpreting <code>lm()</code></a></li>
<li class="chapter" data-level="3.3" data-path="single-linear-regression.html"><a href="single-linear-regression.html#getting-predictions-from-the-model"><i class="fa fa-check"></i><b>3.3</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="3.4" data-path="single-linear-regression.html"><a href="single-linear-regression.html#link-to-chapter-2.1"><i class="fa fa-check"></i><b>3.4</b> Link to Chapter 2.1</a></li>
<li class="chapter" data-level="3.5" data-path="single-linear-regression.html"><a href="single-linear-regression.html#checking-assumptions"><i class="fa fa-check"></i><b>3.5</b> Checking assumptions</a></li>
<li class="chapter" data-level="3.6" data-path="single-linear-regression.html"><a href="single-linear-regression.html#creating-a-figure"><i class="fa fa-check"></i><b>3.6</b> Creating a figure</a></li>
<li class="chapter" data-level="3.7" data-path="single-linear-regression.html"><a href="single-linear-regression.html#reporting-the-results"><i class="fa fa-check"></i><b>3.7</b> Reporting the results</a></li>
</ul></li>
<li class="part"><span><b>II USING <code>lm()</code> FOR FAMILIAR TESTS</b></span></li>
<li class="chapter" data-level="4" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html"><i class="fa fa-check"></i><b>4</b> <em>t</em>-tests revisited</a><ul>
<li class="chapter" data-level="4.1" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#introduction-to-the-example-1"><i class="fa fa-check"></i><b>4.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="4.2" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#t.test-output-reminder"><i class="fa fa-check"></i><b>4.2</b> <code>t.test()</code> output reminder</a></li>
<li class="chapter" data-level="4.3" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#applying-and-interpreting-lm-1"><i class="fa fa-check"></i><b>4.3</b> Applying and interpreting <code>lm()</code></a></li>
<li class="chapter" data-level="4.4" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#getting-predictions-from-the-model-1"><i class="fa fa-check"></i><b>4.4</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="4.5" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#link-to-chapter-2.1-1"><i class="fa fa-check"></i><b>4.5</b> Link to Chapter 2.1</a></li>
<li class="chapter" data-level="4.6" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#checking-assumptions-1"><i class="fa fa-check"></i><b>4.6</b> Checking assumptions</a></li>
<li class="chapter" data-level="4.7" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#creating-a-figure-1"><i class="fa fa-check"></i><b>4.7</b> Creating a figure</a></li>
<li class="chapter" data-level="4.8" data-path="t-tests-revisit.html"><a href="t-tests-revisit.html#reporting-the-results-1"><i class="fa fa-check"></i><b>4.8</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html"><i class="fa fa-check"></i><b>5</b> One-way ANOVA revisited</a><ul>
<li class="chapter" data-level="5.1" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#introduction-to-the-example-2"><i class="fa fa-check"></i><b>5.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="5.2" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#aov-output-reminder"><i class="fa fa-check"></i><b>5.2</b> <code>aov()</code> output reminder</a></li>
<li class="chapter" data-level="5.3" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#post-hoc-testing-for-aov"><i class="fa fa-check"></i><b>5.3</b> Post-hoc testing for <code>aov()</code></a></li>
<li class="chapter" data-level="5.4" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#applying-and-interpreting-lm-2"><i class="fa fa-check"></i><b>5.4</b> Applying and interpreting <code>lm()</code></a></li>
<li class="chapter" data-level="5.5" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#getting-predictions-from-the-model-2"><i class="fa fa-check"></i><b>5.5</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="5.6" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#link-to-chapter-2.1-2"><i class="fa fa-check"></i><b>5.6</b> Link to Chapter 2.1</a></li>
<li class="chapter" data-level="5.7" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#checking-assumptions-2"><i class="fa fa-check"></i><b>5.7</b> Checking assumptions</a></li>
<li class="chapter" data-level="5.8" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#post-hoc-testing-for-lm"><i class="fa fa-check"></i><b>5.8</b> Post-hoc testing for <code>lm()</code></a></li>
<li class="chapter" data-level="5.9" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#creating-a-figure-2"><i class="fa fa-check"></i><b>5.9</b> Creating a figure</a></li>
<li class="chapter" data-level="5.10" data-path="one-way-anova-revisit.html"><a href="one-way-anova-revisit.html#reporting-the-results-2"><i class="fa fa-check"></i><b>5.10</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html"><i class="fa fa-check"></i><b>6</b> Two-way ANOVA revisited</a><ul>
<li class="chapter" data-level="6.1" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#introduction-to-the-example-3"><i class="fa fa-check"></i><b>6.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="6.2" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#aov-output-reminder-1"><i class="fa fa-check"></i><b>6.2</b> <code>aov()</code> output reminder</a></li>
<li class="chapter" data-level="6.3" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#post-hoc-testing-for-aov-1"><i class="fa fa-check"></i><b>6.3</b> Post-hoc testing for <code>aov</code></a></li>
<li class="chapter" data-level="6.4" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#applying-and-interpreting-lm-3"><i class="fa fa-check"></i><b>6.4</b> Applying and interpreting <code>lm()</code></a></li>
<li class="chapter" data-level="6.5" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#getting-predictions-from-the-model-3"><i class="fa fa-check"></i><b>6.5</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="6.6" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#link-to-chapter-2.1-3"><i class="fa fa-check"></i><b>6.6</b> Link to Chapter 2.1</a></li>
<li class="chapter" data-level="6.7" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#checking-assumptions-3"><i class="fa fa-check"></i><b>6.7</b> Checking assumptions</a></li>
<li class="chapter" data-level="6.8" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#post-hoc-testing-for-lm-1"><i class="fa fa-check"></i><b>6.8</b> Post-hoc testing for <code>lm()</code></a></li>
<li class="chapter" data-level="6.9" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#creating-a-figure-3"><i class="fa fa-check"></i><b>6.9</b> Creating a figure</a></li>
<li class="chapter" data-level="6.10" data-path="two-way-anova-revisit.html"><a href="two-way-anova-revisit.html#reporting-the-results-3"><i class="fa fa-check"></i><b>6.10</b> Reporting the results</a></li>
</ul></li>
<li class="part"><span><b>III USING <code>glm()</code> FOR POISSON RESPONSES</b></span></li>
<li class="chapter" data-level="7" data-path="pois.html"><a href="pois.html"><i class="fa fa-check"></i><b>7</b> GLM for poisson responses</a><ul>
<li class="chapter" data-level="7.1" data-path="pois.html"><a href="pois.html#pois-intro"><i class="fa fa-check"></i><b>7.1</b> intro</a></li>
<li class="chapter" data-level="7.2" data-path="pois.html"><a href="pois.html#pois-build"><i class="fa fa-check"></i><b>7.2</b> build</a></li>
<li class="chapter" data-level="7.3" data-path="pois.html"><a href="pois.html#pois-output"><i class="fa fa-check"></i><b>7.3</b> output</a></li>
</ul></li>
<li class="part"><span><b>IV USING <code>glm()</code> FOR BINOMIAL RESPONSES</b></span></li>
<li class="chapter" data-level="8" data-path="bino.html"><a href="bino.html"><i class="fa fa-check"></i><b>8</b> GLM for binomial responses</a><ul>
<li class="chapter" data-level="8.1" data-path="bino.html"><a href="bino.html#bino-intro"><i class="fa fa-check"></i><b>8.1</b> intro</a></li>
<li class="chapter" data-level="8.2" data-path="bino.html"><a href="bino.html#bino-build"><i class="fa fa-check"></i><b>8.2</b> build</a></li>
<li class="chapter" data-level="8.3" data-path="bino.html"><a href="bino.html#bino-output"><i class="fa fa-check"></i><b>8.3</b> output</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>9</b> Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="single-linear-regression" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Single linear regression</h1>
<div id="introduction-to-the-example" class="section level2">
<h2><span class="header-section-number">3.1</span> Introduction to the example</h2>
<p>This is a test you have probably carried out before.</p>
<p>The concentration of juvenile hormone in stag beetles (<em>Lucanus cervus</em>) is known to influence mandible growth. Groups of stag beetles were injected with different concentrations of juvenile hormone (pg<span class="math inline">\(\mu\)</span>l<sup>-1</sup>) and their average mandible size (mm) determined. The data are in <a href="data-raw/stag.txt">stag.txt</a>.</p>
<p>We will import the data with the <code>read_table2()</code> function from the <code>readr</code> package and plot it with <code>ggplot()</code> from the <code>ggplot2</code> package. Both packages are part of the tidyverse.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="single-linear-regression.html#cb1-1"></a>stag &lt;-<span class="st"> </span><span class="kw">read_table2</span>(<span class="st">&quot;data-raw/stag.txt&quot;</span>)</span></code></pre></div>
<p>Juvenile hormone is has been set by the experimenter and mandible size has decimal places and is something we would expect to be normally distributed. Visualising our data before any further analysis is usually sensible. In this case, it will help us determine if any relationship between the two variables is linear.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="single-linear-regression.html#cb2-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stag, <span class="kw">aes</span>(<span class="dt">x =</span> jh, <span class="dt">y =</span> mand)) <span class="op">+</span></span>
<span id="cb2-2"><a href="single-linear-regression.html#cb2-2"></a><span class="st">        </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="single_linear_regression_files/figure-html/unnamed-chunk-2-1.png" width="80%" style="display: block; margin: auto auto auto 0;" />
The relationship between them looks roughly linear. So far, common sense suggests the assumptions of regression are met.</p>
</div>
<div id="applying-and-interpreting-lm" class="section level2">
<h2><span class="header-section-number">3.2</span> Applying and interpreting <code>lm()</code></h2>
<p>The <code>lm()</code> function is used to build the regression model</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="single-linear-regression.html#cb3-1"></a><span class="co"># build the statistical model</span></span>
<span id="cb3-2"><a href="single-linear-regression.html#cb3-2"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data =</span> stag, mand <span class="op">~</span><span class="st"> </span>jh)</span></code></pre></div>
<p>This can be read as: fit a linear of model of mandible size explained by juvenile growth hormone concentration.</p>
<p>Printing <code>mod</code> to the console will reveal the estimated model parameters (coefficients) but little else:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="single-linear-regression.html#cb4-1"></a>mod</span>
<span id="cb4-2"><a href="single-linear-regression.html#cb4-2"></a><span class="co"># </span></span>
<span id="cb4-3"><a href="single-linear-regression.html#cb4-3"></a><span class="co"># Call:</span></span>
<span id="cb4-4"><a href="single-linear-regression.html#cb4-4"></a><span class="co"># lm(formula = mand ~ jh, data = stag)</span></span>
<span id="cb4-5"><a href="single-linear-regression.html#cb4-5"></a><span class="co"># </span></span>
<span id="cb4-6"><a href="single-linear-regression.html#cb4-6"></a><span class="co"># Coefficients:</span></span>
<span id="cb4-7"><a href="single-linear-regression.html#cb4-7"></a><span class="co"># (Intercept)           jh  </span></span>
<span id="cb4-8"><a href="single-linear-regression.html#cb4-8"></a><span class="co">#     0.41934      0.00646</span></span></code></pre></div>
<p><span class="math inline">\(\beta_{0}\)</span> is labelled “(Intercept)” and <span class="math inline">\(\beta_{1}\)</span> is labelled “jh”. Thus the equation of the line is:</p>
<center>
<span class="math inline">\(mand\)</span> = 0.419 + 0.006<span class="math inline">\(jh\)</span>
</center>
<p>More information including statistical tests of the model and its parameters is obtained by using <code>summary()</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="single-linear-regression.html#cb5-1"></a><span class="co"># examine it</span></span>
<span id="cb5-2"><a href="single-linear-regression.html#cb5-2"></a><span class="kw">summary</span>(mod)</span>
<span id="cb5-3"><a href="single-linear-regression.html#cb5-3"></a><span class="co"># </span></span>
<span id="cb5-4"><a href="single-linear-regression.html#cb5-4"></a><span class="co"># Call:</span></span>
<span id="cb5-5"><a href="single-linear-regression.html#cb5-5"></a><span class="co"># lm(formula = mand ~ jh, data = stag)</span></span>
<span id="cb5-6"><a href="single-linear-regression.html#cb5-6"></a><span class="co"># </span></span>
<span id="cb5-7"><a href="single-linear-regression.html#cb5-7"></a><span class="co"># Residuals:</span></span>
<span id="cb5-8"><a href="single-linear-regression.html#cb5-8"></a><span class="co">#     Min      1Q  Median      3Q     Max </span></span>
<span id="cb5-9"><a href="single-linear-regression.html#cb5-9"></a><span class="co"># -0.3860 -0.2028 -0.0975  0.1503  0.6069 </span></span>
<span id="cb5-10"><a href="single-linear-regression.html#cb5-10"></a><span class="co"># </span></span>
<span id="cb5-11"><a href="single-linear-regression.html#cb5-11"></a><span class="co"># Coefficients:</span></span>
<span id="cb5-12"><a href="single-linear-regression.html#cb5-12"></a><span class="co">#             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb5-13"><a href="single-linear-regression.html#cb5-13"></a><span class="co"># (Intercept)  0.41934    0.13943    3.01   0.0094 **</span></span>
<span id="cb5-14"><a href="single-linear-regression.html#cb5-14"></a><span class="co"># jh           0.00646    0.00158    4.08   0.0011 **</span></span>
<span id="cb5-15"><a href="single-linear-regression.html#cb5-15"></a><span class="co"># ---</span></span>
<span id="cb5-16"><a href="single-linear-regression.html#cb5-16"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb5-17"><a href="single-linear-regression.html#cb5-17"></a><span class="co"># </span></span>
<span id="cb5-18"><a href="single-linear-regression.html#cb5-18"></a><span class="co"># Residual standard error: 0.292 on 14 degrees of freedom</span></span>
<span id="cb5-19"><a href="single-linear-regression.html#cb5-19"></a><span class="co"># Multiple R-squared:  0.543,   Adjusted R-squared:  0.51 </span></span>
<span id="cb5-20"><a href="single-linear-regression.html#cb5-20"></a><span class="co"># F-statistic: 16.6 on 1 and 14 DF,  p-value: 0.00113</span></span></code></pre></div>
<p>The “Coefficients:” table gives the estimated <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> again, this time with their standard errors and tests of whether the estimates differ from zero. The estimated value for the intercept is 0.419 <span class="math inline">\(\pm\)</span> 0.139 and this differs significantly from zero (<span class="math inline">\(p\)</span> = 0.009). The estimated value for the slope, 0.006 <span class="math inline">\(\pm\)</span> 0.002, also differs significantly from zero (<span class="math inline">\(p\)</span> = 0.001).</p>
<p>The three lines at the bottom of the output gives information about the fit of the model to the data. The “Multiple R-squared” gives the proportion of the variance in the response which is explained by the model. In our case, 0.543 of the variance in mandible length is explained by the model and this is a significant proportion of that variance (<span class="math inline">\(p\)</span> = 0.001).</p>
<p>For a single linear regression, the <em>p</em>-value for the model and the <em>p</em>-value for the slope are the same. This is also true for linear models in the form of a two-sample <em>t</em>-test but <strong>not</strong> the case for other linear models.</p>
</div>
<div id="getting-predictions-from-the-model" class="section level2">
<h2><span class="header-section-number">3.3</span> Getting predictions from the model</h2>
<p>The <code>predict()</code> returns the predicted values of the response. To add a column of predicted values to the dataframe:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="single-linear-regression.html#cb6-1"></a>stag<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod)</span></code></pre></div>
<p>This requires creating a data frame of the x values from which you want to predict</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="single-linear-regression.html#cb7-1"></a>predictions &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">jh =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="dv">5</span>))</span></code></pre></div>
<p>Note that the name and type of value of explanatory variable must be the same as it is in the model</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="single-linear-regression.html#cb8-1"></a>predictions<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, <span class="dt">newdata =</span> predictions)</span></code></pre></div>
</div>
<div id="link-to-chapter-2.1" class="section level2">
<h2><span class="header-section-number">3.4</span> Link to Chapter 2.1</h2>
<p>Replacing the terms shown in Figure <a href="what-are-linear-models.html#fig:lm-annotated">2.1</a> with the values in this example gives us <a href="single-linear-regression.html#fig:stag-annotated">3.1</a>.</p>

<div class="figure" style="text-align: left"><span id="fig:stag-annotated"></span>
<img src="images/fig_5.svg" alt="The annotated model with the values from the stag beetle example. The measured response values are in pink, the predictions are in green, and the residuals, are in blue. One example of a measured value, a predicted value and the residual is shown for a Juvenile hormone of 130 pg\(\mu\)l-1. The estimated model parameters, \(\beta_{0}\) and \(\beta_{1}\) are indicated. Compare to Figure 2.1." width="80%" />
<p class="caption">
Figure 3.1: The annotated model with the values from the stag beetle example. The measured <span style=" font-weight: bold;    color: #d264c0 !important;">response values are in pink</span>, the <span style=" font-weight: bold;    color: #c0d264 !important;">predictions are in green</span>, and the <span style=" font-weight: bold;    color: #64c0d2 !important;">residuals, are in blue</span>. One example of a measured value, a predicted value and the residual is shown for a Juvenile hormone of 130 pg<span class="math inline">\(\mu\)</span>l<sup>-1</sup>. The estimated model parameters, <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> are indicated. Compare to Figure <a href="what-are-linear-models.html#fig:lm-annotated">2.1</a>.
</p>
</div>
</div>
<div id="checking-assumptions" class="section level2">
<h2><span class="header-section-number">3.5</span> Checking assumptions</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="single-linear-regression.html#cb9-1"></a><span class="kw">plot</span>(mod, <span class="dt">which =</span> <span class="dv">2</span>)</span>
<span id="cb9-2"><a href="single-linear-regression.html#cb9-2"></a><span class="kw">plot</span>(mod, <span class="dt">which =</span> <span class="dv">1</span>)</span>
<span id="cb9-3"><a href="single-linear-regression.html#cb9-3"></a><span class="kw">shapiro.test</span>(mod<span class="op">$</span>res)</span>
<span id="cb9-4"><a href="single-linear-regression.html#cb9-4"></a><span class="co"># </span></span>
<span id="cb9-5"><a href="single-linear-regression.html#cb9-5"></a><span class="co">#   Shapiro-Wilk normality test</span></span>
<span id="cb9-6"><a href="single-linear-regression.html#cb9-6"></a><span class="co"># </span></span>
<span id="cb9-7"><a href="single-linear-regression.html#cb9-7"></a><span class="co"># data:  mod$res</span></span>
<span id="cb9-8"><a href="single-linear-regression.html#cb9-8"></a><span class="co"># W = 0.9, p-value = 0.4</span></span></code></pre></div>
<p><img src="single_linear_regression_files/figure-html/unnamed-chunk-10-1.png" width="80%" style="display: block; margin: auto auto auto 0;" /><img src="single_linear_regression_files/figure-html/unnamed-chunk-10-2.png" width="80%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="creating-a-figure" class="section level2">
<h2><span class="header-section-number">3.6</span> Creating a figure</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="single-linear-regression.html#cb10-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stag, <span class="kw">aes</span>(<span class="dt">x =</span> jh, <span class="dt">y =</span> mand)) <span class="op">+</span></span>
<span id="cb10-2"><a href="single-linear-regression.html#cb10-2"></a><span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb10-3"><a href="single-linear-regression.html#cb10-3"></a><span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>),</span>
<span id="cb10-4"><a href="single-linear-regression.html#cb10-4"></a>                           <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">160</span>),</span>
<span id="cb10-5"><a href="single-linear-regression.html#cb10-5"></a>                           <span class="dt">name =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Juvenile hormone (pg&quot;</span>,</span>
<span id="cb10-6"><a href="single-linear-regression.html#cb10-6"></a>                                                   mu,</span>
<span id="cb10-7"><a href="single-linear-regression.html#cb10-7"></a>                                                   l<span class="op">^-</span><span class="dv">1</span>,</span>
<span id="cb10-8"><a href="single-linear-regression.html#cb10-8"></a>                                                   <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></span>
<span id="cb10-9"><a href="single-linear-regression.html#cb10-9"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb10-10"><a href="single-linear-regression.html#cb10-10"></a>                           <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb10-11"><a href="single-linear-regression.html#cb10-11"></a>                           <span class="dt">name =</span> <span class="st">&quot;Mandible length (mm)&quot;</span>) <span class="op">+</span></span>
<span id="cb10-12"><a href="single-linear-regression.html#cb10-12"></a><span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb10-13"><a href="single-linear-regression.html#cb10-13"></a><span class="st">        </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="single_linear_regression_files/figure-html/fig-reg-1.png" width="80%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="reporting-the-results" class="section level2">
<h2><span class="header-section-number">3.7</span> Reporting the results</h2>
<p>There was a significant positive relationship between the concentration of Juvenile hormone and mandible length (<span class="math inline">\(\beta_{1}\pm s.e.\)</span>: 0.006 <span class="math inline">\(\pm\)</span> 0.002; <span class="math inline">\(p\)</span> = 0.001). See figure <a href="single-linear-regression.html#fig:fig-reg-report">3.2</a>.</p>

<div class="figure" style="text-align: left"><span id="fig:fig-reg-report"></span>
<img src="single_linear_regression_files/figure-html/fig-reg-report-1.png" alt="Relationship between the concentration of Juvenile hormone and mandible length." width="60%" />
<p class="caption">
Figure 3.2: Relationship between the concentration of Juvenile hormone and mandible length.
</p>
</div>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="what-are-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="t-tests-revisit.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/3mmaRand/singlm/edit/master/single_linear_regression.Rmd",
"text": "Make an edit suggestion"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["singlm.pdf", "singlm.epub", "https://github.com/3mmaRand/singlm/raw/master/single_linear_regression.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
