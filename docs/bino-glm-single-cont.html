<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Single continuous explanatory | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</title>
  <meta name="description" content="The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20.6 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Single continuous explanatory | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://3mmarand.github.io/singlm/" />
  <meta property="og:image" content="https://3mmarand.github.io/singlm/images/hex-s.png" />
  <meta property="og:description" content="The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="3mmaRand/singlm" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Single continuous explanatory | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R" />
  
  <meta name="twitter:description" content="The output format for this example is bookdown::gitbook." />
  <meta name="twitter:image" content="https://3mmarand.github.io/singlm/images/hex-s.png" />

<meta name="author" content="Emma Rand" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="bino-glm-overview-5.html"/>
<link rel="next" href="summary.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="assets/book.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/hex-s.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>0.1</b> Who is this book for?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#approach-of-this-book"><i class="fa fa-check"></i><b>0.2</b> Approach of this book</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#options-on-the-toolbar"><i class="fa fa-check"></i><b>0.3</b> Options on the toolbar</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#conventions-used-in-the-book"><i class="fa fa-check"></i><b>0.4</b> Conventions used in the book</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#following-along-with-the-examples"><i class="fa fa-check"></i><b>0.5</b> Following along with the examples</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#overview-of-the-chapter-contents"><i class="fa fa-check"></i><b>0.6</b> Overview of the chapter contents</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#software-information"><i class="fa fa-check"></i><b>0.7</b> Software information</a></li>
</ul></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="what-are-glms-1.html"><a href="what-are-glms-1.html"><i class="fa fa-check"></i><b>1</b> What are GLMs?</a><ul>
<li class="chapter" data-level="1.1" data-path="what-are-glms-1.html"><a href="what-are-glms-1.html#overview-1"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="what-are-glms-1.html"><a href="what-are-glms-1.html#mod-fitting-1"><i class="fa fa-check"></i><b>1.2</b> Model fitting</a></li>
<li class="chapter" data-level="1.3" data-path="what-are-glms-1.html"><a href="what-are-glms-1.html#glm-types-1"><i class="fa fa-check"></i><b>1.3</b> Types of GLM</a></li>
<li class="chapter" data-level="1.4" data-path="what-are-glms-1.html"><a href="what-are-glms-1.html#more-than-1-1"><i class="fa fa-check"></i><b>1.4</b> More than one explanatory variable</a></li>
<li class="chapter" data-level="1.5" data-path="what-are-glms-1.html"><a href="what-are-glms-1.html#glm-in-r-1"><i class="fa fa-check"></i><b>1.5</b> Generalised linear models in R</a><ul>
<li class="chapter" data-level="1.5.1" data-path="what-are-glms-1.html"><a href="what-are-glms-1.html#build-view-1"><i class="fa fa-check"></i><b>1.5.1</b> Building and viewing</a></li>
<li class="chapter" data-level="1.5.2" data-path="what-are-glms-1.html"><a href="what-are-glms-1.html#get-pred-1"><i class="fa fa-check"></i><b>1.5.2</b> Getting predictions</a></li>
<li class="chapter" data-level="1.5.3" data-path="what-are-glms-1.html"><a href="what-are-glms-1.html#tests-of-the-model"><i class="fa fa-check"></i><b>1.5.3</b> Tests of the model</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II POISSON GLMs</b></span></li>
<li class="chapter" data-level="2" data-path="pois-glm-overview-2.html"><a href="pois-glm-overview-2.html"><i class="fa fa-check"></i><b>2</b> Poisson GLM overview</a><ul>
<li class="chapter" data-level="2.1" data-path="pois-glm-overview-2.html"><a href="pois-glm-overview-2.html#pois-glm-chi-2"><i class="fa fa-check"></i><b>2.1</b> When explanatory is categorical</a></li>
<li class="chapter" data-level="2.2" data-path="pois-glm-overview-2.html"><a href="pois-glm-overview-2.html#more-than-one-explanatory"><i class="fa fa-check"></i><b>2.2</b> More than one explanatory</a></li>
<li class="chapter" data-level="2.3" data-path="pois-glm-overview-2.html"><a href="pois-glm-overview-2.html#pois-glm-report-2"><i class="fa fa-check"></i><b>2.3</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html"><i class="fa fa-check"></i><b>3</b> Single continuous explanatory</a><ul>
<li class="chapter" data-level="3.1" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#intro-3"><i class="fa fa-check"></i><b>3.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="3.2" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#apply-interp-3"><i class="fa fa-check"></i><b>3.2</b> Applying and interpreting <code>glm()</code></a></li>
<li class="chapter" data-level="3.3" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#get-pred-3"><i class="fa fa-check"></i><b>3.3</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="3.4" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#fig-3"><i class="fa fa-check"></i><b>3.4</b> Creating a figure</a></li>
<li class="chapter" data-level="3.5" data-path="pois-glm-single-cont.html"><a href="pois-glm-single-cont.html#report-3"><i class="fa fa-check"></i><b>3.5</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pois-glm-two-cont.html"><a href="pois-glm-two-cont.html"><i class="fa fa-check"></i><b>4</b> Two explanatory variables</a><ul>
<li class="chapter" data-level="4.1" data-path="pois-glm-two-cont.html"><a href="pois-glm-two-cont.html#intro-4"><i class="fa fa-check"></i><b>4.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="4.2" data-path="pois-glm-two-cont.html"><a href="pois-glm-two-cont.html#apply-interp-4"><i class="fa fa-check"></i><b>4.2</b> Applying and interpreting <code>glm()</code></a></li>
<li class="chapter" data-level="4.3" data-path="pois-glm-two-cont.html"><a href="pois-glm-two-cont.html#getting-predictions-from-the-model"><i class="fa fa-check"></i><b>4.3</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="4.4" data-path="pois-glm-two-cont.html"><a href="pois-glm-two-cont.html#fig-4"><i class="fa fa-check"></i><b>4.4</b> Creating a figure</a></li>
<li class="chapter" data-level="4.5" data-path="pois-glm-two-cont.html"><a href="pois-glm-two-cont.html#report-4"><i class="fa fa-check"></i><b>4.5</b> Reporting the results</a></li>
</ul></li>
<li class="part"><span><b>III BINOMIAL GLMs</b></span></li>
<li class="chapter" data-level="5" data-path="bino-glm-overview-5.html"><a href="bino-glm-overview-5.html"><i class="fa fa-check"></i><b>5</b> Binomial GLM overview</a><ul>
<li class="chapter" data-level="5.1" data-path="bino-glm-overview-5.html"><a href="bino-glm-overview-5.html#bino-odds-5"><i class="fa fa-check"></i><b>5.1</b> What exactly are odds?</a></li>
<li class="chapter" data-level="5.2" data-path="bino-glm-overview-5.html"><a href="bino-glm-overview-5.html#bino-b0-odds-5"><i class="fa fa-check"></i><b>5.2</b> What does this mean for <span class="math inline">\(\beta_{0}\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bino-glm-single-cont.html"><a href="bino-glm-single-cont.html"><i class="fa fa-check"></i><b>6</b> Single continuous explanatory</a><ul>
<li class="chapter" data-level="6.1" data-path="bino-glm-single-cont.html"><a href="bino-glm-single-cont.html#intro-6"><i class="fa fa-check"></i><b>6.1</b> Introduction to the example</a></li>
<li class="chapter" data-level="6.2" data-path="bino-glm-single-cont.html"><a href="bino-glm-single-cont.html#apply-interp-6"><i class="fa fa-check"></i><b>6.2</b> Applying and interpreting <code>glm()</code></a></li>
<li class="chapter" data-level="6.3" data-path="bino-glm-single-cont.html"><a href="bino-glm-single-cont.html#get-pred-6"><i class="fa fa-check"></i><b>6.3</b> Getting predictions from the model</a></li>
<li class="chapter" data-level="6.4" data-path="bino-glm-single-cont.html"><a href="bino-glm-single-cont.html#fig-6"><i class="fa fa-check"></i><b>6.4</b> Creating a figure</a></li>
<li class="chapter" data-level="6.5" data-path="bino-glm-single-cont.html"><a href="bino-glm-single-cont.html#report-6"><i class="fa fa-check"></i><b>6.5</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>7</b> Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bino-glm-single-cont" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Single continuous explanatory</h1>
<div id="intro-6" class="section level2">
<h2><span class="header-section-number">6.1</span> Introduction to the example</h2>
<p>The erythrocyte sedimentation rate (ESR) is a routine test for inflammation where a reading greater than 20mm/hr indicates inflammation. However, fibrinogen levels also affect ESR. The aim of this analysis is to determine whether an ESR greater than 20mm/hr can be predicted from fibrinogen levels.
The data in <a href="data-raw/plasma.txt">plasma.txt</a> are a simplified version of Collett and Jemain’s (1985) data which comes with the <strong><code>HSAUR</code></strong> package <span class="citation">(Everitt and Hothorn <a href="#ref-HSAUR" role="doc-biblioref">2017</a>)</span>. There are two variables: ESR where 0 indicates less than or equal to 20mm/hr and 1 indicates greater than 20mm/hr; and fibrinogen in arbitrary units.</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fibrinogen
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ESR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2.52
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.56
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.19
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.18
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
3.41
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.46
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
3.22
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.21
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
3.15
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.60
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.29
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.35
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
3.15
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.68
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.60
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.23
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.88
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.65
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.28
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.67
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.29
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.15
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.54
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
3.34
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2.99
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
3.32
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
5.06
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3.34
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
2.38
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3.53
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3.93
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div class="key">
<p>The response is ESR where 0 indicates less than or equal to 20mm/hr and 1 indicates greater than 20mm/hr. Fibrinogen is the explanatory variable.</p>
</div>
<p>We will import the data with the <code>read_table2()</code> function and plot it with <code>ggplot()</code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="bino-glm-single-cont.html#cb30-1"></a>plasma &lt;-<span class="st"> </span><span class="kw">read_table2</span>(<span class="st">&quot;data-raw/plasma.txt&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="bino-glm-single-cont.html#cb31-1"></a><span class="co"># a default scatter plot of the data</span></span>
<span id="cb31-2"><a href="bino-glm-single-cont.html#cb31-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> plasma, <span class="kw">aes</span>(<span class="dt">x =</span> fibrinogen, <span class="dt">y =</span> ESR)) <span class="op">+</span></span>
<span id="cb31-3"><a href="bino-glm-single-cont.html#cb31-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="glm-bino-single-cont_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto auto auto 0;" />
Those with lower ESR do seem to have lower fibrinogen and half of those with high ESR have high fibrinogen. However, we have relatively few high ESR observations. Is the association significant?</p>
</div>
<div id="apply-interp-6" class="section level2">
<h2><span class="header-section-number">6.2</span> Applying and interpreting <code>glm()</code></h2>
<p>We build a generalised linear model of ESR explained by fibrinogen with the <code>glm()</code> function as follows:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="bino-glm-single-cont.html#cb32-1"></a>mod &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="dt">data =</span> plasma, ESR <span class="op">~</span><span class="st"> </span>fibrinogen, <span class="dt">family =</span> binomial)</span></code></pre></div>
<p>Printing <code>mod</code> to the console gives us the estimated model parameters:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="bino-glm-single-cont.html#cb33-1"></a>mod</span>
<span id="cb33-2"><a href="bino-glm-single-cont.html#cb33-2"></a><span class="co"># </span></span>
<span id="cb33-3"><a href="bino-glm-single-cont.html#cb33-3"></a><span class="co"># Call:  glm(formula = ESR ~ fibrinogen, family = binomial, data = plasma)</span></span>
<span id="cb33-4"><a href="bino-glm-single-cont.html#cb33-4"></a><span class="co"># </span></span>
<span id="cb33-5"><a href="bino-glm-single-cont.html#cb33-5"></a><span class="co"># Coefficients:</span></span>
<span id="cb33-6"><a href="bino-glm-single-cont.html#cb33-6"></a><span class="co"># (Intercept)   fibrinogen  </span></span>
<span id="cb33-7"><a href="bino-glm-single-cont.html#cb33-7"></a><span class="co">#       -6.85         1.83  </span></span>
<span id="cb33-8"><a href="bino-glm-single-cont.html#cb33-8"></a><span class="co"># </span></span>
<span id="cb33-9"><a href="bino-glm-single-cont.html#cb33-9"></a><span class="co"># Degrees of Freedom: 31 Total (i.e. Null);  30 Residual</span></span>
<span id="cb33-10"><a href="bino-glm-single-cont.html#cb33-10"></a><span class="co"># Null Deviance:        30.9 </span></span>
<span id="cb33-11"><a href="bino-glm-single-cont.html#cb33-11"></a><span class="co"># Residual Deviance: 24.8   AIC: 28.8</span></span></code></pre></div>
<p>We will postpone discussing the information in the last three lines until we view the model summary.</p>
<p><span class="math inline">\(\beta_{0}\)</span> is labelled “(Intercept)” and <span class="math inline">\(\beta_{1}\)</span> is labelled “fibrinogen”. Thus the equation of the line is:</p>
<p>So the equation of the model is:</p>
<center>
<span class="math inline">\(ln\left(\frac{P(ESR &gt;20)}{1-P(ESR &gt;20)}\right)\)</span> = -6.845 <span class="math inline">\(+\)</span> 1.827<span class="math inline">\(\times fibrinogen\)</span>
</center>
<p>The fact that the estimate for fibrinogen (1.827) is positive tells us the probability of having an ESR greater than 20 mm/hr increases as fibrinogen increases.</p>
<p>The fact that the estimate for the intercept (-6.845) is negative tells us the probability of having an ESR greater than 20 mm/hr is lower than the probability of having an an ESR less than 20 mm/hr at a fibrinogen of zero.</p>
<p>These estimates are on the scale of the link function - they are log odds.</p>
<p>To understand the parameters the on the scale of the response we apply the inverse of the link function. We need to first exponentiate them, then interpret them as odds.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="bino-glm-single-cont.html#cb34-1"></a><span class="kw">exp</span>(mod<span class="op">$</span>coefficients)</span>
<span id="cb34-2"><a href="bino-glm-single-cont.html#cb34-2"></a><span class="co"># (Intercept)  fibrinogen </span></span>
<span id="cb34-3"><a href="bino-glm-single-cont.html#cb34-3"></a><span class="co">#     0.00106     6.21572</span></span></code></pre></div>
<p>0.001 is the odds of an ESR &gt;20 at a fibrinogen of 0. Odds are P(ESR &gt; 20) / P(ESR &lt; 20). As this is less than 1, the probability of an ESR &gt;20 must be smaller than the probability ESR &lt; 20 at a fibrinogen of 0.</p>
<p>6.216 is the factor by which this odds changes with each unit of fibrinogen. As this is greater than 1, it’s going up, not down.</p>
<p>An alterative way to write the equation of the line is:</p>
<center>
<span class="math inline">\(\frac{P(ESR &gt;20)}{P(ESR &lt;20)}\)</span> = 0.001 <span class="math inline">\(\times\)</span> 1.827<span class="math inline">\(^{fibrinogen}\)</span>
</center>
<p>More information including statistical tests of the model and its parameters is obtained by using <code>summary()</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="bino-glm-single-cont.html#cb35-1"></a><span class="kw">summary</span>(mod) </span>
<span id="cb35-2"><a href="bino-glm-single-cont.html#cb35-2"></a><span class="co"># </span></span>
<span id="cb35-3"><a href="bino-glm-single-cont.html#cb35-3"></a><span class="co"># Call:</span></span>
<span id="cb35-4"><a href="bino-glm-single-cont.html#cb35-4"></a><span class="co"># glm(formula = ESR ~ fibrinogen, family = binomial, data = plasma)</span></span>
<span id="cb35-5"><a href="bino-glm-single-cont.html#cb35-5"></a><span class="co"># </span></span>
<span id="cb35-6"><a href="bino-glm-single-cont.html#cb35-6"></a><span class="co"># Deviance Residuals: </span></span>
<span id="cb35-7"><a href="bino-glm-single-cont.html#cb35-7"></a><span class="co">#    Min      1Q  Median      3Q     Max  </span></span>
<span id="cb35-8"><a href="bino-glm-single-cont.html#cb35-8"></a><span class="co"># -0.930  -0.540  -0.438  -0.336   2.479  </span></span>
<span id="cb35-9"><a href="bino-glm-single-cont.html#cb35-9"></a><span class="co"># </span></span>
<span id="cb35-10"><a href="bino-glm-single-cont.html#cb35-10"></a><span class="co"># Coefficients:</span></span>
<span id="cb35-11"><a href="bino-glm-single-cont.html#cb35-11"></a><span class="co">#             Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span id="cb35-12"><a href="bino-glm-single-cont.html#cb35-12"></a><span class="co"># (Intercept)   -6.845      2.770   -2.47    0.013 *</span></span>
<span id="cb35-13"><a href="bino-glm-single-cont.html#cb35-13"></a><span class="co"># fibrinogen     1.827      0.901    2.03    0.043 *</span></span>
<span id="cb35-14"><a href="bino-glm-single-cont.html#cb35-14"></a><span class="co"># ---</span></span>
<span id="cb35-15"><a href="bino-glm-single-cont.html#cb35-15"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb35-16"><a href="bino-glm-single-cont.html#cb35-16"></a><span class="co"># </span></span>
<span id="cb35-17"><a href="bino-glm-single-cont.html#cb35-17"></a><span class="co"># (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb35-18"><a href="bino-glm-single-cont.html#cb35-18"></a><span class="co"># </span></span>
<span id="cb35-19"><a href="bino-glm-single-cont.html#cb35-19"></a><span class="co">#     Null deviance: 30.885  on 31  degrees of freedom</span></span>
<span id="cb35-20"><a href="bino-glm-single-cont.html#cb35-20"></a><span class="co"># Residual deviance: 24.840  on 30  degrees of freedom</span></span>
<span id="cb35-21"><a href="bino-glm-single-cont.html#cb35-21"></a><span class="co"># AIC: 28.84</span></span>
<span id="cb35-22"><a href="bino-glm-single-cont.html#cb35-22"></a><span class="co"># </span></span>
<span id="cb35-23"><a href="bino-glm-single-cont.html#cb35-23"></a><span class="co"># Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
<p>The <code>Coefficients</code> table gives the estimated <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> again but along with their standard errors and tests of whether the estimates differ from zero. The estimated value for the intercept is -6.845 <span class="math inline">\(\pm\)</span> 2.77 and this differs significantly from zero (<span class="math inline">\(p\)</span> = 0.013). The estimated value for the slope is 1.827 <span class="math inline">\(\pm\)</span> 0.901, also differs significantly from zero (<span class="math inline">\(p\)</span> = 0.043).</p>
<p>Towards the bottom of the output there is information about the model fit. The null deviance (what exists if we predict the odds of ESR &gt; 20 from an intercept, <span class="math inline">\(\beta_{0}\)</span>, only model) is 30.885 with 31 degrees of freedom and the residual deviance (left over after our model is fitted) is 24.84 with 30 <span class="math inline">\(d.f.\)</span>. The model fits a 1 parameter, <span class="math inline">\(\beta_{1}\)</span>, and thus accounts for 1 <span class="math inline">\(d.f.\)</span> for a reduction in deviance by 6.045.</p>
<p>To get a test of whether the reduction in deviance is significant for each term in the the model formula we use:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="bino-glm-single-cont.html#cb36-1"></a><span class="kw">anova</span>(mod, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span>
<span id="cb36-2"><a href="bino-glm-single-cont.html#cb36-2"></a><span class="co"># Analysis of Deviance Table</span></span>
<span id="cb36-3"><a href="bino-glm-single-cont.html#cb36-3"></a><span class="co"># </span></span>
<span id="cb36-4"><a href="bino-glm-single-cont.html#cb36-4"></a><span class="co"># Model: binomial, link: logit</span></span>
<span id="cb36-5"><a href="bino-glm-single-cont.html#cb36-5"></a><span class="co"># </span></span>
<span id="cb36-6"><a href="bino-glm-single-cont.html#cb36-6"></a><span class="co"># Response: ESR</span></span>
<span id="cb36-7"><a href="bino-glm-single-cont.html#cb36-7"></a><span class="co"># </span></span>
<span id="cb36-8"><a href="bino-glm-single-cont.html#cb36-8"></a><span class="co"># Terms added sequentially (first to last)</span></span>
<span id="cb36-9"><a href="bino-glm-single-cont.html#cb36-9"></a><span class="co"># </span></span>
<span id="cb36-10"><a href="bino-glm-single-cont.html#cb36-10"></a><span class="co"># </span></span>
<span id="cb36-11"><a href="bino-glm-single-cont.html#cb36-11"></a><span class="co">#            Df Deviance Resid. Df Resid. Dev Pr(&gt;Chi)  </span></span>
<span id="cb36-12"><a href="bino-glm-single-cont.html#cb36-12"></a><span class="co"># NULL                          31       30.9           </span></span>
<span id="cb36-13"><a href="bino-glm-single-cont.html#cb36-13"></a><span class="co"># fibrinogen  1     6.04        30       24.8    0.014 *</span></span>
<span id="cb36-14"><a href="bino-glm-single-cont.html#cb36-14"></a><span class="co"># ---</span></span>
<span id="cb36-15"><a href="bino-glm-single-cont.html#cb36-15"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>There is a significant reduction in deviance for our model (p = 0.014).</p>
</div>
<div id="get-pred-6" class="section level2">
<h2><span class="header-section-number">6.3</span> Getting predictions from the model</h2>
<p>The <code>predict()</code> function returns the predicted values of the response. To add a column of predicted values to the dataframe:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="bino-glm-single-cont.html#cb37-1"></a><span class="co"># plasma$pred &lt;- predict(mod, type = &quot;response&quot;)</span></span></code></pre></div>
<p>We need to specify they should be on the scale of the responses (i.e., probabilities), not on the link function scale (log odds).</p>
<p>This gives predictions for the actual <span class="math inline">\(x\)</span> values used. If you want predictions for other values of <span class="math inline">\(x\)</span> you need to creating a data frame of the <span class="math inline">\(x\)</span> values from which you want to predict</p>
<p>For example, to predict for fibrinogen from 0 to 6 km in steps of 1 km:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="bino-glm-single-cont.html#cb38-1"></a>predict_for &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">fibrinogen =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="bino-glm-single-cont.html#cb39-1"></a>predict_for<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, <span class="dt">newdata =</span> predict_for, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<p><em>need to add some text</em>
<em>- soon honest!</em></p>
</div>
<div id="fig-6" class="section level2">
<h2><span class="header-section-number">6.4</span> Creating a figure</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="bino-glm-single-cont.html#cb40-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> plasma, <span class="kw">aes</span>(<span class="dt">x =</span> fibrinogen, <span class="dt">y =</span> ESR)) <span class="op">+</span></span>
<span id="cb40-2"><a href="bino-glm-single-cont.html#cb40-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb40-3"><a href="bino-glm-single-cont.html#cb40-3"></a><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb40-4"><a href="bino-glm-single-cont.html#cb40-4"></a>              <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>),</span>
<span id="cb40-5"><a href="bino-glm-single-cont.html#cb40-5"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>,</span>
<span id="cb40-6"><a href="bino-glm-single-cont.html#cb40-6"></a>            <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb40-7"><a href="bino-glm-single-cont.html#cb40-7"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb40-8"><a href="bino-glm-single-cont.html#cb40-8"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb40-9"><a href="bino-glm-single-cont.html#cb40-9"></a>                     <span class="dt">name =</span> <span class="st">&quot;Fibrinogen (units)&quot;</span>) <span class="op">+</span></span>
<span id="cb40-10"><a href="bino-glm-single-cont.html#cb40-10"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.03</span>),</span>
<span id="cb40-11"><a href="bino-glm-single-cont.html#cb40-11"></a>                      <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb40-12"><a href="bino-glm-single-cont.html#cb40-12"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.05</span>),</span>
<span id="cb40-13"><a href="bino-glm-single-cont.html#cb40-13"></a>                     <span class="dt">name =</span> <span class="st">&quot;Probability of ESR &gt;2 0&quot;</span>) <span class="op">+</span></span>
<span id="cb40-14"><a href="bino-glm-single-cont.html#cb40-14"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span>
<span id="cb40-15"><a href="bino-glm-single-cont.html#cb40-15"></a>  </span></code></pre></div>
<p><img src="glm-bino-single-cont_files/figure-html/fig-plasma-1.png" width="80%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="report-6" class="section level2">
<h2><span class="header-section-number">6.5</span> Reporting the results</h2>
<p><em>to be added - soon honest!</em>
<!-- The number of plasma reported by a clinic significantly decreases by a factor of 0.001 $\pm$ 0.901 for each kilometre from the nuclear plant (p = 0.014). See figure \@ref(fig:fig-plasma-report). For a clinic at the plant, -6.845 $\pm$ 2.77 plasma are expected --></p>

<div class="figure" style="text-align: left"><span id="fig:fig-plasma-report"></span>
<img src="glm-bino-single-cont_files/figure-html/fig-plasma-report-1.png" alt="Incidence erythrocyte sedimentation rate (ESR) greater than 20 mm/hr with fibrinogen levels. The line gives predictions for a GLM with binomial distributed errors, \(\frac{P(ESR &gt;20)}{P(ESR &lt;20)}\) = 0.001 \(\times\) 1.827\(^{fibrinogen}\)." width="60%" />
<p class="caption">
Figure 6.1: Incidence erythrocyte sedimentation rate (ESR) greater than 20 mm/hr with fibrinogen levels. The line gives predictions for a GLM with binomial distributed errors, <span class="math inline">\(\frac{P(ESR &gt;20)}{P(ESR &lt;20)}\)</span> = 0.001 <span class="math inline">\(\times\)</span> 1.827<span class="math inline">\(^{fibrinogen}\)</span>.
</p>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-HSAUR">
<p>Everitt, Brian S., and Torsten Hothorn. 2017. <em>HSAUR: A Handbook of Statistical Analyses Using R (1st Edition)</em>. <a href="https://CRAN.R-project.org/package=HSAUR">https://CRAN.R-project.org/package=HSAUR</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bino-glm-overview-5.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/3mmaRand/singlm/edit/master/glm-bino-single-cont.Rmd",
"text": "Make an edit suggestion"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["singlm.pdf", "singlm.epub", "https://github.com/3mmaRand/singlm/raw/master/glm-bino-single-cont.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
