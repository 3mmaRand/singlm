[{"path":"index.html","id":"welcome","chapter":"Welcome!","heading":"Welcome!","text":"hex logo","code":""},{"path":"index.html","id":"who-is-this-book-for","chapter":"Welcome!","heading":"0.1 Who is this book for?","text":"book R users done introductory class data analysis covered hypothesis testing applying interpreting linear models R lm() function. assume familiar , expert , using R RStudio import data, analyse interpret results create figures using ggplot().book aims teach use interpret glm() function R two types response data normally distributed: Poisson distributed responses (counts) binomially distributed responses (binary outcomes).","code":""},{"path":"index.html","id":"approach-of-this-book","chapter":"Welcome!","heading":"0.2 Approach of this book","text":"Models explained reference examples. example demonstrates R code needed, understand output report results, including suggested ggplot2figures.\ncode given figures extensively explained. learn go https://ggplot2.tidyverse.org/","code":""},{"path":"index.html","id":"options-on-the-toolbar","chapter":"Welcome!","heading":"0.3 Options on the toolbar","text":"can change appearance book using toolbar top page. menu left can hidden, font size increased decreased colour altered dark sepia theme.Search book clicking magnifying glass, entering search term using arrows navigate results.","code":""},{"path":"index.html","id":"conventions-used-in-the-book","chapter":"Welcome!","heading":"0.4 Conventions used in the book","text":"Code output appears blocks formatted like :Lines output start #. content code block can copied using icon top right.Within text:packages indicated bold code font like : ggplot2functions indicated code font brackets name like : ggplot()R objects indicated code font like : casesKey points summarised throughout book using boxes like :key point previous paragraphs boxes like theseExtra pieces information essential understanding material presented like :Extra information tips boxes like ","code":"\ncases <- read_table2(\"data-raw/cases.txt\")\nglimpse(cases)\n# Rows: 43\n# Columns: 2\n# $ cancers  <dbl> 0, 0, 4, 0, 0, 0, 0, 1, 0, 0, 2, 0, 2, 1, 1, 0, 0, 1, 1, 1, 1~\n# $ distance <dbl> 154.37, 93.14, 3.83, 60.83, 142.61, 164.72, 135.92, 79.92, 11~"},{"path":"index.html","id":"following-along-with-the-examples","chapter":"Welcome!","heading":"0.5 Following along with the examples","text":"Readers may wish code along following gives guidance best .recommend starting new RStudio project creating folder inside project called “data-raw” save data files. Links data files given text can downloaded “data-raw” folder right-clicking link choosing option save. make new script file example carry analysis example.example, call Project singlm just started Chapter 3, folder structure look like :Using structure mean paths files needed code given book.use packages tidyverse (Wickham et al. 2019) including ggplot2 (Wickham 2016), dplyr (Wickham et al. 2020), tidyr (Wickham 2020) readr (Wickham, Hester, Francois 2018) throughout book. code assumes loaded core tidyverse packages :run examples get error like :likely need load tidyverse shown .packages loaded explicitly library() statements needed.follow examples, use RStudio Project containing “data-raw” folder load tidyverse library(tidyverse)","code":"-- singlm\n   |-- singlm.Rproj\n   |-- cases_poisson.R\n   |-- data-raw\n      |-- cases.text\n\nlibrary(tidyverse)\n# Error in read_table2(\"data-raw/cases.txt\") : \n#  could not find function \"read_table2\""},{"path":"index.html","id":"overview-of-the-chapter-contents","chapter":"Welcome!","heading":"0.6 Overview of the chapter contents","text":"book introduces Generalised Linear Model two types discrete response:1.Poisson distributed: response variable number things.\n2. Binomially distributed: response variable can take one two values, “yes” “,” “alive” “dead,” “present” “absent.”R, analysed glm() function.glm() can used perform tests using Generalised Linear Model response variables counts binary.","code":""},{"path":"index.html","id":"credits","chapter":"Welcome!","heading":"Credits","text":"used bookdown package (Xie 2020) compile book. R session information shown :","code":"\nsessionInfo()\n# R version 4.1.0 (2021-05-18)\n# Platform: x86_64-w64-mingw32/x64 (64-bit)\n# Running under: Windows 10 x64 (build 18363)\n# \n# Matrix products: default\n# \n# locale:\n# [1] LC_COLLATE=English_United Kingdom.1252 \n# [2] LC_CTYPE=English_United Kingdom.1252   \n# [3] LC_MONETARY=English_United Kingdom.1252\n# [4] LC_NUMERIC=C                           \n# [5] LC_TIME=English_United Kingdom.1252    \n# \n# attached base packages:\n# [1] stats     graphics  grDevices utils     datasets  methods   base     \n# \n# other attached packages:\n#  [1] patchwork_1.1.1  kableExtra_1.3.4 forcats_0.5.1    stringr_1.4.0   \n#  [5] dplyr_1.0.7      purrr_0.3.4      readr_2.0.2      tidyr_1.1.4     \n#  [9] tibble_3.1.4     ggplot2_3.3.5    tidyverse_1.3.1 \n# \n# loaded via a namespace (and not attached):\n#  [1] Rcpp_1.0.7        svglite_2.0.0     lubridate_1.7.10  assertthat_0.2.1 \n#  [5] digest_0.6.28     utf8_1.2.2        R6_2.5.1          cellranger_1.1.0 \n#  [9] backports_1.2.1   reprex_2.0.1      evaluate_0.14     httr_1.4.2       \n# [13] pillar_1.6.3      rlang_0.4.11      readxl_1.3.1      rstudioapi_0.13  \n# [17] jquerylib_0.1.4   rmarkdown_2.11    webshot_0.5.2     munsell_0.5.0    \n# [21] broom_0.7.9       compiler_4.1.0    modelr_0.1.8      xfun_0.26        \n# [25] pkgconfig_2.0.3   systemfonts_1.0.2 htmltools_0.5.2   downlit_0.2.1    \n# [29] tidyselect_1.1.1  bookdown_0.24     fansi_0.5.0       viridisLite_0.4.0\n# [33] crayon_1.4.1      tzdb_0.1.2        dbplyr_2.1.1      withr_2.4.2      \n# [37] grid_4.1.0        jsonlite_1.7.2    gtable_0.3.0      lifecycle_1.0.1  \n# [41] DBI_1.1.1         magrittr_2.0.1    scales_1.1.1      cli_3.0.1        \n# [45] stringi_1.7.4     fs_1.5.0          xml2_1.3.2        bslib_0.3.0      \n# [49] ellipsis_0.3.2    generics_0.1.0    vctrs_0.3.8       tools_4.1.0      \n# [53] glue_1.4.2        hms_1.1.1         fastmap_1.1.0     yaml_2.2.1       \n# [57] colorspace_2.0-2  rvest_1.0.1       knitr_1.34        haven_2.4.3      \n# [61] sass_0.4.0"},{"path":"index.html","id":"license","chapter":"Welcome!","heading":"License","text":"online work licensed Creative Commons Attribution-ShareAlike 4.0 International.\nVisit information license.","code":""},{"path":"what-are-glms-1.html","id":"what-are-glms-1","chapter":"1 What are GLMs?","heading":"1 What are GLMs?","text":"","code":""},{"path":"what-are-glms-1.html","id":"overview-1","chapter":"1 What are GLMs?","heading":"1.1 Overview","text":"General Linear models predict value normally distributed response linear combination predictor variables.Generalised Linear Model extension General Linear model situations response variable follow normal distribution. can, instead, come large family distributions known Exponential family includes normal, Poisson binomial distributions. generalises allowing linear model related response variable something call link function.single explanatory variable, General Linear model :\\[\\begin{equation}\nE(y_{})=\\beta_{0}+\\beta_{1}X1_{}\n\\tag{1.1}\n\\end{equation}\\]:\\(y\\) response variable \\(X1\\) explanatory variable.\\(\\) index \\(X1_{}\\) \\(\\)th value \\(X1\\)\\(E(y_{})\\) expected value \\(y\\) \\(\\)th value \\(X1\\).\\(\\beta_{0}\\) \\(\\beta_{1}\\) coefficients model.Generalised Linear Model :\n\\[\\begin{equation}\nfunction(E(y_{}))=\\beta_{0}+\\beta_{1}X1_{}\n\\tag{1.2}\n\\end{equation}\\]:\\(function()\\) link functionThe link function transformation applied expected value response link explanatory variables.measured response particular value \\(x\\) many times distribution responses. Instead distribution normal, can come different distribution Poisson Binomial distributions. consequence, residuals also come distribution. fact residuals can follow distribution normal also means variance longer homogeneous can change values x.can see two model equations similar structure. good reason - can think general linear model special case generalised linear model transformation expected value, \\(E(y_{})\\), required.important difference general linear model (applied lm()) generalised linear model (applied glm()) estimates coefficients given scale link function. just read predicted response \\(x=0\\) \\(\\beta_{0}\\) - invert link function express coefficients terms response.Response variables binary counts can analysed GLMs. estimated coefficients GLMs transformed link function. inverse link function applied understand terms response.","code":""},{"path":"what-are-glms-1.html","id":"mod-fitting-1","chapter":"1 What are GLMs?","heading":"1.2 Model fitting","text":"Another important difference models measure fit test measure fit. parameters General linear models chosen minimise sum squared residuals use \\(R^2\\), proportion variance explained. variance ratio test, F-test, used determine proportion variance explained significant.GLMS maximise log-likelihood model (\\(l\\)) choose parameter values. known maximum likelihood estimation. measure fit used GLMs deviance deviance \\(-2l\\). Low deviance means good fit high deviance worse fit. Thus maximum likelihood estimation can thought minimising deviance. test compares deviance predictions model deviance intercept model. deviance predictions intercept alone called Null deviance.Instead considering size \\(R^2\\) consider reduction deviance null model residual deviance (deviance left model fit). can consider residual deviance play role \\(SSE\\). difference null model deviance residual deviance full model chi-squared distribution test whether model good overall “chi-squared test deviance” analogous way general linear model uses \\(F\\) variance ratio test.GLMs maximise log-likelihood choose coefficient values rather minimising sum squared residuals (\\(SSE\\)) general linear models. Residual deviance rather \\(SSE\\) represents unexplained variation response Null deviance analogous total sums squares. Model fit tested chi-squared test deviance rather \\(F\\) test varianceThe Akaike Information Criterion (AIC) measure fit plays role GLMs adjusted \\(R^2\\) plays general linear model. trade-goodness fit model simplicity model. AIC values can also determined general linear models (adjusted \\(R^2\\) calculated GLMs).\nFigure 1.1: Hirotugu Akaike. Institute Statistical Mathematics - Institute Statistical Mathematics, CC -SA 4.0, https://commons.wikimedia.org/w/index.php?curid=64389664\n","code":""},{"path":"what-are-glms-1.html","id":"glm-types-1","chapter":"1 What are GLMs?","heading":"1.3 Types of GLM","text":"Poisson GLMs used response count. also known GLMs Poisson errors Poisson regression. link function natural logarithm, \\(ln\\), function probably know. means predictions log counts coefficients exponentiated using exp() get predicted counts exp() inverse log().R, log() function computes natural logarithms (.e., logs base \\(e\\) default.Binomial GLMs used response binary, zero one, proportion. example, response died (0) survived (1), absent (0) present (1) right-handed (0) left-handed (1). Binomial GLMs also known GLMs binomial errors, binomial regression logistic regression. link function \\(logit\\), function may heard . predictions “log-odds.” “odds” one probability divided another. coefficients exponentiated using exp() interpreted odds. Often easiest way understand predictions use predict() function get predictions scale response. binomial variable died (0) survived(1) probabilities survival.Poisson GLMs used response count estimates log counts. Binomial GLMs used response binary estimates log-odds. predict() especially useful understanding binomial GLMs.","code":""},{"path":"what-are-glms-1.html","id":"more-than-1-1","chapter":"1 What are GLMs?","heading":"1.4 More than one explanatory variable","text":"one explanatory variable given \\(X2\\), \\(X3\\) \\(p\\)th explanatory variable. explanatory variable \\(\\beta\\) coefficient.general form model :\n\\[\\begin{equation}\nfunction(E(y_{}))=\\beta_{0}+\\beta_{1}X1_{}+\\beta_{2}X2_{}+...+\\beta_{p}Xp_{}\n\\tag{1.3}\n\\end{equation}\\]","code":""},{"path":"what-are-glms-1.html","id":"glm-in-r-1","chapter":"1 What are GLMs?","heading":"1.5 Generalised linear models in R","text":"","code":""},{"path":"what-are-glms-1.html","id":"build-view-1","chapter":"1 What are GLMs?","heading":"1.5.1 Building and viewing","text":"Poisson binomial generalised linear models (others) can carried glm() function R. uses method, response ~ explanatory specifying model functions, including lm(), use. However, also specify type GLM using family argument:one explanatory variable command :glm(data = dataframe, response ~ explanatory, family = distribution(link = linkfunction))Poisson GLM :glm(data = dataframe, response ~ explanatory, family = poisson(link = log))binomial GLM :glm(data = dataframe, response ~ explanatory, family = binomial(link = “logit”))model formula can developed way ’ve seen previously. two explanatory variable add second explanatory variable formula using + *. command :glm(data = dataframe, response ~ explanatory1 + explanatory2, family = distribution(link = linkfunction))orglm(data = dataframe, response ~ explanatory1 * explanatory2, family = distribution(link = linkfunction))model explanatory1 + explanatory2 considers effects two variables independently. model explanatory1 * explanatory2 considers effects two variables interaction .usually assign output glm() commands object view summary(). typical workflow :\nmod <- glm(data = dataframe, response ~ explanatory, family = distribution(link = linkfunction))\nsummary(mod)\nglm() can used perform tests using Generalised Linear Model including Poisson Binomial regression. type GLM needs specified.Elements glm() object include estimated coefficients can accessed mod$coeffients.","code":""},{"path":"what-are-glms-1.html","id":"get-pred-1","chapter":"1 What are GLMs?","heading":"1.5.2 Getting predictions","text":"mod$fitted.values gives predicted values explanatory variable values actually used experiment, .e., prediction row data. given scale response. means predicted counts Poisson GLMs predicted probabilities Binomial GLMs.","code":""},{"path":"what-are-glms-1.html","id":"tests-of-the-model","chapter":"1 What are GLMs?","heading":"1.5.3 Tests of the model","text":"lm() get F variance ratio test model view summary. answers question “model explain significant amount variation response relative response mean?”glm() get test model view summary. ask chi-squared test deviance. answers question “model significantly decrease deviance relative response mean?”\n\nanova(mod, test = “Chisq”)\nget predictions different set values need make dataframe different set values use predict() function. using predict() function specify want predictions scale response rather scale link function using type argument.\ntypical workflow :predict_for <- data.frame(explanatory = values)\npredict_for$pred <- predict(mod, newdata = predict_for, type = “response”)","code":""},{"path":"pois-glm-overview-2.html","id":"pois-glm-overview-2","chapter":"2 Poisson GLM overview","heading":"2 Poisson GLM overview","text":"response variable count objects, individuals events often follows Poisson distribution. variables always positive - range 0 \\(\\infty\\). Poisson GLM also known Poisson regression. link function used Poisson GLM natural logarithm, \\(ln\\).single explanatory variable, model :\\[\\begin{equation}\nln(E(y_{}))=\\beta_{0}+\\beta_{1}X1_{}\n\\tag{2.1}\n\\end{equation}\\]means model estimates logged base \\(e\\) inverse function, exp() must applied interpret terms response. words, make predictions expected value response need exponentiate coefficients.\\[\\begin{equation}\nE(y_{})=exp(\\beta_{0}+\\beta_{1}X1_{})\n\\tag{2.2}\n\\end{equation}\\]\\[\\begin{equation}\nE(y_{})=exp(\\beta_{0}) \\times exp(\\beta_{1})^{X1_{}}\n\\tag{2.3}\n\\end{equation}\\]Just like examples general linear models single explanatory variable, two parameters model, \\(\\beta_{0}\\) \\(\\beta_{0}\\) meaning similar. \\(\\beta_{0}\\) log expected \\(y\\) \\(x\\) zero (.e., intercept). log \\(\\beta_{1}\\) amount add \\(y\\) unit change \\(x\\) amount multiply. means model curve. \\(\\beta_{1}\\) positive, \\(exp(\\beta_{1})\\) greater one \\(y\\) increases \\(x\\) increases; \\(\\beta_{1}\\) negative, \\(exp(\\beta_{1})\\) less one \\(y\\) decreases \\(x\\) increases. See Figure 2.1 illustration curve positive negative \\(\\beta_{1}\\).\nFigure 2.1: Data fitted Poisson GLM.\nSee Figure 2.2 graphical representation generalised linear model terms.\nFigure 2.2: Generalised linear model Poisson distributed errors. measured response values pink, predictions green, differences , known residuals, blue. estimated model parameters, \\(\\beta_{0}\\) \\(\\beta_{1}\\) must exponentiated interpreted scale response. \\(x=0\\) predict number \\(y\\) \\(exp(\\beta_{0})\\). unit \\(x\\), number \\(y\\) changes factor \\(exp(\\beta_{1})\\)\n\\(ln\\) link function Poisson GLM. estimates log counts using \\(exp(\\beta_{0})\\) \\(exp(\\beta_{1})\\) enables us interpret counts.","code":""},{"path":"pois-glm-overview-2.html","id":"pois-glm-chi-2","chapter":"2 Poisson GLM overview","heading":"2.1 When explanatory is categorical","text":"response count just one categorical explanatory variable need Poisson GLMS. Use chi-squared test.","code":""},{"path":"pois-glm-overview-2.html","id":"more-than-one-explanatory","chapter":"2 Poisson GLM overview","heading":"2.2 More than one explanatory","text":"\\[\\begin{equation}\nln(E(y_{}))=\\beta_{0}+\\beta_{1}X1_{}+\\beta_{2}X2_{}+...+\\beta_{p}Xp_{}\n\\tag{2.4}\n\\end{equation}\\]make predictions expected value response need exponentiate coefficients.\\[\\begin{equation}\nE(y_{})=exp(\\beta_{0}+\\beta_{1}X1_{}+\\beta_{2}X2_{}+...+\\beta_{p}Xp_{})\n\\tag{2.5}\n\\end{equation}\\]","code":""},{"path":"pois-glm-overview-2.html","id":"pois-glm-report-2","chapter":"2 Poisson GLM overview","heading":"2.3 Reporting","text":"important information include reporting results fitting Poisson GLM notable predictions significance, direction magnitude effects. need ensure reader understand data saying even numbers statistical information removed. example, variable \\(Y\\) increases variables \\(X1\\).relatively simple models, reporting group means slope, statistical test information enough. complex models many variables common give estimated model coefficients table.addition, figure show data model. honest allows interpretation evaluated.","code":""},{"path":"pois-glm-single-cont.html","id":"pois-glm-single-cont","chapter":"3 Single continuous explanatory","heading":"3 Single continuous explanatory","text":"","code":""},{"path":"pois-glm-single-cont.html","id":"intro-3","chapter":"3 Single continuous explanatory","heading":"3.1 Introduction to the example","text":"number cases cancer reported clinic distance, kilometres, nuclear plant recorded data cases.txt. Researchers wanted know proximity nuclear power plant influenced incidence cancer. Bear mind great epidemiology - many factors influencing occurrence reporting cancer cases clinic.2 variables: response, cancers, number cancer cases reported clinic distance, gives clinic’s distance nuclear plant.import data read_table2() function plot ggplot().","code":"\ncases <- read_table2(\"data-raw/cases.txt\")\n# a default scatter plot of the data\nggplot(data = cases, aes(x = distance, y = cancers)) +\n  geom_point()"},{"path":"pois-glm-single-cont.html","id":"apply-interp-3","chapter":"3 Single continuous explanatory","heading":"3.2 Applying and interpreting glm()","text":"build generalised linear model number cases explained distance glm() function follows:Printing mod console gives us estimated model parameters:postpone discussing information last three lines view model summary.\\(\\beta_{0}\\) labelled “(Intercept)” \\(\\beta_{1}\\) labelled “distance.” Thus equation line :fact estimate distance (-0.021) negative tells us distance increases, number cancers reported goes .estimates scale link function, , logged (base e, natural logs) case.understand parameters scale response apply inverse \\(ln\\) function, exp() functionThe model predicts 2.771 cancers clinic 0 km power plant.Recall linear model one predictor, second estimate amount added intercept predictor changes one value. Since GLM log link, value 0.979 amount intercept multiplied unit increase distance. Thus model predicts 2.771 \\(\\times\\) 0.979 = 2.712 cancers 1 km away 2.771 \\(\\times\\) 0.979 \\(\\times\\) 0.979 = 2.654 cancers 2 km away. : \\(\\beta_{0}\\) \\(\\times\\) \\(\\beta_{0}^n\\) mm \\(n\\) km away.can work either exponentiating coefficients multiplying results adding coefficients exponentiating.Exponentiate coefficients multiply:Add coefficients exponentiate sum:model predicts number cancers 0 km plant 2.771, \\(exp(\\beta_{0})\\). decreases factor 0.979 km away \\(exp(\\beta_{1})\\). something multiply rather add link function log.Usually, use predict() function make predictions particular distances (see later).information including statistical tests model parameters obtained using summary():Coefficients table gives estimated \\(\\beta_{0}\\) \\(\\beta_{1}\\) along standard errors tests whether estimates differ zero. estimated value intercept 1.019 \\(\\pm\\) 0.309 differs significantly zero (\\(p\\) < 0.001). estimated value slope -0.021 \\(\\pm\\) 0.005, also differs significantly zero (\\(p\\) < 0.001).Towards bottom output information model fit. null deviance (exists predict number cases intercept, \\(\\beta_{0}\\), model) 54.522 42 degrees freedom residual deviance (left model fitted) 31.79 41 \\(d.f.\\). model fits 1 parameter, \\(\\beta_{1}\\), thus accounts 1 \\(d.f.\\) reduction deviance 22.732.get test whether reduction deviance significant term model formula use:get test model overall:significant reduction deviance model (p < 0.001). Note one term model.number cancers decreases significantly distance","code":"\nmod <- glm(data = cases, cancers ~ distance, family = poisson)\nmod\n# \n# Call:  glm(formula = cancers ~ distance, family = poisson, data = cases)\n# \n# Coefficients:\n# (Intercept)     distance  \n#      1.0192      -0.0215  \n# \n# Degrees of Freedom: 42 Total (i.e. Null);  41 Residual\n# Null Deviance:        54.5 \n# Residual Deviance: 31.8   AIC: 78.2\nexp(mod$coefficients)\n# (Intercept)    distance \n#       2.771       0.979\n# 1km away\nexp(b0) * exp(b1)\n# [1] 2.71\n# 2km away\nexp(b0) * exp(b1) * exp(b1)\n# [1] 2.65\n# 10km away\nexp(b0) * exp(b1)^10\n# [1] 2.23\n# 1km away\nexp(b0 + b1)\n# [1] 2.71\n# 2km away\nexp(b0 + b1 + b1)\n# [1] 2.65\n# 10km away\nexp(b0 + 10*b1)\n# [1] 2.23\nsummary(mod) \n# \n# Call:\n# glm(formula = cancers ~ distance, family = poisson, data = cases)\n# \n# Deviance Residuals: \n#    Min      1Q  Median      3Q     Max  \n# -1.842  -0.744  -0.483   0.421   1.893  \n# \n# Coefficients:\n#             Estimate Std. Error z value Pr(>|z|)    \n# (Intercept)  1.01917    0.30871    3.30  0.00096 ***\n# distance    -0.02150    0.00503   -4.27  0.00002 ***\n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# \n# (Dispersion parameter for poisson family taken to be 1)\n# \n#     Null deviance: 54.522  on 42  degrees of freedom\n# Residual deviance: 31.790  on 41  degrees of freedom\n# AIC: 78.16\n# \n# Number of Fisher Scoring iterations: 5\nanova(mod, test = \"Chisq\") \n# Analysis of Deviance Table\n# \n# Model: poisson, link: log\n# \n# Response: cancers\n# \n# Terms added sequentially (first to last)\n# \n# \n#          Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    \n# NULL                        42       54.5              \n# distance  1     22.7        41       31.8 0.0000019 ***\n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"pois-glm-single-cont.html","id":"get-pred-3","chapter":"3 Single continuous explanatory","heading":"3.3 Getting predictions from the model","text":"predict() function returns predicted values response. add column predicted values dataframe:\nneed specify scale responses, link function scale.gives predictions actual \\(x\\) values used. want predicts values \\(x\\) need create data frame \\(x\\) values want predictFor example, predict distances 0 180 km steps 10 km:","code":"\ncases$pred <- predict(mod, type = \"response\")\npredict_for <- data.frame(distance = seq(0, 180, 10))\npredict_for$pred <- predict(mod, newdata = predict_for, type = \"response\")"},{"path":"pois-glm-single-cont.html","id":"fig-3","chapter":"3 Single continuous explanatory","heading":"3.4 Creating a figure","text":"","code":"\nggplot(data = cases, aes(x = distance, y = cancers)) +\n  geom_point() +\ngeom_smooth(method = \"glm\",\n              method.args = list(family = \"poisson\"),\n              se = FALSE,\n            colour = \"black\") +\n  scale_x_continuous(expand = c(0, 0),\n                     limits = c(0, 190),\n                     name = \"Distance (km) of clinic from plant\") +\n    scale_y_continuous(expand = c(0, 0.03),\n                     limits = c(0, 5),\n                     name = \"Number of reported cancers\") +\n  theme_classic()"},{"path":"pois-glm-single-cont.html","id":"report-3","chapter":"3 Single continuous explanatory","heading":"3.5 Reporting the results","text":"number cases reported clinic significantly decreases factor 0.979 \\(\\pm\\) 1.005 kilometre nuclear plant (p < 0.001). See figure 3.1. clinic plant, 2.771 \\(\\pm\\) 1.362 cases expected\nFigure 3.1: Incidence cancer cases reported clinic distance nuclear plant. line gives predictions GLM Poisson distributed errors, \\(y\\) = 2.771 \\(\\times\\) 0.979\\(^{x}\\).\n","code":""},{"path":"pois-glm-two-cont.html","id":"pois-glm-two-cont","chapter":"4 Two explanatory variables","heading":"4 Two explanatory variables","text":"","code":""},{"path":"pois-glm-two-cont.html","id":"intro-4","chapter":"4 Two explanatory variables","heading":"4.1 Introduction to the example","text":"number insect prey caught individuals particular bird species varies. effort understand variation, researchers recorded number prey individual caught, age (years) spent majority ’s time (single individual, pair group many). data birds.txt.3 variables: response, prey, number caught individual; age, gives individual’s age years (one tenth year); group indicates individuals spent majority time.import data read_table2() function plot ggplot().need able show different group behaviours","code":"\nbirds <- read_table2(\"data-raw/birds.txt\")\n# a default scatter plot of the data\nggplot(data = birds, aes(x = age, y = prey, colour = group)) +\n  geom_point()"},{"path":"pois-glm-two-cont.html","id":"apply-interp-4","chapter":"4 Two explanatory variables","heading":"4.2 Applying and interpreting glm()","text":"build generalised linear model number cases explained distance glm() function follows:Printing mod console gives us estimated model parameters:\\(\\beta_{0}\\) labelled “(Intercept)” \\(\\beta_{1}\\) \\(\\beta_{5}\\) labelled “grouppair,” “groupsingle,” “age,” “grouppair:age” “groupsingle:age” Thus equation line :intercept log expected number prey items caught 0 aged birds spend majority time group many. fact estimate grouppair (-0.416) negative tells us pairs aged 0 catch fewer. Aged 0 single birds also catch fewer. positive coefficient age indicates prey caught age.understand parameters scale response apply inverse \\(ln\\) function, exp() functionSo:\\(prey\\) = 16.338 \\(\\times\\) 0.66\\(^{grouppair}\\) \\(\\times\\) 0.245\\(^{groupsingle}\\) \\(\\times\\) 0.66\\(^{grouppair}\\) \\(\\times\\) 0.845\\(^{grouppair:age}\\) \\(\\times\\) 0.724\\(^{groupsingle:age}\\)Birds aged 0 spend time many others expected catch 16.338 prey. paired birds aged 0 expected catch 16.338 \\(\\times\\) 0.66 = 10.778 prey lone birds aged 0, 16.338 \\(\\times\\) 0.245 = 10.778 prey.Birds spend time many others catch 1.34 times prey year age.information including statistical tests model parameters obtained using summary():Coefficients table gives estimated \\(\\beta s\\) time standard errors tests whether estimates differ zero. example, estimated value intercept 2.794 \\(\\pm\\) 0.181 differs significantly zero (\\(p\\) < 0.001). estimated value \\(\\beta_{1}\\) -0.416 \\(\\pm\\) 0.408 differ significantly zero (\\(p\\) = 0.308). age 0, birds pairs catch significantly fewer prey.Towards bottom output information model fit. null deviance (exists predict number prey mean birds groups many aged 0, \\(\\beta_{0}\\)) 848.806 29 degrees freedom residual deviance (left model fitted) 21.048 24 \\(d.f.\\). model fits five parameters thus accounts 5 \\(d.f.\\) reduction deviance 827.758.get test whether reduction deviance significant term model formula use:three terms model significantly reduce deviance: group (\\(p\\) < 0.001), age (\\(p\\) < 0.001) interaction (\\(p\\) = 0.007). means group size matters, age matters effect age individuals groups different sizes.","code":"\nmod <- glm(data = birds, prey ~ group * age, family = poisson)\nmod\n# \n# Call:  glm(formula = prey ~ group * age, family = poisson, data = birds)\n# \n# Coefficients:\n#     (Intercept)        grouppair      groupsingle              age  \n#           2.794           -0.416           -1.406            0.293  \n#   grouppair:age  groupsingle:age  \n#          -0.168           -0.323  \n# \n# Degrees of Freedom: 29 Total (i.e. Null);  24 Residual\n# Null Deviance:        849 \n# Residual Deviance: 21     AIC: 172\nexp(mod$coefficients)\n#     (Intercept)       grouppair     groupsingle             age   grouppair:age \n#          16.338           0.660           0.245           1.340           0.845 \n# groupsingle:age \n#           0.724\nsummary(mod) \n# \n# Call:\n# glm(formula = prey ~ group * age, family = poisson, data = birds)\n# \n# Deviance Residuals: \n#    Min      1Q  Median      3Q     Max  \n# -1.640  -0.667  -0.172   0.650   1.767  \n# \n# Coefficients:\n#                 Estimate Std. Error z value            Pr(>|z|)    \n# (Intercept)       2.7935     0.1813   15.41 <0.0000000000000002 ***\n# grouppair        -0.4161     0.4078   -1.02               0.308    \n# groupsingle      -1.4059     0.5949   -2.36               0.018 *  \n# age               0.2927     0.0354    8.27 <0.0000000000000002 ***\n# grouppair:age    -0.1685     0.0789   -2.13               0.033 *  \n# groupsingle:age  -0.3226     0.1260   -2.56               0.010 *  \n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# \n# (Dispersion parameter for poisson family taken to be 1)\n# \n#     Null deviance: 848.806  on 29  degrees of freedom\n# Residual deviance:  21.048  on 24  degrees of freedom\n# AIC: 171.8\n# \n# Number of Fisher Scoring iterations: 4\nanova(mod, test = \"Chisq\") \n# Analysis of Deviance Table\n# \n# Model: poisson, link: log\n# \n# Response: prey\n# \n# Terms added sequentially (first to last)\n# \n# \n#           Df Deviance Resid. Df Resid. Dev             Pr(>Chi)    \n# NULL                         29        849                         \n# group      2      752        27         97 < 0.0000000000000002 ***\n# age        1       66        26         31  0.00000000000000041 ***\n# group:age  2       10        24         21               0.0071 ** \n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"pois-glm-two-cont.html","id":"getting-predictions-from-the-model","chapter":"4 Two explanatory variables","heading":"4.3 Getting predictions from the model","text":"predict() function returns predicted values response. add column predicted values dataframe: need specify scale responses, scale link function.gives predictions ages used. want predictions ages need create data frame values want predictTo predict ages 0, mean(age) 7 group size can use:want predictions three ages need repeat group name three times. repeat list ages three times three group sizes. result :specify dataframe predict() function using newdata argumentThis sort information helpful explaining results.","code":"\nbirds$pred <- predict(mod, type = \"response\")\npredict_for <- data.frame(group = rep(c(\"many\", \"pair\", \"single\"), each = 3),\n                      age = rep(c(c(0, mean(birds$age), 7)), times = 3))\npredict_for$pred <- predict(mod, newdata = predict_for, type = \"response\")"},{"path":"pois-glm-two-cont.html","id":"fig-4","chapter":"4 Two explanatory variables","heading":"4.4 Creating a figure","text":"","code":"\nggplot(data = birds, aes(x = age, y = prey, colour = group)) +\n  geom_point() +\n  geom_smooth(method = \"glm\",\n              method.args = list(family = \"poisson\"),\n              se = FALSE) +\n  scale_color_manual(values = pal4, name = \"Group size\") +\n  scale_x_continuous(expand = c(0, 0),\n                     limits = c(0, 7.5),\n                     name = \"Age (years)\") +\n  scale_y_continuous(expand = c(0, 0.03),\n                     limits = c(0, 110),\n                     name = \"Number of prey caught\") +\n  theme_classic()"},{"path":"pois-glm-two-cont.html","id":"report-4","chapter":"4 Two explanatory variables","heading":"4.5 Reporting the results","text":"significant effect group size (p < 0.001) number prey items caught averaged aged birds catching 64.7 prey spend time large groups, 19.3 prey paired birds 3.5 prey lone birds. also significant effect age (p < 0.001) overall varies birds different group sizes (p = 0.007). Birds large groups improve factor 1.34 year, paired birds factor 1.132 single birds . See figure 4.1.\nFigure 4.1: effect age group size number prey items caught individual. line gives predictions GLM Poisson distributed errors.\n","code":""},{"path":"bino-glm-overview-5.html","id":"bino-glm-overview-5","chapter":"5 Binomial GLM overview","heading":"5 Binomial GLM overview","text":"response variable can take one two values 0 1, dead alive, yes failure success follows binomial distribution can modelled binomial GLM. binomial GLM also known logistic regression.\nAlthough observations can one two values, scale response probability representing probability 1, alive, yes success. link function used binomial GLM “logit” function also known “log-odds.” means model estimates also log-odds. can make tricky interpret estimates two things can help us. First, principle sign \\(\\beta_{1}\\) still applies: positive \\(\\beta_{1}\\) indicates increase odds increase \\(X1\\) negative \\(\\beta_{1}\\) indicates decrease odds increase \\(X1\\). See Figure 5.1 illustration curve positive negative \\(\\beta_{1}\\).\nFigure 5.1: Data fitted binomial GLM.\nSecond, can use predict() function get values scale response, probability, rather log-odds. easier people understand.Positive \\(\\beta_{1}\\) indicates increase odds increase \\(X1\\) negative \\(\\beta_{1}\\) indicates decrease odds increase \\(X1\\).single explanatory variable, binomial GLM :\\[\\begin{equation}\nln\\left(\\frac{E(y_{})}{1-E(y_{})}\\right)=\\beta_{0}+\\beta_{1}X1_{}\n\\tag{5.1}\n\\end{equation}\\]means model estimates odds logged base \\(e\\) inverse function, exp() must applied interpret odds.\\[\\begin{equation}\n\\frac{E(y_{})}{1-E(y_{})}=exp(\\beta_{0}+\\beta_{1}X1_{})\n\\tag{5.2}\n\\end{equation}\\]\\[\\begin{equation}\n\\frac{E(y_{})}{1-E(y_{})}=exp(\\beta_{0}) \\times exp(\\beta_{1})^{X1_{}}\n\\tag{5.3}\n\\end{equation}\\]looks complicated. Using predict function important reporting results.Just like Poisson GLM single explanatory variable, two parameters model, \\(\\beta_{0}\\) \\(\\beta_{1}\\) meaning similar. Let us assume response failure (0) success (1). \\(\\beta_{0}\\) log odds success explanatory variable 0 \\(\\beta_{1}\\) change log odds success unit change explanatory.binomial GLM link function \\(logit\\) estimates log-odds. Predictions ‘scale response’ probabilities one two outcomes.","code":""},{"path":"bino-glm-overview-5.html","id":"bino-odds-5","chapter":"5 Binomial GLM overview","heading":"5.1 What exactly are odds?","text":"odds probability something happening divided probability happening. example, fair coin heads tails equally likely, can think heads something happens tails happening. odds head coin toss :\\(\\frac{P(H)}{P( \\:head)} = \\frac{0.5}{ 1- 0.5} = 1\\)odds 1, heads tails equally likely.unfair coin probability head \\(\\frac{3}{4}\\) odds head :\\(\\frac{P(H)}{P( \\:head)} = \\frac{0.75}{ 1- 0.75} = 3\\)head three times likely tail. odds greater 1 heads probable tails.instead probability head \\(\\frac{1}{4}\\) odds head :\\(\\frac{P(H)}{P( \\:head)} = \\frac{0.25}{ 1- 0.25} = 0.33333\\)head third likely tail. odds less 1 heads less probable tails.odds > 1, success likely failure.\nodds < 1, failure likely success.","code":""},{"path":"bino-glm-overview-5.html","id":"bino-b0-odds-5","chapter":"5 Binomial GLM overview","heading":"5.2 What does this mean for \\(\\beta_{0}\\)?","text":"response can failure (0) success (1). \\(\\beta_{0}\\) log odds success explanatory variable 0. :\\[\\begin{equation}\nln\\left(\\frac{P(success)}{P(failure)}\\right)\n\\tag{5.4}\n\\end{equation}\\]probability success greater probability failure log number greater 1 thus positive.\nprobability success less probability failure log number less 1 thus negative.Positive \\(\\beta_{0}\\) indicates probability success greater probability failure \\(x = 0\\) negative \\(\\beta_{0}\\) indicates probability failure greater probability success \\(x = 0\\)","code":""},{"path":"bino-glm-overview-5.html","id":"bino-b1-odds-5","chapter":"5 Binomial GLM overview","heading":"5.3 What does this mean for \\(\\beta_{1}\\)?","text":"\\(\\beta_{1}\\) change log odds success unit change explanatory variable. log odds success \\(x = 1\\) divided odds success \\(x = 0\\)\nodds success \\(x = 1\\) greater odds success \\(x = 0\\), log number greater 1 thus \\(\\beta_{1}\\) positive.\nodds success \\(x = 1\\) less odds success \\(x = 0\\), log number less 1 thus \\(\\beta_{1}\\) negative.Positive \\(\\beta_{1}\\) indicates probability success increasing \\(x\\) negative \\(\\beta_{1}\\) indicates probability success decreasing \\(x\\).","code":""},{"path":"bino-glm-single-cont.html","id":"bino-glm-single-cont","chapter":"6 Single continuous explanatory","heading":"6 Single continuous explanatory","text":"","code":""},{"path":"bino-glm-single-cont.html","id":"intro-6","chapter":"6 Single continuous explanatory","heading":"6.1 Introduction to the example","text":"erythrocyte sedimentation rate (ESR) routine test inflammation reading greater 20mm/hr indicates inflammation. However, fibrinogen levels also affect ESR. aim analysis determine whether ESR greater 20mm/hr can predicted fibrinogen levels.\ndata plasma.txt simplified version Collett Jemain’s (1985) data comes HSAUR package (Everitt Hothorn 2017). two variables: ESR 0 indicates less equal 20mm/hr 1 indicates greater 20mm/hr; fibrinogen arbitrary units.response ESR 0 indicates less equal 20mm/hr 1 indicates greater 20mm/hr. Fibrinogen explanatory variable.import data read_table2() function plot ggplot().","code":"\nplasma <- read_table2(\"data-raw/plasma.txt\")\n# a default scatter plot of the data\nggplot(data = plasma, aes(x = fibrinogen, y = ESR)) +\n  geom_point()"},{"path":"bino-glm-single-cont.html","id":"apply-interp-6","chapter":"6 Single continuous explanatory","heading":"6.2 Applying and interpreting glm()","text":"build generalised linear model ESR explained fibrinogen glm() function follows:Printing mod console gives us estimated model parameters:postpone discussing information last three lines view model summary.\\(\\beta_{0}\\) labelled “(Intercept)” \\(\\beta_{1}\\) labelled “fibrinogen.” Thus equation line :fact estimate fibrinogen (1.827) positive tells us probability ESR greater 20 mm/hr increases fibrinogen increases.fact estimate intercept (-6.845) negative tells us probability ESR greater 20 mm/hr lower probability ESR less 20 mm/hr fibrinogen zero.Notice thinking ESR greater 20 mm/hr success. two outcomes consider success, 1, arbitrary. just need make sure outcome classing success coded 1 data set. need considered success biologically. example, means probability modelling probability ESR greater 20 mm/hr.estimates scale link function - log odds.understand parameters scale response apply inverse link function. need first exponentiate , interpret odds.0.001 odds ESR >20 fibrinogen 0. Odds P(ESR > 20) / P(ESR < 20). less 1, probability ESR >20 must smaller probability ESR < 20 fibrinogen 0.6.216 factor odds changes unit fibrinogen. greater 1, ’s going , .alternative way write equation line :information including statistical tests model parameters obtained using summary():Coefficients table gives estimated \\(\\beta_{0}\\) \\(\\beta_{1}\\) along standard errors tests whether estimates differ zero. estimated value intercept -6.845 \\(\\pm\\) 2.77 differs significantly zero (\\(p\\) = 0.013). estimated value slope 1.827 \\(\\pm\\) 0.901, also differs significantly zero (\\(p\\) = 0.043).Towards bottom output information model fit. null deviance (exists predict odds ESR > 20 intercept, \\(\\beta_{0}\\), model) 30.885 31 degrees freedom residual deviance (left model fitted) 24.84 30 \\(d.f.\\). model fits single parameter (\\(\\beta_{0}\\)), \\(\\beta_{1}\\), thus accounts 1 \\(d.f.\\) reduction deviance 6.045.get test whether reduction deviance significant term model formula use:significant reduction deviance model (p = 0.014).","code":"\nmod <- glm(data = plasma, ESR ~ fibrinogen, family = binomial)\nmod\n# \n# Call:  glm(formula = ESR ~ fibrinogen, family = binomial, data = plasma)\n# \n# Coefficients:\n# (Intercept)   fibrinogen  \n#       -6.85         1.83  \n# \n# Degrees of Freedom: 31 Total (i.e. Null);  30 Residual\n# Null Deviance:        30.9 \n# Residual Deviance: 24.8   AIC: 28.8\nexp(mod$coefficients)\n# (Intercept)  fibrinogen \n#     0.00106     6.21572\nsummary(mod) \n# \n# Call:\n# glm(formula = ESR ~ fibrinogen, family = binomial, data = plasma)\n# \n# Deviance Residuals: \n#    Min      1Q  Median      3Q     Max  \n# -0.930  -0.540  -0.438  -0.336   2.479  \n# \n# Coefficients:\n#             Estimate Std. Error z value Pr(>|z|)  \n# (Intercept)   -6.845      2.770   -2.47    0.013 *\n# fibrinogen     1.827      0.901    2.03    0.043 *\n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# \n# (Dispersion parameter for binomial family taken to be 1)\n# \n#     Null deviance: 30.885  on 31  degrees of freedom\n# Residual deviance: 24.840  on 30  degrees of freedom\n# AIC: 28.84\n# \n# Number of Fisher Scoring iterations: 5\nanova(mod, test = \"Chisq\")\n# Analysis of Deviance Table\n# \n# Model: binomial, link: logit\n# \n# Response: ESR\n# \n# Terms added sequentially (first to last)\n# \n# \n#            Df Deviance Resid. Df Resid. Dev Pr(>Chi)  \n# NULL                          31       30.9           \n# fibrinogen  1     6.04        30       24.8    0.014 *\n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"bino-glm-single-cont.html","id":"get-pred-6","chapter":"6 Single continuous explanatory","heading":"6.3 Getting predictions from the model","text":"predict() function returns predicted values response. add column predicted values dataframe:need specify scale responses (.e., probabilities), link function scale (log odds).gives predictions actual \\(x\\) values used. want predictions values \\(x\\) need creating data frame \\(x\\) values want predictFor example, predict fibrinogen 0 6 km steps 1 km:","code":"\n# plasma$pred <- predict(mod, type = \"response\")\npredict_for <- data.frame(fibrinogen = seq(0, 6, 1))\npredict_for$pred <- predict(mod, newdata = predict_for, type = \"response\")"},{"path":"bino-glm-single-cont.html","id":"using-the-predictions-to-understand-the-odds","chapter":"6 Single continuous explanatory","heading":"6.4 Using the predictions to understand the odds","text":"can use predictions fibrinogen levels 0 1 help understand odds model coefficients.bit come, soon, honest!\n\n\n\n\n\n\n\n\n\n\n\n\n\n","code":""},{"path":"bino-glm-single-cont.html","id":"fig-6","chapter":"6 Single continuous explanatory","heading":"6.5 Creating a figure","text":"","code":"\nggplot(data = plasma, aes(x = fibrinogen, y = ESR)) +\n  geom_point() +\ngeom_smooth(method = \"glm\",\n              method.args = list(family = \"binomial\"),\n              se = FALSE,\n            colour = \"black\") +\n  scale_x_continuous(expand = c(0, 0),\n                     limits = c(0, 6),\n                     name = \"Fibrinogen (units)\") +\n    scale_y_continuous(expand = c(0, 0.03),\n                      breaks = seq(0, 1, 0.1),\n                     limits = c(0, 1.05),\n                     name = \"Probability of ESR >2 0\") +\n  theme_classic()"},{"path":"bino-glm-single-cont.html","id":"report-6","chapter":"6 Single continuous explanatory","heading":"6.6 Reporting the results","text":"odds erythrocyte sedimentation rate (ESR) greater 20 mm/hr significantly increases increasing fibrinogen levels factor 6.216 unit fibrinogen (p = 0.014). See Figure 6.1. example, probability ESR greater 20 mm/hr 2 units 0.04 rises 0.984 6 units.\nFigure 6.1: Incidence erythrocyte sedimentation rate (ESR) greater 20 mm/hr fibrinogen levels. line gives predictions GLM binomial distributed errors, \\(\\frac{P(ESR >20)}{P(ESR <20)}\\) = 0.001 \\(\\times\\) 6.216\\(^{fibrinogen}\\).\n","code":""},{"path":"summary.html","id":"summary","chapter":"7 Summary","heading":"7 Summary","text":"models common: Responses must independent\nkey pointswhere go next","code":""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
