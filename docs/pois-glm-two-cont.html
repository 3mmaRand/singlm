<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Two explanatory variables | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</title>
<meta name="author" content="Emma Rand">
<meta name="description" content="4.1 Introduction to the example The number of insect prey caught by individuals of a particular bird species varies. In an effort to understand this variation, researchers recorded the number of...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 4 Two explanatory variables | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://3mmarand.github.io/singlm/pois-glm-two-cont.html">
<meta property="og:image" content="https://3mmarand.github.io/singlm//images/hex-s.png">
<meta property="og:description" content="4.1 Introduction to the example The number of insect prey caught by individuals of a particular bird species varies. In an effort to understand this variation, researchers recorded the number of...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Two explanatory variables | singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R">
<meta name="twitter:site" content="@er13_r">
<meta name="twitter:description" content="4.1 Introduction to the example The number of insect prey caught by individuals of a particular bird species varies. In an effort to understand this variation, researchers recorded the number of...">
<meta name="twitter:image" content="https://3mmarand.github.io/singlm//images/hex-s.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-115082821-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="assets/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="what-are-glms-1.html"><span class="header-section-number">1</span> What are GLMs?</a></li>
<li class="book-part">POISSON GLMs</li>
<li><a class="" href="pois-glm-overview-2.html"><span class="header-section-number">2</span> Poisson GLM overview</a></li>
<li><a class="" href="pois-glm-single-cont.html"><span class="header-section-number">3</span> Single continuous explanatory</a></li>
<li><a class="active" href="pois-glm-two-cont.html"><span class="header-section-number">4</span> Two explanatory variables</a></li>
<li class="book-part">BINOMIAL GLMs</li>
<li><a class="" href="bino-glm-overview-5.html"><span class="header-section-number">5</span> Binomial GLM overview</a></li>
<li><a class="" href="bino-glm-single-cont.html"><span class="header-section-number">6</span> Single continuous explanatory</a></li>
<li><a class="" href="summary.html"><span class="header-section-number">7</span> Summary</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/3mmaRand/singlm">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="pois-glm-two-cont" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Two explanatory variables<a class="anchor" aria-label="anchor" href="#pois-glm-two-cont"><i class="fas fa-link"></i></a>
</h1>
<div id="intro-4" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Introduction to the example<a class="anchor" aria-label="anchor" href="#intro-4"><i class="fas fa-link"></i></a>
</h2>
<p>The number of insect prey caught by individuals of a particular bird species varies. In an effort to understand this variation, researchers recorded the number of prey an individual caught, its age (in years) and how it spent the majority of it’s time (as a single individual, in a pair or in a group of many). The data are in <a href="data-raw/birds.txt">birds.txt</a>.</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
prey
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
age
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
group
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2.6
</td>
<td style="text-align:left;">
single
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5.7
</td>
<td style="text-align:left;">
single
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2.7
</td>
<td style="text-align:left;">
single
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:left;">
single
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.9
</td>
<td style="text-align:left;">
single
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:left;">
single
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5.2
</td>
<td style="text-align:left;">
single
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.9
</td>
<td style="text-align:left;">
single
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6.7
</td>
<td style="text-align:left;">
single
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5.5
</td>
<td style="text-align:left;">
single
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
7.0
</td>
<td style="text-align:left;">
pair
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:left;">
pair
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
5.3
</td>
<td style="text-align:left;">
pair
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:left;">
pair
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:left;">
pair
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:left;">
pair
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
5.9
</td>
<td style="text-align:left;">
pair
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
5.1
</td>
<td style="text-align:left;">
pair
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
4.2
</td>
<td style="text-align:left;">
pair
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
5.5
</td>
<td style="text-align:left;">
pair
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:left;">
many
</td>
</tr>
<tr>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:left;">
many
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
5.2
</td>
<td style="text-align:left;">
many
</td>
</tr>
<tr>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:left;">
many
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
3.3
</td>
<td style="text-align:left;">
many
</td>
</tr>
<tr>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:left;">
many
</td>
</tr>
<tr>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
6.3
</td>
<td style="text-align:left;">
many
</td>
</tr>
<tr>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
6.1
</td>
<td style="text-align:left;">
many
</td>
</tr>
<tr>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
2.6
</td>
<td style="text-align:left;">
many
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:left;">
many
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="key">
<p>There are 3 variables: the response, <code>prey</code>, is the number of caught by an individual; <code>age</code>, gives the individual’s age in years (to one tenth of a year); and <code>group</code> indicates how the individuals spent the majority of its time.</p>
</div>
<p>We will import the data with the <code>read_table2()</code> function and plot it with <code>ggplot()</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">birds</span> <span class="op">&lt;-</span> <span class="fu">read_table2</span><span class="op">(</span><span class="st">"data-raw/birds.txt"</span><span class="op">)</span></code></pre></div>
<p>We need to be able to show the different group behaviours</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a default scatter plot of the data</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">birds</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">prey</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="glm-poisson-two-explan_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto auto auto 0;">
Individuals that spend most of their time with many individuals catch more prey and this effect is increased with age. Individuals that spend most of their time alone do not seem to improve with age.</div>
</div>
<div id="apply-interp-4" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Applying and interpreting <code>glm()</code><a class="anchor" aria-label="anchor" href="#apply-interp-4"><i class="fas fa-link"></i></a>
</h2>
<p>We build a generalised linear model of the number of cases explained by the distance with the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function as follows:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">birds</span>, <span class="va">prey</span> <span class="op">~</span> <span class="va">group</span> <span class="op">*</span> <span class="va">age</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span></code></pre></div>
<p>Printing <code>mod</code> to the console gives us the estimated model parameters:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span>
<span class="co"># </span>
<span class="co"># Call:  glm(formula = prey ~ group * age, family = poisson, data = birds)</span>
<span class="co"># </span>
<span class="co"># Coefficients:</span>
<span class="co">#     (Intercept)        grouppair      groupsingle              age  </span>
<span class="co">#           2.794           -0.416           -1.406            0.293  </span>
<span class="co">#   grouppair:age  groupsingle:age  </span>
<span class="co">#          -0.168           -0.323  </span>
<span class="co"># </span>
<span class="co"># Degrees of Freedom: 29 Total (i.e. Null);  24 Residual</span>
<span class="co"># Null Deviance:        849 </span>
<span class="co"># Residual Deviance: 21     AIC: 172</span></code></pre></div>
<p><span class="math inline">\(\beta_{0}\)</span> is labelled “(Intercept)” and <span class="math inline">\(\beta_{1}\)</span> to <span class="math inline">\(\beta_{5}\)</span> are labelled “grouppair,” “groupsingle,” “age,” “grouppair:age” and “groupsingle:age” Thus the equation of the line is:</p>
<center>
<span class="math inline">\(ln(prey)\)</span> = 2.794 <span class="math inline">\(+\)</span> -0.416<span class="math inline">\(\times grouppair\)</span> <span class="math inline">\(+\)</span> -1.406<span class="math inline">\(\times groupsingle\)</span> <span class="math inline">\(+\)</span> 0.293<span class="math inline">\(\times age\)</span> <span class="math inline">\(+\)</span> -0.168<span class="math inline">\(\times grouppair:age\)</span> <span class="math inline">\(+\)</span> -0.323<span class="math inline">\(\times groupsingle:age\)</span>
</center>
<p>The intercept is the log of the expected number of prey items caught by 0 aged birds that spend the majority of their time in a group of many. The fact that the estimate for grouppair (-0.416) is negative tells us that those in pairs aged 0 catch fewer. Aged 0 single birds also catch fewer. The positive coefficient for age indicates that more prey are caught with age.</p>
<p>To understand the parameters the on the scale of the response we apply the inverse of the <span class="math inline">\(ln\)</span> function, the <code><a href="https://rdrr.io/r/base/Log.html">exp()</a></code> function</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span>
<span class="co">#     (Intercept)       grouppair     groupsingle             age   grouppair:age </span>
<span class="co">#          16.338           0.660           0.245           1.340           0.845 </span>
<span class="co"># groupsingle:age </span>
<span class="co">#           0.724</span></code></pre></div>
<p>So:</p>
<p><span class="math inline">\(prey\)</span> = 16.338 <span class="math inline">\(\times\)</span> 0.66<span class="math inline">\(^{grouppair}\)</span> <span class="math inline">\(\times\)</span> 0.245<span class="math inline">\(^{groupsingle}\)</span> <span class="math inline">\(\times\)</span> 0.66<span class="math inline">\(^{grouppair}\)</span> <span class="math inline">\(\times\)</span> 0.845<span class="math inline">\(^{grouppair:age}\)</span> <span class="math inline">\(\times\)</span> 0.724<span class="math inline">\(^{groupsingle:age}\)</span></p>
<p>Birds aged 0 that spend most of their time with many others are expected to catch 16.338 prey. The paired birds aged 0 are expected to catch 16.338 <span class="math inline">\(\times\)</span> 0.66 = 10.778 prey and the lone birds aged 0, 16.338 <span class="math inline">\(\times\)</span> 0.245 = 10.778 prey.</p>
<p>Birds that spend most of their time with many others catch 1.34 times more prey with each year that they age.</p>
<p>More information including statistical tests of the model and its parameters is obtained by using <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> 
<span class="co"># </span>
<span class="co"># Call:</span>
<span class="co"># glm(formula = prey ~ group * age, family = poisson, data = birds)</span>
<span class="co"># </span>
<span class="co"># Deviance Residuals: </span>
<span class="co">#    Min      1Q  Median      3Q     Max  </span>
<span class="co"># -1.640  -0.667  -0.172   0.650   1.767  </span>
<span class="co"># </span>
<span class="co"># Coefficients:</span>
<span class="co">#                 Estimate Std. Error z value            Pr(&gt;|z|)    </span>
<span class="co"># (Intercept)       2.7935     0.1813   15.41 &lt;0.0000000000000002 ***</span>
<span class="co"># grouppair        -0.4161     0.4078   -1.02               0.308    </span>
<span class="co"># groupsingle      -1.4059     0.5949   -2.36               0.018 *  </span>
<span class="co"># age               0.2927     0.0354    8.27 &lt;0.0000000000000002 ***</span>
<span class="co"># grouppair:age    -0.1685     0.0789   -2.13               0.033 *  </span>
<span class="co"># groupsingle:age  -0.3226     0.1260   -2.56               0.010 *  </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># </span>
<span class="co"># (Dispersion parameter for poisson family taken to be 1)</span>
<span class="co"># </span>
<span class="co">#     Null deviance: 848.806  on 29  degrees of freedom</span>
<span class="co"># Residual deviance:  21.048  on 24  degrees of freedom</span>
<span class="co"># AIC: 171.8</span>
<span class="co"># </span>
<span class="co"># Number of Fisher Scoring iterations: 4</span></code></pre></div>
<p>The <code>Coefficients</code> table gives the estimated <span class="math inline">\(\beta s\)</span> again but this time with their standard errors and tests of whether the estimates differ from zero. For example, The estimated value for the intercept is 2.794 <span class="math inline">\(\pm\)</span> 0.181 and this differs significantly from zero (<span class="math inline">\(p\)</span> &lt; 0.001). The estimated value for <span class="math inline">\(\beta_{1}\)</span> is -0.416 <span class="math inline">\(\pm\)</span> 0.408 does not differ significantly from zero (<span class="math inline">\(p\)</span> = 0.308). At age 0, birds in pairs do not catch significantly fewer prey.</p>
<p>Towards the bottom of the output there is information about the model fit. The null deviance (what exists if we predict the number of prey from the mean of birds in groups of many aged 0, <span class="math inline">\(\beta_{0}\)</span>) is 848.806 with 29 degrees of freedom and the residual deviance (left over after our model is fitted) is 21.048 with 24 <span class="math inline">\(d.f.\)</span>. The model fits a five parameters and thus accounts for 5 <span class="math inline">\(d.f.\)</span> for a reduction in deviance by 827.758.</p>
<p>To get a test of whether the reduction in deviance is significant for each term in the the model formula we use:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod</span>, test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span> 
<span class="co"># Analysis of Deviance Table</span>
<span class="co"># </span>
<span class="co"># Model: poisson, link: log</span>
<span class="co"># </span>
<span class="co"># Response: prey</span>
<span class="co"># </span>
<span class="co"># Terms added sequentially (first to last)</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co">#           Df Deviance Resid. Df Resid. Dev             Pr(&gt;Chi)    </span>
<span class="co"># NULL                         29        849                         </span>
<span class="co"># group      2      752        27         97 &lt; 0.0000000000000002 ***</span>
<span class="co"># age        1       66        26         31  0.00000000000000041 ***</span>
<span class="co"># group:age  2       10        24         21               0.0071 ** </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>All three terms in the model significantly reduce the deviance: group (<span class="math inline">\(p\)</span> &lt; 0.001), age (<span class="math inline">\(p\)</span> &lt; 0.001) and the interaction between them (<span class="math inline">\(p\)</span> = 0.007). This means that group size matters, age matters and the effect of age is not the same for individuals in groups of different sizes.</p>
</div>
<div id="getting-predictions-from-the-model" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Getting predictions from the model<a class="anchor" aria-label="anchor" href="#getting-predictions-from-the-model"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function returns the predicted values of the response. To add a column of predicted values to the dataframe: we need to specify they should be on the scale of the responses, not on the scale of the link function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">birds</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></code></pre></div>
<p>This gives predictions for the ages used. If you want predictions for other ages you need to create a data frame of the values from which you want to predict</p>
<p>To predict for ages 0, mean(age) and 7 for each group size we can use:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predict_for</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"many"</span>, <span class="st">"pair"</span>, <span class="st">"single"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
                      age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">birds</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We want predictions for three ages so need to repeat the group name each three times. We repeat the list of ages three times because there are three group sizes. The result is:</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
group
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
age
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
many
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
many
</td>
<td style="text-align:right;">
4.7
</td>
</tr>
<tr>
<td style="text-align:left;">
many
</td>
<td style="text-align:right;">
7.0
</td>
</tr>
<tr>
<td style="text-align:left;">
pair
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
pair
</td>
<td style="text-align:right;">
4.7
</td>
</tr>
<tr>
<td style="text-align:left;">
pair
</td>
<td style="text-align:right;">
7.0
</td>
</tr>
<tr>
<td style="text-align:left;">
single
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
single
</td>
<td style="text-align:right;">
4.7
</td>
</tr>
<tr>
<td style="text-align:left;">
single
</td>
<td style="text-align:right;">
7.0
</td>
</tr>
</tbody>
</table></div>
</div>
<p>We then specify this dataframe in the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function using the <code>newdata</code> argument</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predict_for</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span>, newdata <span class="op">=</span> <span class="va">predict_for</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
group
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
age
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pred
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
many
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
16.34
</td>
</tr>
<tr>
<td style="text-align:left;">
many
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
64.71
</td>
</tr>
<tr>
<td style="text-align:left;">
many
</td>
<td style="text-align:right;">
7.0
</td>
<td style="text-align:right;">
126.73
</td>
</tr>
<tr>
<td style="text-align:left;">
pair
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
10.78
</td>
</tr>
<tr>
<td style="text-align:left;">
pair
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
19.33
</td>
</tr>
<tr>
<td style="text-align:left;">
pair
</td>
<td style="text-align:right;">
7.0
</td>
<td style="text-align:right;">
25.70
</td>
</tr>
<tr>
<td style="text-align:left;">
single
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
4.00
</td>
</tr>
<tr>
<td style="text-align:left;">
single
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
3.48
</td>
</tr>
<tr>
<td style="text-align:left;">
single
</td>
<td style="text-align:right;">
7.0
</td>
<td style="text-align:right;">
3.25
</td>
</tr>
</tbody>
</table></div>
</div>
<p>This sort of information is helpful in explaining our results.</p>
</div>
<div id="fig-4" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Creating a figure<a class="anchor" aria-label="anchor" href="#fig-4"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">birds</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">prey</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"glm"</span>,
              method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span>,
              se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal4</span>, name <span class="op">=</span> <span class="st">"Group size"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7.5</span><span class="op">)</span>,
                     name <span class="op">=</span> <span class="st">"Age (years)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.03</span><span class="op">)</span>,
                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">110</span><span class="op">)</span>,
                     name <span class="op">=</span> <span class="st">"Number of prey caught"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="glm-poisson-two-explan_files/figure-html/fig-birds-1.png" width="80%" style="display: block; margin: auto auto auto 0;"></div>
</div>
<div id="report-4" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Reporting the results<a class="anchor" aria-label="anchor" href="#report-4"><i class="fas fa-link"></i></a>
</h2>
<p>There is a significant effect of group size (p &lt; 0.001) on the number of prey items caught with averaged aged birds catching 64.7 prey if they spend their time in large groups, 19.3 prey for paired birds and only 3.5 prey for lone birds. There is also a significant effect of age (p &lt; 0.001) overall but this varies for birds in different group sizes (p = 0.007). Birds in large groups improve by a factor of 1.34 for each year, paired birds by a factor of 1.132 and single birds not at all. See figure <a href="pois-glm-two-cont.html#fig:fig-birds-report">4.1</a>.</p>

<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:fig-birds-report"></span>
<img src="glm-poisson-two-explan_files/figure-html/fig-birds-report-1.png" alt="The effect of age and group size on the number of prey items caught by an individual. The line gives predictions for a GLM with Poisson distributed errors." width="60%"><p class="caption">
Figure 4.1: The effect of age and group size on the number of prey items caught by an individual. The line gives predictions for a GLM with Poisson distributed errors.
</p>
</div>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="pois-glm-single-cont.html"><span class="header-section-number">3</span> Single continuous explanatory</a></div>
<div class="next"><a href="bino-glm-overview-5.html"><span class="header-section-number">5</span> Binomial GLM overview</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#pois-glm-two-cont"><span class="header-section-number">4</span> Two explanatory variables</a></li>
<li><a class="nav-link" href="#intro-4"><span class="header-section-number">4.1</span> Introduction to the example</a></li>
<li><a class="nav-link" href="#apply-interp-4"><span class="header-section-number">4.2</span> Applying and interpreting glm()</a></li>
<li><a class="nav-link" href="#getting-predictions-from-the-model"><span class="header-section-number">4.3</span> Getting predictions from the model</a></li>
<li><a class="nav-link" href="#fig-4"><span class="header-section-number">4.4</span> Creating a figure</a></li>
<li><a class="nav-link" href="#report-4"><span class="header-section-number">4.5</span> Reporting the results</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/3mmaRand/singlm/blob/master/glm-poisson-two-explan.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/3mmaRand/singlm/edit/master/glm-poisson-two-explan.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>singlm: A simple introduction to GLM for analysing Poisson and Binomial responses in R</strong>" was written by Emma Rand. It was last built on October 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
